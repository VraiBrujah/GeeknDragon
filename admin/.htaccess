# Protection du dossier administrateur
<Files ".env">
    Require all denied
</Files>

<Files "*.log">
    Require all denied
</Files>

<FilesMatch "\.(log|env|ini|conf)$">
    Require all denied
</FilesMatch>

# Protection contre l'inclusion de fichiers
php_value auto_prepend_file ""
php_value auto_append_file ""

# Désactiver l'exécution de PHP dans le dossier logs
<Directory "logs">
    <Files "*.php">
        Require all denied
    </Files>
    <Files "*.phtml">
        Require all denied
    </Files>
</Directory>

# Headers de sécurité
<IfModule mod_headers.c>
    Header always set X-Frame-Options "SAMEORIGIN"
    Header always set X-Content-Type-Options "nosniff"
    Header always set X-XSS-Protection "1; mode=block"
    Header always set Referrer-Policy "strict-origin-when-cross-origin"
    Header always set Content-Security-Policy "default-src 'self'; script-src 'self' 'unsafe-inline'; style-src 'self' 'unsafe-inline'; img-src 'self' data:; font-src 'self' https://fonts.gstatic.com; connect-src 'self';"
</IfModule>

# Limiter les méthodes HTTP
<LimitExcept GET POST>
    Require all denied
</LimitExcept>