window.__heroVideosInitialized||(window.__heroVideosInitialized=!0,document.addEventListener("DOMContentLoaded",()=>{const e="function"==typeof window.matchMedia,t=e?window.matchMedia("(prefers-reduced-motion: reduce)"):null,n=e?window.matchMedia("(pointer: coarse)"):null,a=e=>!(!e||!("matches"in e))&&e.matches,i=async e=>{if(e&&autoPlayAllowed)try{const t=e.play();if(t&&"function"==typeof t.catch)return await t.catch(e=>(e.message?.includes("interrupted")||e.message?.includes("aborted")||console.debug("Hero Videos: Play error handled:",e.name),Promise.resolve()))}catch(e){console.debug("Hero Videos: Play error handled:",e.name)}},r=({container:e,getNext:t,thresholdSeconds:n})=>{const a=new WeakMap,i=new WeakMap,r=()=>{const e=t();if(e)if(e.readyState>=2)a.set(e,!0);else if(!a.get(e)){a.set(e,!0);try{e.load()}catch(e){console.debug("Hero Videos: Load error ignored:",e)}}};return[["pointerdown",{passive:!0}],["pointerenter",!1],["touchstart",{passive:!0}],["focusin",!1]].forEach(([t,n])=>{const a=void 0!==n&&n;e.addEventListener(t,r,a)}),{mark:e=>{e&&a.set(e,!1)},prime:r,monitor:e=>{if(!e)return;if(i.has(e)){const t=i.get(e);e.removeEventListener("timeupdate",t),i.delete(e)}const o=()=>{const d=t();if(!d)return;if(d.readyState>=2)return a.set(d,!0),e.removeEventListener("timeupdate",o),void i.delete(e);if(a.get(d))return;const{duration:s,currentTime:l}=e;!Number.isFinite(s)||s<=0?l>=n&&(r(),e.removeEventListener("timeupdate",o),i.delete(e)):s-l<=n&&(r(),e.removeEventListener("timeupdate",o),i.delete(e))};i.set(e,o),e.addEventListener("timeupdate",o)},reset:e=>{if(!e)return;const t=i.get(e);t&&(e.removeEventListener("timeupdate",t),i.delete(e))}}};document.querySelectorAll(".hero-videos").forEach(e=>{e.setAttribute("data-managed-by","hero-videos"),e.style.setProperty("--hero-managed","true");const o=a(t),d=a(n),s=o||d,l=!o;let c=null,u=[];try{const t=e.dataset.videos||"[]",n=JSON.parse(t);Array.isArray(n)&&(u=n.filter(e=>"string"==typeof e&&""!==e.trim()))}catch{}const p=(e.dataset.main||"").trim();if(p&&0===u.length)u=[p];else if(!p&&0===u.length)return;const y=(e,t=!0)=>{const n=document.createElement("video");return n.src=e,n.muted=!0,n.playsInline=!0,n.setAttribute("playsinline",""),n.preload="metadata",n.autoplay=l,n.loop=!1,n.style.position="absolute",n.style.inset="0",n.style.width="100%",n.style.height="100%",n.style.objectFit="cover",n.style.pointerEvents="none",n.style.transition="opacity 1000ms ease, filter 1000ms ease",n.style.opacity=t?"0":"1",n.style.filter=t?"blur(8px)":"blur(0)",n};if(p&&(u.length>1||1===u.length&&u[0]!==p)){let t=!0,n=y(p,!0);e.appendChild(n);let a=null,i=[...u];const o=()=>{0===i.length&&(i=[...u]);const e=Math.floor(Math.random()*i.length);return i.splice(e,1)[0]},d=e=>{const t=e,n=()=>{l&&t.paused&&t.play().catch(e=>{console.debug("Hero Videos: Play error ignored:",e)}),requestAnimationFrame(()=>{t.style.opacity="1",t.style.filter="blur(0)"})};t.readyState>=2?n():t.addEventListener("canplay",n,{once:!0})};if(s)return n.loop=!0,n.addEventListener("loadeddata",()=>{l&&n.paused&&n.play().catch(()=>{}),d(n)},{once:!0}),n.addEventListener("ended",()=>{l&&(n.currentTime=0,n.play().catch(()=>{}))}),setTimeout(()=>{"1"!==n.style.opacity&&d(n)},300),void document.addEventListener("visibilitychange",()=>{"visible"===document.visibilityState&&l&&n.paused&&n.play().catch(()=>{})});const c=r({container:e,getNext:()=>a,thresholdSeconds:10}),m=()=>{const e=t?o():p;t=!t;const n=y(e,!0);return n.addEventListener("error",()=>{setTimeout(()=>{n.parentNode&&n.parentNode.removeChild(n),v()},100)}),n},v=()=>{a=m(),c.mark(a),e.appendChild(a)},h=()=>{a||v(),c.prime();const e=()=>{var e,t;t=()=>{l&&a.play().catch(()=>{}),requestAnimationFrame(()=>{a.style.opacity="1",a.style.filter="blur(0)",n.style.opacity="0",n.style.filter="blur(8px)";const e=n;n=a,e.addEventListener("transitionend",()=>{c.reset(e),e.parentNode&&e.parentNode.removeChild(e),n.addEventListener("ended",h,{once:!0}),n.paused?n.addEventListener("playing",()=>{c.monitor(n)},{once:!0}):c.monitor(n),v()},{once:!0})})},(e=a).readyState>=3?t():(e.addEventListener("canplaythrough",t,{once:!0}),setTimeout(t,5e3))};a.readyState>=2?e():a.addEventListener("canplay",e,{once:!0})};return n.addEventListener("loadeddata",()=>{d(n)},{once:!0}),n.addEventListener("playing",()=>{v(),n.addEventListener("ended",h,{once:!0}),c.monitor(n)},{once:!0}),setTimeout(()=>{"1"!==n.style.opacity&&d(n)},300),void document.addEventListener("visibilitychange",()=>{"visible"===document.visibilityState&&l&&[n,a].forEach(e=>e&&e.paused&&e.play().catch(()=>{}))})}if(1===u.length){const t=u[0],n=y(t,!0);n.loop=!0;const a=()=>{requestAnimationFrame(()=>{n.style.opacity="1",n.style.filter="blur(0)"})};return n.addEventListener("loadeddata",()=>{l&&n.paused&&n.play().catch(()=>{}),a()},{once:!0}),n.addEventListener("ended",()=>{n.currentTime=0,l&&n.play().catch(()=>{})}),n.addEventListener("error",()=>{setTimeout(()=>{n.load(),l&&n.play().catch(()=>{})},500)}),e.appendChild(n),void document.addEventListener("visibilitychange",()=>{"visible"===document.visibilityState&&l&&n.paused&&n.play().catch(()=>{})})}let m=0,v=y(u[m],!0);e.appendChild(v);let h=null;const f=e=>{const t=e,n=()=>{l&&t.paused&&t.play().catch(()=>{}),requestAnimationFrame(()=>{t.style.opacity="1",t.style.filter="blur(0)"})};t.readyState>=2?n():t.addEventListener("canplay",n,{once:!0})};if(s)return v.loop=!0,v.addEventListener("loadeddata",()=>{v.paused&&i(v),f(v)},{once:!0}),v.addEventListener("ended",()=>{l&&(v.currentTime=0,i(v))}),setTimeout(()=>{"1"!==v.style.opacity&&f(v)},300),void document.addEventListener("visibilitychange",()=>{"visible"===document.visibilityState&&v.paused&&i(v)});const E=r({container:e,getNext:()=>h,thresholdSeconds:10}),L=()=>{h=(()=>{m=(m+1)%u.length;const e=y(u[m],!0);return e.addEventListener("error",()=>{setTimeout(()=>{e.parentNode&&e.parentNode.removeChild(e),L()},100)}),e})(),E.mark(h),e.appendChild(h)},g=()=>{h||L(),E.prime();const e=()=>{var e,t;t=()=>{l&&h.play().catch(()=>{}),requestAnimationFrame(()=>{h.style.opacity="1",h.style.filter="blur(0)",v.style.opacity="0",v.style.filter="blur(8px)";const e=v;v=h,e.addEventListener("transitionend",()=>{E.reset(e),e.parentNode&&e.parentNode.removeChild(e),v.addEventListener("ended",g,{once:!0}),v.paused?v.addEventListener("playing",()=>{E.monitor(v)},{once:!0}):E.monitor(v),L()},{once:!0})})},(e=h).readyState>=3?t():(e.addEventListener("canplaythrough",t,{once:!0}),setTimeout(t,5e3))};h.readyState>=2?e():h.addEventListener("canplay",e,{once:!0})};v.addEventListener("loadeddata",()=>{f(v)},{once:!0}),v.addEventListener("playing",()=>{L(),v.addEventListener("ended",g,{once:!0}),E.monitor(v)},{once:!0}),setTimeout(()=>{"1"!==v.style.opacity&&f(v)},300),document.addEventListener("visibilitychange",()=>{"visible"===document.visibilityState&&l&&[v,h].forEach(e=>e&&e.paused&&e.play().catch(()=>{}))}),c=setInterval(()=>{if("visible"!==document.visibilityState)return;const t=e.querySelectorAll("video");if(0===t.length)return;let n=!1,a=null;for(const e of t){const t=parseFloat(e.style.opacity||"0")>.5;if(!e.paused&&!e.ended&&t){n=!0;break}t&&(e.paused||e.ended)&&(a=e)}if(!n&&a&&l){const e=a.dataset.lastRestart||"0",t=Date.now();t-parseInt(e)>3e3&&(a.dataset.lastRestart=String(t),a.currentTime=0,a.play().catch(()=>{}))}else if(!n&&t.length>0&&l){const e=t[0],n=e.dataset.lastRestart||"0",a=Date.now();a-parseInt(n)>3e3&&(e.dataset.lastRestart=String(a),e.style.opacity="1",e.style.filter="blur(0)",e.currentTime=0,e.play().catch(()=>{}))}},5e3);const b=()=>{c&&(clearInterval(c),c=null)};window.addEventListener("beforeunload",b),window.addEventListener("pagehide",b)})}));