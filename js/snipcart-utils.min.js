class SnipcartUtils{static createAddToCartButton(t,e={}){const{quantity:i=1,customFields:a={},className:r="snipcart-add-item btn btn-primary",text:n="Ajouter au panier",...o}=e,u=document.createElement("button");u.className=r,u.textContent=n;const s={"data-item-id":t.id,"data-item-name":t.name,"data-item-description":t.summary||t.description||"","data-item-price":t.price.toString(),"data-item-quantity":i.toString()};return t.name_en&&(s["data-item-name-en"]=t.name_en),t.summary_en&&(s["data-item-description-en"]=t.summary_en),t.url&&(s["data-item-url"]=t.url),Object.entries(s).forEach(([t,e])=>{u.setAttribute(t,e)}),Object.entries(a).forEach(([t,e])=>{const i=t.replace("custom","");u.setAttribute(`data-item-custom${i}-name`,e.name),u.setAttribute(`data-item-custom${i}-type`,e.type),u.setAttribute(`data-item-custom${i}-options`,e.options),u.setAttribute(`data-item-custom${i}-value`,e.value),e.role&&u.setAttribute(`data-item-custom${i}-role`,e.role)}),Object.entries(o).forEach(([t,e])=>{u.setAttribute(t,e)}),u}static addToCart(t,e={}){const i=this.createAddToCartButton(t,e);i.style.display="none",document.body.appendChild(i),i.click(),setTimeout(()=>{i.parentNode&&i.parentNode.removeChild(i)},100)}static addFromButton(t,e=null){e&&(e.preventDefault(),e.stopPropagation());const i=this.extractProductDataFromButton(t);if(window.Snipcart&&window.Snipcart.api&&window.Snipcart.api.cart)try{return window.Snipcart.api.cart.items.add(i),console.log("âœ… Produit ajoutÃ© via API Snipcart:",i),!0}catch(t){console.warn("âš ï¸ Erreur API Snipcart, fallback vers mÃ©thode HTML:",t)}console.log("ðŸ“¦ Utilisation du systÃ¨me Snipcart HTML standard");const a=t.cloneNode(!0);return a.style.display="none",document.body.appendChild(a),setTimeout(()=>{a.click(),document.body.removeChild(a)},10),!0}static extractProductDataFromButton(t){const e={id:t.getAttribute("data-item-id"),name:t.getAttribute("data-item-name"),price:parseFloat(t.getAttribute("data-item-price")||"0"),url:t.getAttribute("data-item-url")||window.location.href,quantity:parseInt(t.getAttribute("data-item-quantity")||"1"),description:t.getAttribute("data-item-description")},i=t.getAttribute("data-item-image");i&&(e.image=i),e.customFields=[];for(let i=1;i<=5;i++){const a=t.getAttribute(`data-item-custom${i}-name`),r=t.getAttribute(`data-item-custom${i}-value`);a&&r&&e.customFields.push({name:a,value:r})}return e}static addMultipleToCart(t,e=null){if(!t||0===t.length)return void(e&&e(0,0));let i=0;const a=r=>{if(r>=t.length)return;const n=t[r];try{this.addToCart(n.product,{quantity:n.quantity,customFields:n.customFields||{}}),i++,e&&e(i,t.length),setTimeout(()=>a(r+1),500)}catch(t){console.error("Erreur ajout produit au panier:",t,n),setTimeout(()=>a(r+1),500)}};a(0)}static updateCartButton(t,e={}){const{quantity:i,metal:a,multiplier:r,triptych:n,language:o}=e;void 0!==i&&t.setAttribute("data-item-quantity",i.toString()),this.updateCustomFields(t,e)}static updateCustomFields(t,e){const{metal:i,multiplier:a,triptych:r,language:n}=e;if(void 0!==i){const e=this.findCustomFieldByRole(t,"metal");e&&t.setAttribute(`data-item-custom${e}-value`,i)}if(void 0!==a){const e=this.findCustomFieldByRole(t,"multiplier");e&&t.setAttribute(`data-item-custom${e}-value`,a.toString())}if(void 0!==r){const e=this.findCustomFieldByRole(t,"triptych");e&&t.setAttribute(`data-item-custom${e}-value`,r)}if(void 0!==n){const e=this.findCustomFieldByRole(t,"language");e&&t.setAttribute(`data-item-custom${e}-value`,n)}}static findCustomFieldByRole(t,e){const i=Array.from(t.attributes);for(const t of i){const i=t.name.match(/^data-item-custom(\d+)-role$/);if(i&&t.value===e)return i[1]}return null}static extractProductDataFromButton(t){return{id:t.getAttribute("data-item-id"),name:t.getAttribute("data-item-name"),description:t.getAttribute("data-item-description"),price:parseFloat(t.getAttribute("data-item-price")),quantity:parseInt(t.getAttribute("data-item-quantity")),url:t.getAttribute("data-item-url")}}static createLotProductData(t){const{product:e,quantity:i,customFields:a,displayName:r}=t;return{product:{id:e.id,name:r||e.name,summary:e.summary,price:e.price,url:`product.php?id=${encodeURIComponent(e.id)}`},quantity:i,customFields:a||{}}}static translateMetal(t,e="fr"){const i=`shop.converter.metals.${t}`,a=this.getTranslation(i);if(a)return a;return{fr:{copper:"cuivre",silver:"argent",electrum:"Ã©lectrum",gold:"or",platinum:"platine"},en:{copper:"copper",silver:"silver",electrum:"electrum",gold:"gold",platinum:"platinum"}}[e]?.[t]||t}static getCurrentLang(){return document.documentElement.lang||"fr"}static getTranslation(t,e=""){if(window.i18n){const i=t.split(".");let a=window.i18n;for(const t of i){if(!a||"object"!=typeof a||!(t in a))return e;a=a[t]}return"string"==typeof a?a:e}return e}}window.SnipcartUtils=SnipcartUtils;