<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Présentation - Contrats de Location Batteries Golf | EDS Québec</title>
    <style>
        :root {
            --primary-blue: #3b82f6;
            --secondary-green: #10b981;
            --accent-light-blue: #60a5fa;
            --accent-light-green: #34d399;
            --text-dark: #f9fafb;
            --text-light: #d1d5db;
            --background-dark: #0f172a;
            --background-card: #1e293b;
            --white: #ffffff;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: var(--text-dark);
            background: var(--background-dark);
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
        }

        .section {
            margin: 60px 0;
        }

        /* Header */
        .header {
            background: linear-gradient(135deg, var(--primary-blue), var(--secondary-green));
            color: white;
            padding: 40px 0;
            text-align: center;
        }

        .header h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
            font-weight: 700;
        }

        .header .tagline {
            font-size: 1.2rem;
            opacity: 0.9;
            margin-bottom: 5px;
        }

        .header .subtitle {
            font-size: 1rem;
            opacity: 0.8;
        }

        /* Hero Section */
        .hero {
            background: var(--background-card);
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            margin-top: -30px;
            position: relative;
            z-index: 2;
            overflow: hidden;
            border: 1px solid rgba(59, 130, 246, 0.2);
        }

        .hero-content {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 40px;
            align-items: center;
            padding: 60px;
        }

        .hero-text h2 {
            font-size: 3rem;
            color: var(--primary-blue);
            margin-bottom: 20px;
            line-height: 1.2;
        }

        .hero-text .subtitle {
            font-size: 1.4rem;
            color: var(--secondary-green);
            font-weight: 600;
            margin-bottom: 30px;
        }

        .hero-image {
            position: relative;
            border-radius: 15px;
            overflow: hidden;
            box-shadow: 0 15px 40px rgba(0,0,0,0.2);
        }

        .hero-image img {
            width: 100%;
            height: 400px;
            object-fit: cover;
            transition: transform 0.3s ease;
        }

        .hero-image:hover img {
            transform: scale(1.05);
        }

        /* Problem Section */
        .problem-section {
            background: linear-gradient(135deg, #fee2e2, #fef3c7);
            border-radius: 20px;
            padding: 60px;
            margin: 60px 0;
        }

        .problem-title {
            font-size: 2.5rem;
            color: #dc2626;
            text-align: center;
            margin-bottom: 40px;
            font-weight: 700;
        }

        .problems-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 30px;
            justify-items: center;
        }

        @media (max-width: 1024px) {
            .problems-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        @media (max-width: 768px) {
            .problems-grid {
                grid-template-columns: 1fr;
            }
        }

        .problem-card {
            background: var(--background-card);
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 10px 25px rgba(0,0,0,0.3);
            border-left: 5px solid #ef4444;
            border: 1px solid rgba(239, 68, 68, 0.2);
            width: 100%;
            max-width: 350px;
        }

        .problem-card h3 {
            color: #dc2626;
            font-size: 1.3rem;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
        }

        .problem-card h3::before {
            content: "❌";
            margin-right: 10px;
            font-size: 1.5rem;
        }

        /* Problem Details Section */
        .problem-details-section {
            margin-top: 40px;
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
            gap: 30px;
        }

        .problem-detail-card {
            background: rgba(239, 68, 68, 0.1);
            border: 2px solid rgba(239, 68, 68, 0.3);
            border-radius: 15px;
            padding: 30px;
            transition: all 0.3s ease;
        }

        .problem-detail-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 30px rgba(239, 68, 68, 0.2);
            border-color: rgba(239, 68, 68, 0.5);
        }

        .problem-detail-card h3 {
            color: #dc2626;
            font-size: 1.4rem;
            margin-bottom: 10px;
            font-weight: 700;
        }

        .detail-subtitle {
            color: #4b5563; /* Gris foncé pour meilleur contraste */
            font-style: italic;
            margin-bottom: 20px;
            font-size: 1rem;
            font-weight: 600;
        }

        .detail-points {
            list-style: none;
            padding: 0;
            margin-bottom: 20px;
        }

        .detail-points li {
            padding: 8px 0;
            padding-left: 25px;
            position: relative;
            color: #1f2937; /* Couleur foncée pour contraste */
            font-size: 0.95rem;
            font-weight: 500;
        }

        .detail-points li::before {
            content: "⚠️";
            position: absolute;
            left: 0;
            top: 8px;
        }

        .calculation-box {
            background: rgba(239, 68, 68, 0.3);
            border-radius: 10px;
            padding: 15px;
            text-align: center;
            font-size: 1.1rem;
            color: #991b1b; /* Rouge plus foncé pour contraste */
            border: 2px solid rgba(239, 68, 68, 0.6);
            font-weight: 700;
        }

        /* Section Total avec style distinct */
        .problem-detail-card.total-section {
            background: linear-gradient(135deg, rgba(239, 68, 68, 0.2), rgba(220, 38, 38, 0.1));
            border: 3px solid #dc2626;
            box-shadow: 0 10px 25px rgba(239, 68, 68, 0.3);
        }

        .problem-detail-card.total-section h3 {
            color: #991b1b;
            font-size: 1.6rem;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.1);
        }

        .calculation-box.total-calculation {
            background: linear-gradient(135deg, rgba(239, 68, 68, 0.4), rgba(220, 38, 38, 0.3));
            border: 3px solid #dc2626;
            color: #7f1d1d; /* Rouge très foncé */
            font-size: 1.3rem;
            font-weight: 800;
            text-shadow: 1px 1px 2px rgba(255,255,255,0.8);
        }

        @media (max-width: 768px) {
            .problem-details-section {
                grid-template-columns: 1fr;
                gap: 20px;
            }

            .problem-detail-card {
                padding: 20px;
            }
        }

        /* Solution Section */
        .solution-section {
            background: linear-gradient(135deg, #dcfdf7, #dbeafe);
            border-radius: 20px;
            padding: 60px;
            margin: 60px 0;
        }

        .solution-title {
            font-size: 2.5rem;
            color: var(--secondary-green);
            text-align: center;
            margin-bottom: 40px;
            font-weight: 700;
        }

        .solution-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 40px;
            align-items: center;
        }

        .solution-features {
            display: grid;
            gap: 20px;
        }

        .feature-card {
            background: var(--background-card);
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 8px 20px rgba(0,0,0,0.3);
            border-left: 5px solid var(--secondary-green);
            border: 1px solid rgba(16, 185, 129, 0.2);
        }

        .feature-card h3 {
            color: var(--secondary-green);
            font-size: 1.2rem;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
        }

        .feature-card h3::before {
            content: "✅";
            margin-right: 10px;
            font-size: 1.3rem;
        }

        /* Cart Calculator Section */
        .cart-calculator-section {
            background: linear-gradient(135deg, var(--primary-blue), var(--secondary-green));
            color: white;
            border-radius: 20px;
            padding: 40px;
            margin: 60px 0;
            text-align: center;
            box-shadow: 0 15px 40px rgba(0,0,0,0.3);
        }

        .cart-calculator-title {
            font-size: 2rem;
            margin-bottom: 10px;
            font-weight: 700;
        }

        .cart-calculator-subtitle {
            font-size: 1.1rem;
            opacity: 0.9;
            margin-bottom: 30px;
        }

        .cart-slider-container {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 20px;
            flex-wrap: wrap;
            margin-bottom: 20px;
        }

        .cart-count-label {
            font-size: 1.2rem;
            font-weight: 600;
        }

        .cart-slider {
            width: 300px;
            height: 8px;
            border-radius: 5px;
            background: rgba(255,255,255,0.3);
            outline: none;
            -webkit-appearance: none;
        }

        .cart-slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 25px;
            height: 25px;
            border-radius: 50%;
            background: white;
            cursor: pointer;
            box-shadow: 0 4px 12px rgba(0,0,0,0.3);
        }

        .cart-slider::-moz-range-thumb {
            width: 25px;
            height: 25px;
            border-radius: 50%;
            background: white;
            cursor: pointer;
            border: none;
            box-shadow: 0 4px 12px rgba(0,0,0,0.3);
        }

        .cart-value-display {
            background: rgba(255,255,255,0.2);
            border-radius: 10px;
            padding: 10px 20px;
            font-size: 1.5rem;
            font-weight: 700;
            min-width: 150px;
        }

        @media (max-width: 768px) {
            .cart-slider-container {
                flex-direction: column;
                gap: 15px;
            }

            .cart-slider {
                width: 250px;
            }
        }

        /* Pricing Section */
        .pricing-section {
            background: var(--background-card);
            border-radius: 20px;
            padding: 60px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            border: 1px solid rgba(59, 130, 246, 0.2);
        }

        .pricing-title {
            font-size: 2.5rem;
            color: var(--primary-blue);
            text-align: center;
            margin-bottom: 50px;
            font-weight: 700;
        }

        .pricing-cards {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 30px;
        }

        @media (max-width: 1024px) {
            .pricing-cards {
                grid-template-columns: 1fr;
                gap: 30px;
            }
        }

        .pricing-card {
            background: linear-gradient(135deg, var(--primary-blue), var(--accent-light-blue));
            color: white;
            border-radius: 20px;
            padding: 40px;
            text-align: center;
            position: relative;
            overflow: hidden;
            cursor: pointer;
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }

        .pricing-card:hover {
            transform: translateY(-10px);
            box-shadow: 0 25px 70px rgba(0,0,0,0.2);
        }

        .pricing-card.premium {
            background: linear-gradient(135deg, var(--secondary-green), var(--accent-light-green));
        }

        .pricing-card.fleet {
            background: linear-gradient(135deg, #7c3aed, #a855f7);
            position: relative;
            transition: opacity 0.3s ease, transform 0.3s ease;
        }

        .pricing-card.fleet::before {
            content: "💼 OFFRE FLOTTE";
            position: absolute;
            top: -10px;
            left: 50%;
            transform: translateX(-50%);
            background: #7c3aed;
            color: white;
            padding: 5px 15px;
            border-radius: 15px;
            font-size: 0.8rem;
            font-weight: 700;
        }

        .pricing-card h3 {
            font-size: 1.8rem;
            margin-bottom: 20px;
            font-weight: 700;
        }

        .pricing-card .price {
            font-size: 3rem;
            font-weight: 800;
            margin-bottom: 10px;
        }

        .pricing-card .period {
            font-size: 1.1rem;
            opacity: 0.9;
            margin-bottom: 20px;
        }

        .savings {
            background: rgba(255,255,255,0.2);
            border-radius: 10px;
            padding: 15px;
            margin-top: 20px;
            font-weight: 600;
        }

        /* Comparison Table */
        .comparison-section {
            background: var(--background-card);
            border-radius: 20px;
            padding: 60px;
            box-shadow: 0 15px 40px rgba(0,0,0,0.3);
            margin: 60px 0;
            border: 1px solid rgba(59, 130, 246, 0.2);
        }

        .comparison-title {
            font-size: 2.2rem;
            color: var(--primary-blue);
            text-align: center;
            margin-bottom: 40px;
            font-weight: 700;
        }

        .comparison-table {
            width: 100%;
            border-collapse: collapse;
            border-radius: 15px;
            overflow: hidden;
            box-shadow: 0 10px 25px rgba(0,0,0,0.3);
            background-color: var(--background-card) !important;
        }

        .comparison-table th {
            background: linear-gradient(135deg, var(--primary-blue), var(--secondary-green));
            color: white;
            padding: 20px;
            font-size: 1.1rem;
            font-weight: 600;
        }

        .comparison-table td {
            padding: 20px;
            border-bottom: 1px solid rgba(59, 130, 246, 0.2);
            text-align: center;
            font-size: 1rem;
            color: var(--text-dark) !important;
            background-color: var(--background-card) !important;
        }

        .comparison-table tr:nth-child(even) td {
            background-color: rgba(59, 130, 246, 0.1) !important;
        }

        .comparison-table tr:nth-child(odd) td {
            background-color: var(--background-card) !important;
        }

        .comparison-table tr {
            background-color: transparent !important;
        }

        .comparison-table .old-tech {
            color: #dc2626;
            font-weight: 600;
        }

        .comparison-table .new-tech {
            color: var(--secondary-green);
            font-weight: 600;
        }

        /* Benefits Section */
        .benefits-section {
            background: linear-gradient(135deg, #fef3c7, #dcfdf7);
            border-radius: 20px;
            padding: 60px;
            margin: 60px 0;
        }

        .benefits-title {
            font-size: 2.5rem;
            color: var(--primary-blue);
            text-align: center;
            margin-bottom: 40px;
            font-weight: 700;
        }

        .benefits-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 30px;
            justify-items: center;
        }

        @media (max-width: 1024px) {
            .benefits-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        @media (max-width: 768px) {
            .benefits-grid {
                grid-template-columns: 1fr;
            }
        }

        .benefit-card {
            background: var(--background-card);
            border-radius: 15px;
            padding: 30px;
            text-align: center;
            box-shadow: 0 10px 25px rgba(0,0,0,0.3);
            transition: transform 0.3s ease;
            border: 1px solid rgba(59, 130, 246, 0.1);
            width: 100%;
            max-width: 350px;
        }

        .benefit-card:hover {
            transform: translateY(-5px);
        }

        .benefit-card .icon {
            font-size: 3rem;
            margin-bottom: 20px;
            display: block;
        }

        .benefit-card h3 {
            color: var(--primary-blue);
            font-size: 1.2rem;
            margin-bottom: 15px;
            font-weight: 600;
        }

        /* Testimonial */
        .testimonial-section {
            background: var(--background-card);
            border-radius: 20px;
            padding: 60px;
            box-shadow: 0 15px 40px rgba(0,0,0,0.3);
            text-align: center;
            margin: 60px 0;
            border: 1px solid rgba(16, 185, 129, 0.2);
        }

        .testimonial-quote {
            font-size: 1.4rem;
            color: var(--text-dark);
            font-style: italic;
            margin-bottom: 30px;
            line-height: 1.8;
        }

        .testimonial-quote::before,
        .testimonial-quote::after {
            content: '"';
            font-size: 2rem;
            color: var(--secondary-green);
            font-weight: bold;
        }

        .testimonial-author {
            font-size: 1.1rem;
            font-weight: 600;
            color: var(--primary-blue);
            margin-bottom: 5px;
        }

        .testimonial-title {
            color: var(--text-light);
            margin-bottom: 5px;
        }

        .testimonial-company {
            color: var(--secondary-green);
            font-weight: 600;
        }

        /* Contact Section */
        .contact-section {
            background: linear-gradient(135deg, var(--primary-blue), var(--secondary-green));
            color: white;
            border-radius: 20px;
            padding: 60px;
            text-align: center;
            margin: 60px 0;
        }

        .contact-title {
            font-size: 2.5rem;
            margin-bottom: 20px;
            font-weight: 700;
        }

        .contact-subtitle {
            font-size: 1.2rem;
            margin-bottom: 40px;
            opacity: 0.9;
        }

        .contact-info {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 30px;
            margin-top: 40px;
            justify-items: center;
            max-width: 800px;
            margin-left: auto;
            margin-right: auto;
        }

        @media (max-width: 768px) {
            .contact-info {
                grid-template-columns: 1fr;
                max-width: 400px;
            }
        }

        .contact-card {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            padding: 30px;
            backdrop-filter: blur(10px);
            width: 100%;
            max-width: 300px;
            text-align: center;
        }

        .contact-card h3 {
            font-size: 1.3rem;
            margin-bottom: 15px;
            font-weight: 600;
        }

        .contact-card p {
            font-size: 1.1rem;
            opacity: 0.9;
        }

        /* Calculateur Flottant */
        .floating-calculator {
            position: fixed;
            bottom: 20px;
            left: 20px;
            z-index: 998;
            background: rgba(0, 0, 0, 0.9);
            border-radius: 15px;
            padding: 15px;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(59, 130, 246, 0.3);
            min-width: 250px;
            transition: all 0.3s ease;
        }

        .floating-calculator h4 {
            color: var(--primary-blue);
            margin: 0 0 10px 0;
            font-size: 14px;
            font-weight: 600;
        }

        .cart-controls {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 10px;
        }

        .cart-slider-floating {
            flex: 1;
            height: 6px;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 3px;
            outline: none;
            -webkit-appearance: none;
        }

        .cart-slider-floating::-webkit-slider-thumb {
            -webkit-appearance: none;
            width: 18px;
            height: 18px;
            background: linear-gradient(135deg, var(--primary-blue), var(--secondary-green));
            border-radius: 50%;
            cursor: pointer;
            box-shadow: 0 2px 5px rgba(0,0,0,0.3);
        }

        .cart-slider-floating::-moz-range-thumb {
            width: 18px;
            height: 18px;
            background: linear-gradient(135deg, var(--primary-blue), var(--secondary-green));
            border-radius: 50%;
            cursor: pointer;
            border: none;
        }

        .cart-display {
            color: white;
            font-weight: 600;
            font-size: 16px;
            min-width: 60px;
            text-align: center;
        }

        .pricing-preview {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr;
            gap: 8px;
            font-size: 11px;
        }

        .pricing-mini {
            background: rgba(255, 255, 255, 0.1);
            padding: 8px;
            border-radius: 8px;
            text-align: center;
        }

        .pricing-mini .title {
            color: var(--primary-blue);
            font-weight: 600;
            margin-bottom: 4px;
        }

        .pricing-mini .price {
            color: white;
            font-weight: 700;
        }

        .pricing-mini.fleet-inactive {
            opacity: 0.5;
        }

        .pricing-mini.disabled {
            opacity: 0.4;
            background: rgba(107, 114, 128, 0.2);
        }

        .pricing-mini.disabled .title {
            color: #6b7280;
        }

        .pricing-mini.disabled .price {
            color: #9ca3af;
        }

        /* Calculation Details Section */
        .calculation-details-section {
            background: var(--background-card);
            border-radius: 20px;
            padding: 60px;
            margin: 60px 0;
            box-shadow: 0 15px 40px rgba(0,0,0,0.3);
            border: 1px solid rgba(59, 130, 246, 0.2);
        }

        .details-title {
            font-size: 2.5rem;
            color: var(--primary-blue);
            text-align: center;
            margin-bottom: 40px;
            font-weight: 700;
        }

        .details-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 30px;
            margin-top: 40px;
        }

        .detail-card {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 15px;
            padding: 30px;
            border: 2px solid transparent;
            transition: all 0.3s ease;
        }

        .detail-card h3 {
            font-size: 1.4rem;
            margin-bottom: 20px;
            font-weight: 600;
        }

        .lead-detail {
            border-color: rgba(220, 38, 38, 0.3);
        }

        .lead-detail h3 {
            color: #fca5a5;
        }

        .lithium-detail {
            border-color: rgba(16, 185, 129, 0.3);
        }

        .lithium-detail h3 {
            color: #6ee7b7;
        }

        .savings-detail {
            border-color: rgba(245, 158, 11, 0.3);
        }

        .savings-detail h3 {
            color: #fcd34d;
        }

        .roi-detail {
            border-color: rgba(99, 102, 241, 0.3);
        }

        .roi-detail h3 {
            color: #a5b4fc;
        }

        .detail-item {
            margin-bottom: 15px;
        }

        .detail-item strong {
            color: var(--text-dark);
            display: block;
            margin-bottom: 5px;
        }

        .detail-item p {
            color: var(--text-light);
            line-height: 1.6;
            margin: 0;
        }

        .detail-item strong[id$="-calc"],
        .detail-item strong[id$="-display"] {
            color: var(--secondary-green);
            font-size: 1.1rem;
        }

        @media (max-width: 768px) {
            .calculation-details-section {
                padding: 40px 20px;
            }

            .details-grid {
                grid-template-columns: 1fr;
                gap: 20px;
            }

            .details-title {
                font-size: 2rem;
            }
        }

        /* Audio Controller */
        .audio-controller {
            position: fixed;
            bottom: 20px;
            right: 20px;
            z-index: 999;
            display: flex;
            flex-direction: column;
            align-items: center;
            background: rgba(0, 0, 0, 0.8);
            border-radius: 15px;
            padding: 10px;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(59, 130, 246, 0.3);
            transition: all 0.3s ease;
        }

        .volume-control {
            opacity: 0;
            transform: translateY(10px);
            transition: all 0.3s ease;
            margin-bottom: 10px;
            pointer-events: none;
        }

        .audio-controller:hover .volume-control {
            opacity: 1;
            transform: translateY(0);
            pointer-events: all;
        }

        .volume-slider {
            width: 80px;
            height: 4px;
            background: rgba(255, 255, 255, 0.3);
            border-radius: 2px;
            outline: none;
            -webkit-appearance: none;
            cursor: pointer;
        }

        .volume-slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            width: 12px;
            height: 12px;
            background: var(--primary-blue);
            border-radius: 50%;
            cursor: pointer;
        }

        .volume-slider::-moz-range-thumb {
            width: 12px;
            height: 12px;
            background: var(--primary-blue);
            border-radius: 50%;
            cursor: pointer;
            border: none;
        }

        .play-pause-btn {
            width: 50px;
            height: 50px;
            border: none;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--primary-blue), var(--secondary-green));
            color: white;
            font-size: 18px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(59, 130, 246, 0.3);
        }

        .play-pause-btn:hover {
            transform: scale(1.1);
            box-shadow: 0 6px 20px rgba(59, 130, 246, 0.4);
        }

        .track-info {
            margin-top: 8px;
            font-size: 11px;
            color: rgba(255, 255, 255, 0.8);
            text-align: center;
            max-width: 100px;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            font-weight: 500;
        }

        /* Modal */
        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.8);
            backdrop-filter: blur(5px);
        }

        .modal-content {
            background-color: var(--background-card);
            margin: 5% auto;
            padding: 40px;
            border-radius: 20px;
            width: 80%;
            max-width: 800px;
            max-height: 80%;
            overflow-y: auto;
            position: relative;
            box-shadow: 0 25px 70px rgba(0,0,0,0.5);
            border: 1px solid rgba(59, 130, 246, 0.3);
            color: var(--text-dark);
        }

        .close {
            color: #aaa;
            float: right;
            font-size: 28px;
            font-weight: bold;
            cursor: pointer;
            position: absolute;
            right: 20px;
            top: 15px;
        }

        .close:hover {
            color: var(--primary-blue);
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .hero-content {
                grid-template-columns: 1fr;
                padding: 40px 30px;
            }

            .hero-text h2 {
                font-size: 2.2rem;
            }

            .pricing-cards {
                grid-template-columns: 1fr;
            }

            .solution-grid {
                grid-template-columns: 1fr;
            }

            .problems-grid {
                grid-template-columns: 1fr;
            }

            .header h1 {
                font-size: 1.8rem;
            }

            .section {
                margin: 40px 0;
            }

            .container {
                padding: 0 15px;
            }
        }

        /* Boutons de langue */
        .language-switcher {
            position: absolute;
            top: 20px;
            right: 20px;
            display: flex;
            gap: 10px;
            z-index: 1000;
        }

        .lang-btn {
            background: rgba(255, 255, 255, 0.1);
            border: 2px solid rgba(255, 255, 255, 0.3);
            border-radius: 8px;
            padding: 8px 12px;
            cursor: pointer;
            transition: all 0.3s ease;
            backdrop-filter: blur(10px);
            font-size: 14px;
            color: white;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .flag-icon {
            width: 24px;
            height: 16px;
            border-radius: 2px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.3);
        }

        .lang-btn:hover {
            background: rgba(255, 255, 255, 0.2);
            border-color: rgba(255, 255, 255, 0.5);
            transform: translateY(-2px);
        }

        .lang-btn.active {
            background: rgba(255, 255, 255, 0.3);
            border-color: rgba(255, 255, 255, 0.7);
            font-weight: bold;
        }

        /* Loading animation */
        .loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid rgba(255,255,255,.3);
            border-radius: 50%;
            border-top-color: #fff;
            animation: spin 1s ease-in-out infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* Fade in animation */
        .fade-in {
            opacity: 0;
            transform: translateY(30px);
            animation: fadeIn 0.8s ease forwards;
        }

        @keyframes fadeIn {
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* Autonomy Comparison Styles */
        .autonomy-comparison {
            margin-top: 15px;
            padding: 20px;
            background: linear-gradient(135deg, rgba(16, 185, 129, 0.1), rgba(59, 130, 246, 0.05));
            border-radius: 12px;
            border: 1px solid rgba(16, 185, 129, 0.2);
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }

        .autonomy-row {
            display: grid;
            grid-template-columns: 40px 1fr auto;
            align-items: center;
            gap: 12px;
            padding: 8px 0;
            border-bottom: 1px solid rgba(255,255,255,0.1);
        }

        .autonomy-row:last-of-type {
            border-bottom: none;
            margin-bottom: 10px;
        }

        .autonomy-icon {
            font-size: 1.2rem;
            text-align: center;
        }

        .autonomy-label {
            font-weight: 600;
            font-size: 0.95rem;
        }

        .autonomy-value {
            font-weight: 700;
            font-size: 0.9rem;
            padding: 4px 8px;
            border-radius: 6px;
            text-align: center;
            min-width: 80px;
        }

        .autonomy-row.lithium .autonomy-value {
            background: var(--secondary-green);
            color: white;
        }

        .autonomy-row.lead-new .autonomy-value,
        .autonomy-row.lead-old .autonomy-value {
            background: #dc2626;
            color: white;
        }

        .autonomy-summary {
            text-align: center;
            margin-top: 12px;
            padding-top: 12px;
            border-top: 1px solid rgba(255,255,255,0.2);
            font-size: 0.85rem;
            color: var(--text-light);
            font-style: italic;
        }
    </style>
</head>
<body>
    <!-- Header -->
    <header class="header">
        <div class="language-switcher">
            <button class="lang-btn active" onclick="switchLanguage('fr')" data-lang="fr">
                <img src="flags/france.svg" alt="Français" class="flag-icon">
                FR
            </button>
            <button class="lang-btn" onclick="switchLanguage('en')" data-lang="en">
                <img src="flags/england.svg" alt="English" class="flag-icon">
                EN
            </button>
        </div>
        <div class="container">
            <h1 id="company-name">Chargement...</h1>
            <p class="tagline" id="company-tagline">Chargement...</p>
            <p class="subtitle" id="company-subtitle">Chargement...</p>
        </div>
    </header>

    <main class="container">
        <!-- Hero Section -->
        <section class="hero fade-in">
            <div class="hero-content">
                <div class="hero-text">
                    <h2 id="hero-title">Chargement...</h2>
                    <p class="subtitle" id="hero-subtitle">Chargement...</p>
                </div>
                <div class="hero-image">
                    <img id="hero-image" src="images/golf_cart_sunset.jpg" alt="Voiturette de golf moderne">
                </div>
            </div>
        </section>

        <!-- Cart Calculator Section -->
        <section class="cart-calculator-section fade-in">
            <h2 class="cart-calculator-title" id="cart-calculator-title">Chargement...</h2>
            <p class="cart-calculator-subtitle" id="cart-calculator-subtitle">Chargement...</p>
            <div class="cart-slider-container">
                <label class="cart-count-label" id="cart-count-label">Chargement...</label>
                <input type="range" min="10" max="100" value="10" class="cart-slider" id="cartSlider">
                <div class="cart-value-display">
                    <span id="cart-count">10</span> <span id="cart-unit-suffix">Chargement...</span>
                </div>
            </div>
        </section>

        <!-- Problem Section -->
        <section class="problem-section fade-in">
            <h2 class="problem-title" id="problem-title">Chargement...</h2>
            <div class="problems-grid">
                <div class="problem-card">
                    <h3 id="problem-card-1-title">Chargement...</h3>
                    <p><strong id="cost-replacement">Chargement...</strong> <span id="problem-card-1-suffix">Chargement...</span></p>
                    <p><span id="problem-card-1-total-prefix">Chargement...</span> <strong id="cost-10-years">Chargement...</strong></p>
                </div>
                <div class="problem-card">
                    <h3 id="problem-card-2-title">Chargement...</h3>
                    <p><strong id="maintenance-hours">Chargement...</strong> <span id="problem-card-2-suffix">Chargement...</span></p>
                    <p><span id="problem-card-2-cost-prefix">Chargement...</span> <strong id="maintenance-cost">Chargement...</strong></p>
                </div>
                <div class="problem-card">
                    <h3 id="problem-card-3-title">Chargement...</h3>
                    <p><strong id="performance-issue">Chargement...</strong></p>
                    <p><span id="problem-card-3-charging-prefix">Chargement...</span> <strong id="charging-time">Chargement...</strong></p>
                </div>
                <div class="problem-card">
                    <h3 id="problem-card-4-title">Chargement...</h3>
                    <p><span id="problem-card-4-weight-prefix">Chargement...</span> <strong id="weight-old">Chargement...</strong></p>
                    <p><span id="problem-card-4-consumption-prefix">Chargement...</span> <strong id="extra-consumption">Chargement...</strong></p>
                </div>
                <div class="problem-card">
                    <h3 id="problem-card-5-title">Chargement...</h3>
                    <p><strong id="environmental-risk">Chargement...</strong></p>
                    <p id="problem-card-5-training">Chargement...</p>
                </div>
                <div class="problem-card">
                    <h3 id="problem-card-6-title">Chargement...</h3>
                    <p><strong id="safety-concerns">Chargement...</strong></p>
                    <p id="problem-card-6-risks">Chargement...</p>
                </div>
            </div>

            <!-- Detailed explanations of hidden costs -->
            <div class="problem-details-section">
                <div class="problem-detail-card">
                    <h3 id="problem-details-section-1-title">Chargement...</h3>
                    <p class="detail-subtitle" id="problem-details-section-1-subtitle">Chargement...</p>
                    <ul class="detail-points">
                        <li id="problem-details-section-1-point-1">Chargement...</li>
                        <li id="problem-details-section-1-point-2">Chargement...</li>
                        <li id="problem-details-section-1-point-3">Chargement...</li>
                        <li id="problem-details-section-1-point-4">Chargement...</li>
                    </ul>
                    <div class="calculation-box">
                        <strong id="problem-details-section-1-calculation">Chargement...</strong>
                    </div>
                </div>

                <div class="problem-detail-card">
                    <h3 id="problem-details-section-2-title">Chargement...</h3>
                    <p class="detail-subtitle" id="problem-details-section-2-subtitle">Chargement...</p>
                    <ul class="detail-points">
                        <li id="problem-details-section-2-point-1">Chargement...</li>
                        <li id="problem-details-section-2-point-2">Chargement...</li>
                        <li id="problem-details-section-2-point-3">Chargement...</li>
                        <li id="problem-details-section-2-point-4">Chargement...</li>
                    </ul>
                    <div class="calculation-box">
                        <strong id="problem-details-section-2-calculation">Chargement...</strong>
                    </div>
                </div>

                <div class="problem-detail-card">
                    <h3 id="problem-details-section-3-title">Chargement...</h3>
                    <p class="detail-subtitle" id="problem-details-section-3-subtitle">Chargement...</p>
                    <ul class="detail-points">
                        <li id="problem-details-section-3-point-1">Chargement...</li>
                        <li id="problem-details-section-3-point-2">Chargement...</li>
                        <li id="problem-details-section-3-point-3">Chargement...</li>
                        <li id="problem-details-section-3-point-4">Chargement...</li>
                    </ul>
                    <div class="calculation-box">
                        <strong id="problem-details-section-3-calculation">Chargement...</strong>
                    </div>
                </div>

                <div class="problem-detail-card total-section">
                    <h3 id="problem-details-section-4-title">Chargement...</h3>
                    <p class="detail-subtitle" id="problem-details-section-4-subtitle">Chargement...</p>
                    <ul class="detail-points">
                        <li id="problem-details-section-4-point-1">Chargement...</li>
                        <li id="problem-details-section-4-point-2">Chargement...</li>
                        <li id="problem-details-section-4-point-3">Chargement...</li>
                        <li id="problem-details-section-4-point-4">Chargement...</li>
                    </ul>
                    <div class="calculation-box total-calculation">
                        <strong id="problem-details-section-4-calculation">Chargement...</strong>
                    </div>
                </div>
            </div>
        </section>

        <!-- Solution Section -->
        <section class="solution-section fade-in">
            <h2 class="solution-title" id="solution-title">Chargement...</h2>
            <div class="solution-grid">
                <div class="solution-features">
                    <div class="feature-card">
                        <h3 id="solution-card-1-title">Chargement...</h3>
                        <p id="autonomy">Chargement...</p>
                        <div class="autonomy-comparison">
                            <div class="autonomy-row lithium">
                                <div class="autonomy-icon">🔋</div>
                                <div class="autonomy-label">EDS Lithium</div>
                                <div class="autonomy-value" id="autonomy-hours">Chargement...</div>
                            </div>
                            <div class="autonomy-row lead-new">
                                <div class="autonomy-icon">⚡</div>
                                <div class="autonomy-label">Plomb (neuf)</div>
                                <div class="autonomy-value" id="autonomy-new">Chargement...</div>
                            </div>
                            <div class="autonomy-row lead-old">
                                <div class="autonomy-icon">📉</div>
                                <div class="autonomy-label">Plomb (5 ans)</div>
                                <div class="autonomy-value" id="autonomy-degraded">Chargement...</div>
                            </div>
                            <div class="autonomy-summary">
                                <span id="autonomy-loss">Chargement...</span>
                            </div>
                        </div>
                    </div>
                    <div class="feature-card">
                        <h3 id="solution-card-2-title">Chargement...</h3>
                        <p><strong id="cycles">Chargement...</strong><span id="solution-card-2-lifespan-separator">Chargement...</span> <strong id="lifespan">Chargement...</strong></p>
                    </div>
                    <div class="feature-card">
                        <h3 id="solution-card-3-title">Chargement...</h3>
                        <p><span id="solution-card-3-charge-prefix">Chargement...</span> <strong id="charge-time">Chargement...</strong></p>
                        <p><strong id="maintenance">Chargement...</strong></p>
                    </div>
                    <div class="feature-card">
                        <h3 id="solution-card-4-title">Chargement...</h3>
                        <p><span id="solution-card-4-weight-prefix">Chargement...</span> <strong id="weight">Chargement...</strong></p>
                    </div>
                </div>
                <div class="solution-image">
                    <img src="images/battery_pack.jpg" alt="Pack de batteries lithium EDS Québec" style="width: 100%; border-radius: 15px; box-shadow: 0 15px 40px rgba(0,0,0,0.2);">
                </div>
            </div>
        </section>

        <!-- Comparison Table -->
        <section class="comparison-section fade-in">
            <h2 class="comparison-title" id="comparison-title">Chargement...</h2>
            <table class="comparison-table">
                <thead>
                    <tr>
                        <th id="comparison-criterion">Chargement...</th>
                        <th id="comparison-lead-batteries">Chargement...</th>
                        <th id="comparison-eds-solution">Chargement...</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><strong id="comparison-cost-10-years">Chargement...</strong></td>
                        <td class="old-tech" id="lead-batteries-10-years">Chargement...</td>
                        <td class="new-tech" id="contract-10-total">Chargement...</td>
                    </tr>
                    <tr>
                        <td><strong id="comparison-replacements">Chargement...</strong></td>
                        <td class="old-tech" id="lead-replacements">Chargement...</td>
                        <td class="new-tech" id="lithium-replacements">Chargement...</td>
                    </tr>
                    <tr>
                        <td><strong id="comparison-maintenance">Chargement...</strong></td>
                        <td class="old-tech" id="lead-maintenance">Chargement...</td>
                        <td class="new-tech" id="lithium-maintenance">Chargement...</td>
                    </tr>
                    <tr>
                        <td><strong id="comparison-charging-time">Chargement...</strong></td>
                        <td class="old-tech" id="lead-charging">Chargement...</td>
                        <td class="new-tech" id="lithium-charging">Chargement...</td>
                    </tr>
                </tbody>
            </table>
        </section>

        <!-- Pricing Section -->
        <section class="pricing-section fade-in">
            <h2 class="pricing-title" id="pricing-title">Chargement...</h2>
            <div class="pricing-cards">
                <div class="pricing-card" onclick="showPricingDetails('10')">
                    <h3 id="contract-10-title">Chargement...</h3>
                    <div class="price" id="contract-10-monthly">Chargement...</div>
                    <div class="period" id="pricing-total-suffix">Chargement...</div>
                    <div class="savings">
                        <span id="pricing-savings-prefix">Chargement...</span> <strong id="savings-10-years">Chargement...</strong> <span id="pricing-savings-10-suffix">Chargement...</span>
                    </div>
                </div>
                <div class="pricing-card premium" onclick="showPricingDetails('20')">
                    <h3 id="contract-20-title">Chargement...</h3>
                    <div class="price" id="contract-20-monthly">Chargement...</div>
                    <div class="period" id="pricing-total-suffix-2">Chargement...</div>
                    <div class="savings">
                        <span id="pricing-savings-20-prefix">Chargement...</span> <strong id="savings-20-years">Chargement...</strong> <span id="pricing-savings-20-suffix">Chargement...</span>
                    </div>
                </div>
                <div class="pricing-card fleet" onclick="showPricingDetails('fleet')">
                    <h3 id="contract-20-fleet-title">Chargement...</h3>
                    <div class="price" id="contract-20-fleet-monthly">Chargement...</div>
                    <div class="period" id="pricing-total-suffix-3">Chargement...</div>
                    <div class="savings">
                        <span id="pricing-savings-fleet-prefix">Chargement...</span> <strong id="savings-20-fleet">Chargement...</strong> <span id="pricing-savings-fleet-suffix">Chargement...</span>
                    </div>
                    <div style="margin-top: 15px; font-size: 0.9rem; opacity: 0.9;">
                        <span id="fleet-minimum-text">Minimum 30 voiturettes</span>
                    </div>
                </div>
            </div>
        </section>

        <!-- Calculation Details Section -->
        <section class="calculation-details-section fade-in">
            <div class="container">
                <h2 class="details-title">💡 Détails des Calculs (20 ans)</h2>

                <div class="details-grid">
                    <!-- 1. Batteries plomb - Coûts cachés -->
                    <div class="detail-card lead-detail">
                        <h3>⚠️ Batteries Plomb - Coûts Cachés</h3>
                        <div class="detail-item">
                            <strong>Cycle de remplacement :</strong>
                            <p id="lead-replacement-schedule">Chargement...</p>
                        </div>
                        <div class="detail-item">
                            <strong>Nombre de remplacements sur 20 ans :</strong>
                            <p id="lead-replacements-20y">Chargement...</p>
                        </div>
                        <div class="detail-item">
                            <strong>Coût total sur 20 ans :</strong>
                            <p>
                                <span id="lead-cost-breakdown-20y">Chargement...</span> =
                                <strong id="lead-total-calc-20y">Chargement...</strong>
                            </p>
                        </div>
                        <div class="detail-item">
                            <strong>Maintenance sur 20 ans :</strong>
                            <p id="lead-maintenance-total-20y">Chargement...</p>
                        </div>
                    </div>

                    <!-- 2. Solution lithium - Avantages -->
                    <div class="detail-card lithium-detail">
                        <h3>✅ Solution Lithium - Avantages</h3>
                        <div class="detail-item">
                            <strong>Durée de vie :</strong>
                            <p id="lithium-lifespan">Chargement...</p>
                        </div>
                        <div class="detail-item">
                            <strong>Remplacements sur 20 ans :</strong>
                            <p id="lithium-replacements-20y">Chargement...</p>
                        </div>
                        <div class="detail-item">
                            <strong>Coût total sur 20 ans :</strong>
                            <p>
                                <span id="lithium-cost-breakdown-20y">Chargement...</span> =
                                <strong id="lithium-total-calc-20y">Chargement...</strong>
                            </p>
                        </div>
                        <div class="detail-item">
                            <strong>Avantage clé :</strong>
                            <p id="lithium-advantage">Chargement...</p>
                        </div>
                    </div>

                    <!-- 3. Comparaison et économies -->
                    <div class="detail-card savings-detail">
                        <h3>💰 Comparaison & Économies</h3>
                        <div class="detail-item">
                            <strong>Économie brute sur 20 ans :</strong>
                            <p>
                                <span id="detailed-savings-calc-20y">Chargement...</span> =
                                <strong id="total-savings-display-20y">Chargement...</strong>
                            </p>
                        </div>
                        <div class="detail-item">
                            <strong>Fourchette selon remplacement :</strong>
                            <p id="savings-range-20y">Chargement...</p>
                        </div>
                        <div class="detail-item">
                            <strong>Pourcentage d'économie :</strong>
                            <p id="savings-percentage-20y">Chargement...</p>
                        </div>
                    </div>

                    <!-- 4. ROI et rentabilité -->
                    <div class="detail-card roi-detail">
                        <h3>📈 ROI & Rentabilité</h3>
                        <div class="detail-item">
                            <strong>Retour sur investissement :</strong>
                            <p id="roi-calculation">Chargement...</p>
                        </div>
                        <div class="detail-item">
                            <strong>Seuil de rentabilité :</strong>
                            <p id="break-even-point">Chargement...</p>
                        </div>
                        <div class="detail-item">
                            <strong>Économie mensuelle moyenne :</strong>
                            <p id="monthly-savings-average">Chargement...</p>
                        </div>
                        <div class="detail-item">
                            <strong>Économie par voiturette/mois :</strong>
                            <p id="per-cart-monthly-savings">Chargement...</p>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Benefits Section -->
        <section class="benefits-section fade-in">
            <h2 class="benefits-title" id="benefits-title">Chargement...</h2>
            <div class="benefits-grid">
                <div class="benefit-card">
                    <span class="icon">🔋</span>
                    <h3 id="benefits-reliability">Chargement...</h3>
                    <p id="benefit-1">Chargement...</p>
                </div>
                <div class="benefit-card">
                    <span class="icon">🔧</span>
                    <h3 id="benefits-simplicity">Chargement...</h3>
                    <p id="benefit-2">Chargement...</p>
                </div>
                <div class="benefit-card">
                    <span class="icon">🚀</span>
                    <h3 id="benefits-performance">Chargement...</h3>
                    <p id="benefit-3">Chargement...</p>
                </div>
                <div class="benefit-card">
                    <span class="icon">💰</span>
                    <h3 id="benefits-economy">Chargement...</h3>
                    <p id="benefit-4">Chargement...</p>
                </div>
                <div class="benefit-card">
                    <span class="icon">🤝</span>
                    <h3 id="benefits-partnership">Chargement...</h3>
                    <p id="benefit-5">Chargement...</p>
                </div>
                <div class="benefit-card">
                    <span class="icon">🌱</span>
                    <h3 id="benefits-ecology">Chargement...</h3>
                    <p id="benefit-6">Chargement...</p>
                </div>
            </div>
        </section>

        <!-- Testimonial Section -->
        <section class="testimonial-section fade-in">
            <p class="testimonial-quote" id="testimonial-quote">Chargement...</p>
            <div class="testimonial-author" id="testimonial-author">Chargement...</div>
            <div class="testimonial-title" id="testimonial-title">Chargement...</div>
            <div class="testimonial-company" id="testimonial-company">Chargement...</div>
        </section>

        <!-- Contact Section -->
        <section class="contact-section fade-in">
            <h2 class="contact-title" id="contact-title">Chargement...</h2>
            <p class="contact-subtitle" id="contact-subtitle">Chargement...</p>
            <div class="contact-info">
                <div class="contact-card">
                    <h3 id="specialist-name">Chargement...</h3>
                    <p id="specialist-title">Chargement...</p>
                </div>
                <div class="contact-card">
                    <h3 id="contact-phone-label">Chargement...</h3>
                    <p id="specialist-phone">Chargement...</p>
                </div>
                <div class="contact-card">
                    <h3 id="contact-email-label">Chargement...</h3>
                    <p id="specialist-email">Chargement...</p>
                </div>
                <div class="contact-card">
                    <h3 id="contact-website-label">Chargement...</h3>
                    <p id="website">Chargement...</p>
                </div>
            </div>
        </section>
    </main>

    <!-- Calculateur Flottant -->
    <div id="floatingCalculator" class="floating-calculator">
        <h4 id="floating-calc-title">Calculateur de Flotte</h4>
        <div class="cart-controls">
            <input type="range" id="cartSliderFloating" min="10" max="100" value="10" class="cart-slider-floating">
            <div class="cart-display">
                <span id="cart-count-floating">10</span> <span id="cart-unit-floating">voiturettes</span>
            </div>
        </div>
        <div class="pricing-preview">
            <div class="pricing-mini">
                <div class="title">10 ans</div>
                <div class="price" id="price-10-floating">976 $</div>
            </div>
            <div class="pricing-mini">
                <div class="title">20 ans</div>
                <div class="price" id="price-20-floating">843 $</div>
            </div>
            <div class="pricing-mini" id="price-fleet-card">
                <div class="title">Flotte</div>
                <div class="price" id="price-fleet-floating">767 $</div>
            </div>
        </div>
    </div>

    <!-- Contrôleur Audio -->
    <div id="audioController" class="audio-controller">
        <div id="volumeControl" class="volume-control">
            <input type="range" id="volumeSlider" min="0" max="100" value="15" class="volume-slider">
        </div>
        <button id="playPauseBtn" class="play-pause-btn">
            <span id="playIcon">▶</span>
            <span id="pauseIcon" style="display: none;">⏸</span>
        </button>
        <div id="trackInfo" class="track-info">♪</div>
    </div>

    <!-- Modal pour détails de prix -->
    <div id="pricingModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeModal()">&times;</span>
            <h2 id="modal-title">Détails du Contrat</h2>
            <div id="modal-content">
                <!-- Le contenu sera chargé dynamiquement -->
            </div>
        </div>
    </div>


    <script>
        // Données vides - tout sera chargé depuis le CSV
        let data = {};
        let currentLanguage = 'fr'; // Langue par défaut

        // Fonction pour changer de langue
        function switchLanguage(lang) {
            currentLanguage = lang;

            // Mettre à jour les boutons actifs
            document.querySelectorAll('.lang-btn').forEach(btn => {
                btn.classList.remove('active');
                if (btn.getAttribute('data-lang') === lang) {
                    btn.classList.add('active');
                }
            });

            // Recharger les données dans la nouvelle langue
            loadDataFromCSV();
        }

        // Fonction pour charger les données depuis le CSV
        async function loadDataFromCSV() {
            try {
                const csvFile = currentLanguage === 'fr' ? 'data.csv' : 'data_en.csv';
                const response = await fetch(csvFile + '?t=' + Date.now()); // Cache busting

                if (!response.ok) {
                    throw new Error(`Erreur HTTP: ${response.status}`);
                }
                const csvText = await response.text();

                const lines = csvText.split('\n');
                data = {}; // Reset des données

                for (let i = 1; i < lines.length; i++) {
                    const line = lines[i].trim();
                    if (line && !line.startsWith('#')) {
                        // Parser CSV simple
                        const parts = line.split(',');
                        if (parts.length >= 3) {
                            const section = parts[0].trim();
                            const key = parts[1].trim();
                            let value = parts.slice(2).join(',').trim();

                            // Enlever les guillemets si présents
                            if (value.startsWith('"') && value.endsWith('"')) {
                                value = value.slice(1, -1);
                            }

                            if (section && key) {
                                if (!data[section]) {
                                    data[section] = {};
                                }
                                data[section][key] = value;
                            }
                        }
                    }
                }

                // Données chargées
                updateContent();

            } catch (error) {
                console.error('Erreur lors du chargement des données:', error);
                // En cas d'erreur, essayer de charger le français par défaut
                if (currentLanguage !== 'fr') {
                    currentLanguage = 'fr';
                    loadDataFromCSV();
                }
            }
        }


        // Fonction utilitaire pour mettre à jour un élément de façon sécurisée
        function safeUpdateElement(id, value) {
            const element = document.getElementById(id);
            if (element && value) {
                element.textContent = value;
            } else if (!element) {
                console.warn(`Élément non trouvé: ${id}`);
            }
        }

        // Mettre à jour le contenu de la page
        function updateContent() {
            // Header
            safeUpdateElement('company-name', data.header?.company_name);
            safeUpdateElement('company-tagline', data.header?.company_tagline);
            safeUpdateElement('company-subtitle', data.header?.company_subtitle);

            // Hero
            safeUpdateElement('hero-title', data.hero?.main_title);
            safeUpdateElement('hero-subtitle', data.hero?.subtitle);

            // Problem
            safeUpdateElement('problem-title', data.problem?.title);
            // cost-replacement et cost-10-years seront mis à jour par updateCartCalculation()
            // safeUpdateElement('cost-replacement', data.problem?.cost_replacement);
            // safeUpdateElement('cost-10-years', data.problem?.cost_10_years);
            // maintenance-hours et maintenance-cost seront aussi mis à jour par updateCartCalculation()
            // safeUpdateElement('maintenance-hours', data.problem?.maintenance_hours);
            // safeUpdateElement('maintenance-cost', data.problem?.maintenance_cost);
            safeUpdateElement('performance-issue', data.problem?.performance_issue);
            safeUpdateElement('charging-time', data.problem?.charging_time);
            safeUpdateElement('weight-old', data.problem?.weight);
            safeUpdateElement('extra-consumption', data.problem?.extra_consumption);
            safeUpdateElement('environmental-risk', data.problem?.environmental_risk);
            safeUpdateElement('safety-concerns', data.problem?.safety_concerns);

            // Problem UI elements
            safeUpdateElement('problem-card-1-title', data.ui?.problem_card_1_title);
            safeUpdateElement('problem-card-1-suffix', data.ui?.problem_card_1_suffix);
            safeUpdateElement('problem-card-1-total-prefix', data.ui?.problem_card_1_total_prefix);
            safeUpdateElement('problem-card-2-title', data.ui?.problem_card_2_title);
            safeUpdateElement('problem-card-2-suffix', data.ui?.problem_card_2_suffix);
            safeUpdateElement('problem-card-2-cost-prefix', data.ui?.problem_card_2_cost_prefix);
            safeUpdateElement('problem-card-3-title', data.ui?.problem_card_3_title);
            safeUpdateElement('problem-card-3-charging-prefix', data.ui?.problem_card_3_charging_prefix);
            safeUpdateElement('problem-card-4-title', data.ui?.problem_card_4_title);
            safeUpdateElement('problem-card-4-weight-prefix', data.ui?.problem_card_4_weight_prefix);
            safeUpdateElement('problem-card-4-consumption-prefix', data.ui?.problem_card_4_consumption_prefix);
            safeUpdateElement('problem-card-5-title', data.ui?.problem_card_5_title);
            safeUpdateElement('problem-card-5-training', data.ui?.problem_card_5_training);
            safeUpdateElement('problem-card-6-title', data.ui?.problem_card_6_title);
            safeUpdateElement('problem-card-6-risks', data.ui?.problem_card_6_risks);

            // Problem Details Sections
            safeUpdateElement('problem-details-section-1-title', data.problem_details?.section_1_title);
            safeUpdateElement('problem-details-section-1-subtitle', data.problem_details?.section_1_subtitle);
            safeUpdateElement('problem-details-section-1-point-1', data.problem_details?.section_1_point_1);
            safeUpdateElement('problem-details-section-1-point-2', data.problem_details?.section_1_point_2);
            safeUpdateElement('problem-details-section-1-point-3', data.problem_details?.section_1_point_3);
            safeUpdateElement('problem-details-section-1-point-4', data.problem_details?.section_1_point_4);
            safeUpdateElement('problem-details-section-1-calculation', data.problem_details?.section_1_calculation);

            safeUpdateElement('problem-details-section-2-title', data.problem_details?.section_2_title);
            safeUpdateElement('problem-details-section-2-subtitle', data.problem_details?.section_2_subtitle);
            safeUpdateElement('problem-details-section-2-point-1', data.problem_details?.section_2_point_1);
            safeUpdateElement('problem-details-section-2-point-2', data.problem_details?.section_2_point_2);
            safeUpdateElement('problem-details-section-2-point-3', data.problem_details?.section_2_point_3);
            safeUpdateElement('problem-details-section-2-point-4', data.problem_details?.section_2_point_4);
            safeUpdateElement('problem-details-section-2-calculation', data.problem_details?.section_2_calculation);

            safeUpdateElement('problem-details-section-3-title', data.problem_details?.section_3_title);
            safeUpdateElement('problem-details-section-3-subtitle', data.problem_details?.section_3_subtitle);
            safeUpdateElement('problem-details-section-3-point-1', data.problem_details?.section_3_point_1);
            safeUpdateElement('problem-details-section-3-point-2', data.problem_details?.section_3_point_2);
            safeUpdateElement('problem-details-section-3-point-3', data.problem_details?.section_3_point_3);
            safeUpdateElement('problem-details-section-3-point-4', data.problem_details?.section_3_point_4);
            safeUpdateElement('problem-details-section-3-calculation', data.problem_details?.section_3_calculation);

            safeUpdateElement('problem-details-section-4-title', data.problem_details?.section_4_title);
            safeUpdateElement('problem-details-section-4-subtitle', data.problem_details?.section_4_subtitle);
            safeUpdateElement('problem-details-section-4-point-1', data.problem_details?.section_4_point_1);
            safeUpdateElement('problem-details-section-4-point-2', data.problem_details?.section_4_point_2);
            safeUpdateElement('problem-details-section-4-point-3', data.problem_details?.section_4_point_3);
            safeUpdateElement('problem-details-section-4-point-4', data.problem_details?.section_4_point_4);
            safeUpdateElement('problem-details-section-4-calculation', data.problem_details?.section_4_calculation);

            // Solution
            safeUpdateElement('solution-title', data.solution?.title);
            safeUpdateElement('autonomy', data.solution?.autonomy);
            safeUpdateElement('autonomy-hours', data.solution?.autonomy_hours);
            safeUpdateElement('cycles', data.solution?.cycles);
            safeUpdateElement('lifespan', data.solution?.lifespan);
            safeUpdateElement('charge-time', data.solution?.charge_time);
            safeUpdateElement('maintenance', data.solution?.maintenance);
            safeUpdateElement('weight', data.solution?.weight);

            // Autonomy comparison data
            safeUpdateElement('autonomy-new', data.problem?.autonomy_new);
            safeUpdateElement('autonomy-degraded', data.problem?.autonomy_degraded);
            safeUpdateElement('autonomy-loss', data.problem?.autonomy_loss);

            // Solution UI elements
            safeUpdateElement('solution-card-1-title', data.ui?.solution_card_1_title);
            safeUpdateElement('solution-card-2-title', data.ui?.solution_card_2_title);
            safeUpdateElement('solution-card-2-lifespan-separator', data.ui?.solution_card_2_lifespan_separator);
            safeUpdateElement('solution-card-3-title', data.ui?.solution_card_3_title);
            safeUpdateElement('solution-card-3-charge-prefix', data.ui?.solution_card_3_charge_prefix);
            safeUpdateElement('solution-card-4-title', data.ui?.solution_card_4_title);
            safeUpdateElement('solution-card-4-weight-prefix', data.ui?.solution_card_4_weight_prefix);

            // Comparison
            safeUpdateElement('comparison-title', data.ui?.comparison_title);
            safeUpdateElement('comparison-criterion', data.ui?.comparison_criterion);
            safeUpdateElement('comparison-lead-batteries', data.ui?.comparison_lead_batteries);
            safeUpdateElement('comparison-eds-solution', data.ui?.comparison_eds_solution);
            safeUpdateElement('comparison-cost-10-years', data.ui?.comparison_cost_10_years);
            safeUpdateElement('comparison-replacements', data.ui?.comparison_replacements);
            safeUpdateElement('comparison-maintenance', data.ui?.comparison_maintenance);
            safeUpdateElement('comparison-charging-time', data.ui?.comparison_charging_time);
            safeUpdateElement('lead-batteries-10-years', data.comparison?.lead_batteries_10_years);
            safeUpdateElement('lead-replacements', data.comparison?.lead_replacements);
            safeUpdateElement('lead-maintenance', data.comparison?.lead_maintenance);
            safeUpdateElement('lead-charging', data.comparison?.lead_charging);
            safeUpdateElement('lithium-replacements', data.comparison?.lithium_replacements);
            safeUpdateElement('lithium-maintenance', data.comparison?.lithium_maintenance);
            safeUpdateElement('lithium-charging', data.comparison?.lithium_charging);

            // Calculation details
            safeUpdateElement('lead-replacement-schedule', data.comparison?.lead_replacement_frequency);
            safeUpdateElement('lead-maintenance-detail', data.calculs?.lead_maintenance_detail);
            safeUpdateElement('lithium-lifespan', data.comparison?.lithium_lifespan);
            safeUpdateElement('lithium-advantage', data.calculs?.lithium_advantage);
            safeUpdateElement('savings-formula', data.calculs?.savings_formula);

            // Pricing
            safeUpdateElement('pricing-title', data.ui?.pricing_title);
            safeUpdateElement('contract-10-title', data.pricing?.contract_10_title);
            safeUpdateElement('contract-20-title', data.pricing?.contract_20_title);
            safeUpdateElement('contract-20-fleet-title', data.pricing?.contract_20_fleet_title);
            safeUpdateElement('pricing-total-suffix', data.ui?.pricing_total_suffix);
            safeUpdateElement('pricing-total-suffix-2', data.ui?.pricing_total_suffix);
            safeUpdateElement('pricing-total-suffix-3', data.ui?.pricing_total_suffix);
            safeUpdateElement('pricing-savings-prefix', data.ui?.pricing_savings_prefix);
            safeUpdateElement('pricing-savings-10-suffix', data.ui?.pricing_savings_10_suffix);
            safeUpdateElement('pricing-savings-20-prefix', data.ui?.pricing_savings_20_prefix);
            safeUpdateElement('pricing-savings-20-suffix', data.ui?.pricing_savings_20_suffix);
            safeUpdateElement('pricing-savings-fleet-prefix', data.ui?.pricing_savings_fleet_prefix);
            safeUpdateElement('pricing-savings-fleet-suffix', data.ui?.pricing_savings_fleet_suffix);
            safeUpdateElement('fleet-minimum-text', data.ui?.fleet_minimum_text);

            // Benefits
            safeUpdateElement('benefits-title', data.ui?.benefits_title);
            safeUpdateElement('benefits-reliability', data.ui?.benefits_reliability);
            safeUpdateElement('benefits-simplicity', data.ui?.benefits_simplicity);
            safeUpdateElement('benefits-performance', data.ui?.benefits_performance);
            safeUpdateElement('benefits-economy', data.ui?.benefits_economy);
            safeUpdateElement('benefits-partnership', data.ui?.benefits_partnership);
            safeUpdateElement('benefits-ecology', data.ui?.benefits_ecology);
            safeUpdateElement('benefit-1', data.benefits?.benefit_1);
            safeUpdateElement('benefit-2', data.benefits?.benefit_2);
            safeUpdateElement('benefit-3', data.benefits?.benefit_3);
            safeUpdateElement('benefit-4', data.benefits?.benefit_4);
            safeUpdateElement('benefit-5', data.benefits?.benefit_5);
            safeUpdateElement('benefit-6', data.benefits?.benefit_6);

            // Testimonial
            safeUpdateElement('testimonial-quote', data.testimonial?.quote);
            safeUpdateElement('testimonial-author', data.testimonial?.author);
            safeUpdateElement('testimonial-title', data.testimonial?.title);
            safeUpdateElement('testimonial-company', data.testimonial?.company);

            // Contact
            safeUpdateElement('contact-title', data.ui?.contact_title);
            safeUpdateElement('contact-subtitle', data.ui?.contact_subtitle);
            safeUpdateElement('specialist-name', data.contact?.specialist_name);
            safeUpdateElement('specialist-title', data.contact?.specialist_title);
            safeUpdateElement('specialist-phone', data.contact?.specialist_phone);
            safeUpdateElement('specialist-email', data.contact?.specialist_email);
            safeUpdateElement('website', data.contact?.website);
            safeUpdateElement('contact-phone-label', data.ui?.contact_phone_label);
            safeUpdateElement('contact-email-label', data.ui?.contact_email_label);
            safeUpdateElement('contact-website-label', data.ui?.contact_website_label);

            // Cart Calculator
            safeUpdateElement('cart-calculator-title', data.ui?.cart_calculator_title);
            safeUpdateElement('cart-calculator-subtitle', data.ui?.cart_calculator_subtitle);
            safeUpdateElement('cart-count-label', data.ui?.cart_count_label);
            safeUpdateElement('cart-unit-suffix', data.ui?.cart_unit_suffix);

            // Initialize cart calculation
            updateCartCalculation();
            updateFloatingCalculator();

            // Contenu mis à jour
        }

        // Afficher les détails de prix dans une modal
        function showPricingDetails(contractType) {
            const modal = document.getElementById('pricingModal');
            const modalTitle = document.getElementById('modal-title');
            const modalContent = document.getElementById('modal-content');

            if (contractType === '10') {
                modalTitle.textContent = data.pricing?.contract_10_title || 'Contrat 10 ans';
                modalContent.innerHTML = `
                    <h3>Détails du Contrat 10 ans</h3>
                    <p><strong>Tarif mensuel :</strong> 97,64 $ par voiturette</p>
                    <p><strong>Économies vs batteries plomb :</strong> Importantes sur 10 ans</p>
                    <br>
                    <h4>Ce qui est inclus :</h4>
                    <ul>
                        <li>Kits lithium LiFePO₄ 48V 105Ah complets</li>
                        <li>Installation professionnelle sur site</li>
                        <li>Monitoring proactif 24/7</li>
                        <li>Maintenance préventive et corrective</li>
                        <li>Remplacement immédiat en cas de défaillance</li>
                        <li>Support technique prioritaire</li>
                    </ul>
                `;
            } else if (contractType === '20') {
                modalTitle.textContent = data.pricing?.contract_20_title || 'Contrat 20 ans';
                modalContent.innerHTML = `
                    <h3>Détails du Contrat 20 ans - RECOMMANDÉ</h3>
                    <p><strong>Tarif mensuel :</strong> 84,36 $ par voiturette</p>
                    <p><strong>Économies MASSIVES :</strong> Très importantes sur 20 ans</p>
                    <br>
                    <h4>Avantages exclusifs du contrat 20 ans :</h4>
                    <ul>
                        <li><strong>Réduction significative</strong> pour engagement long terme</li>
                        <li>Stabilité tarifaire garantie sur 2 décennies</li>
                        <li>Partenariat à long terme avec support prioritaire</li>
                        <li>Amortissement optimal de l'investissement</li>
                    </ul>
                    <br>
                    <div style="background: linear-gradient(135deg, #059669, #10b981); color: white; padding: 20px; border-radius: 10px; text-align: center;">
                        <h4>💰 ROI Exceptionnel vs batteries plomb</h4>
                        <p>Économies substantielles garanties !</p>
                    </div>
                `;
            } else if (contractType === 'fleet') {
                modalTitle.textContent = data.pricing?.contract_20_fleet_title || 'Contrat Flotte 20 ans';
                modalContent.innerHTML = `
                    <h3>Détails du Contrat Flotte 20 ans - MEILLEUR PRIX</h3>
                    <p><strong>Tarif mensuel :</strong> 76,73 $ par voiturette (minimum 30)</p>
                    <p><strong>Économies PREMIUM :</strong> Maximales pour grandes flottes</p>
                    <br>
                    <h4>Avantages exclusifs de l'offre flotte :</h4>
                    <ul>
                        <li><strong>🏆 MEILLEUR PRIX</strong> pour flottes 30+ voiturettes</li>
                        <li><strong>Réduction premium</strong> de 9% vs contrat standard</li>
                        <li>Support dédié avec gestionnaire de compte</li>
                        <li>Priorité absolue pour interventions</li>
                        <li>Formation personnalisée de votre équipe</li>
                        <li>Rapport de performance mensuel</li>
                    </ul>
                    <br>
                    <div style="background: linear-gradient(135deg, #7c3aed, #a855f7); color: white; padding: 20px; border-radius: 10px; text-align: center;">
                        <h4>🚀 ROI PREMIUM : Économies maximales</h4>
                        <p>L'offre la plus avantageuse pour les grandes flottes !</p>
                    </div>
                `;
            }

            modal.style.display = 'block';
        }

        // Fermer la modal
        function closeModal() {
            document.getElementById('pricingModal').style.display = 'none';
        }

        // Fermer la modal en cliquant en dehors
        window.onclick = function(event) {
            const modal = document.getElementById('pricingModal');
            if (event.target === modal) {
                modal.style.display = 'none';
            }
        }

        // Variables globales pour le calculateur
        let currentCartCount = 10;

        // Fonction pour formater les nombres avec espaces comme séparateurs de milliers
        function formatNumber(num) {
            return Math.round(num).toString().replace(/\B(?=(\d{3})+(?!\d))/g, ' ');
        }

        // Fonction pour mettre à jour les calculs basés sur le nombre de voiturettes
        function updateCartCalculation() {
            if (!data.pricing || !data.problem || !data.comparison) return;

            const currency = ' $';

            // SECTION PROBLÈMES - Coûts explosifs réels du plomb (selon document de proposition)
            const costReplacement = parseFloat(data.problem.cost_replacement_unit) * currentCartCount; // 2000$ par voiturette
            const maintenanceHours = parseFloat(data.problem.maintenance_hours_unit) * currentCartCount; // 120h/an
            const maintenanceCost = parseFloat(data.problem.maintenance_cost_unit) * currentCartCount; // 360$/an par voiturette
            const maintenance10Years = parseFloat(data.problem.maintenance_10_years_unit) * currentCartCount; // 3600$/10ans

            // Utilisation du coût réel total selon le document (141,400$ pour 10 voiturettes sur 10 ans)
            const totalRealCost10YearsPerUnit = parseFloat(data.problem.total_real_cost_10y_unit) || 14140; // 14,140$ par voiturette
            const cost10YearsReal = totalRealCost10YearsPerUnit * currentCartCount;

            safeUpdateElement('cost-replacement', formatNumber(costReplacement) + currency + ' (par voiturette)');
            safeUpdateElement('cost-10-years', formatNumber(cost10YearsReal) + currency + ' (coût total réel)');
            safeUpdateElement('maintenance-hours', maintenanceHours + ' heures/an');
            safeUpdateElement('maintenance-cost', formatNumber(maintenanceCost) + currency + ' (par voiturette/an)');

            // SECTION TARIFICATION - Calculs dynamiques
            const monthly10 = parseFloat(data.pricing.contract_10_monthly_unit) * currentCartCount;
            const savings10 = parseFloat(data.pricing.savings_10_years_unit) * currentCartCount;

            const monthly20 = parseFloat(data.pricing.contract_20_monthly_unit) * currentCartCount;
            const savings20 = parseFloat(data.pricing.savings_20_years_unit) * currentCartCount;

            // Calcul pour l'offre flotte (même prix que 20 ans mais avantages premium pour 30+)
            const monthlyFleet = parseFloat(data.pricing.contract_20_fleet_monthly_unit) * currentCartCount;
            const savingsFleet = parseFloat(data.pricing.contract_20_fleet_savings_unit) * currentCartCount;

            safeUpdateElement('contract-10-monthly', formatNumber(monthly10) + currency);
            safeUpdateElement('savings-10-years', formatNumber(savings10) + currency);
            safeUpdateElement('contract-20-monthly', formatNumber(monthly20) + currency);
            safeUpdateElement('savings-20-years', formatNumber(savings20) + currency);
            safeUpdateElement('contract-20-fleet-monthly', formatNumber(monthlyFleet) + currency);
            safeUpdateElement('savings-20-fleet', formatNumber(savingsFleet) + currency);

            // Gestion de l'affichage de l'offre flotte (30+ voiturettes)
            const fleetCard = document.querySelector('.pricing-card.fleet');
            const premiumCard = document.querySelector('.pricing-card.premium');
            const fleetMinimumElement = document.getElementById('fleet-minimum-text');

            if (currentCartCount >= 30) {
                // Activer l'offre flotte
                if (fleetCard) {
                    fleetCard.style.opacity = '1';
                    fleetCard.style.transform = 'scale(1)';
                }

                // Désactiver l'offre 20 ans (solution optimisée)
                if (premiumCard) {
                    premiumCard.style.opacity = '0.6';
                    premiumCard.style.transform = 'scale(0.95)';
                    premiumCard.style.filter = 'grayscale(0.3)';
                }

                if (fleetMinimumElement) {
                    fleetMinimumElement.style.color = '#10b981';
                    fleetMinimumElement.style.background = 'rgba(16, 185, 129, 0.2)';
                    fleetMinimumElement.style.padding = '5px 10px';
                    fleetMinimumElement.style.borderRadius = '8px';
                    fleetMinimumElement.innerHTML = '✅ Offre flotte activée !';
                }
            } else {
                // Désactiver l'offre flotte
                if (fleetCard) {
                    fleetCard.style.opacity = '0.7';
                    fleetCard.style.transform = 'scale(0.95)';
                }

                // Réactiver l'offre 20 ans
                if (premiumCard) {
                    premiumCard.style.opacity = '1';
                    premiumCard.style.transform = 'scale(1)';
                    premiumCard.style.filter = 'none';
                }

                if (fleetMinimumElement) {
                    fleetMinimumElement.style.color = '#ffffff';
                    fleetMinimumElement.style.background = 'rgba(220, 38, 38, 0.8)';
                    fleetMinimumElement.style.padding = '5px 10px';
                    fleetMinimumElement.style.borderRadius = '8px';
                    fleetMinimumElement.innerHTML = `❌ Minimum 30 voiturettes (actuellement: ${currentCartCount})`;
                }
            }

            // SECTION COMPARAISON - Calculs dynamiques
            const leadBatteries10 = parseFloat(data.comparison.lead_batteries_10_years_unit) * currentCartCount;
            const leadBatteries20 = parseFloat(data.comparison.lead_batteries_20_years_unit) * currentCartCount;
            const lithium10 = parseFloat(data.comparison.lithium_10_years_unit) * currentCartCount;

            safeUpdateElement('lead-batteries-10-years', formatNumber(leadBatteries10) + currency);
            safeUpdateElement('contract-10-total', formatNumber(lithium10) + currency);

            // Mettre à jour les heures de maintenance dans la comparaison
            const leadMaintenanceHours = parseFloat(data.problem.maintenance_hours_unit) * currentCartCount;
            safeUpdateElement('lead-maintenance', leadMaintenanceHours + (currentLanguage === 'fr' ? ' heures/an' : ' hours/year'));

            // Mettre à jour l'affichage du nombre de voiturettes
            safeUpdateElement('cart-count', currentCartCount.toString());

            // SECTION DÉTAILS DES CALCULS
            updateCalculationDetails();

            // Calculs mis à jour
        }

        // Mettre à jour les détails des calculs (focus 20 ans - COÛTS RÉELS PLOMB)
        function updateCalculationDetails() {
            if (!data.comparison || !data.pricing || !data.problem) return;

            const currency = ' $';

            // Données de base - COÛTS RÉELS selon document de proposition (par voiturette)
            const leadReplacementCost = parseFloat(data.problem.cost_replacement_unit) || 2000; // 2000$ par voiturette par remplacement
            const leadMaintenanceCost = parseFloat(data.problem.maintenance_cost_unit) || 360; // 360$/an par voiturette
            const prematureFailureRisk = parseFloat(data.problem.premature_failure_risk) || 1200; // 12,000$ ÷ 10 = 1200$ par voiturette
            const recyclingCost = parseFloat(data.problem.recycling_disposal_cost) || 30; // 300$ ÷ 10 = 30$ par voiturette
            const revenueLossYearly = parseFloat(data.problem.revenue_loss_yearly) || 80; // 800$ ÷ 10 = 80$ par voiturette/an
            const overconsumptionYearly = parseFloat(data.problem.overconsumption_cost_yearly) || 24; // 240$ ÷ 10 = 24$ par voiturette/an
            const insuranceIncreaseYearly = parseFloat(data.problem.insurance_increase_yearly) || 50; // Estimation par voiturette/an

            const lithiumMonthly10 = parseFloat(data.pricing.contract_10_monthly_unit) || 97.64;
            const lithiumMonthly20 = parseFloat(data.pricing.contract_20_monthly_unit) || 84.36;
            const lithiumFleetMonthly = parseFloat(data.pricing.contract_20_fleet_monthly_unit) || 76.73;

            // Calculs remplacements batterie plomb (cycle 2-5 ans, moyenne 3.5 ans)
            const replacementCycle = 3.5;
            const replacements20Years = Math.ceil(20 / replacementCycle); // 6 remplacements

            // COÛTS TOTAUX RÉELS BATTERIES PLOMB sur 20 ans (par voiturette)
            const leadBatteryCost20 = leadReplacementCost * replacements20Years; // 2000$ × 6 = 12,000$ par voiturette
            const leadMaintenanceCost20 = leadMaintenanceCost * 20; // 360$ × 20 = 7,200$ par voiturette
            const leadRecyclingCost20 = recyclingCost * replacements20Years; // 30$ × 6 = 180$ par voiturette
            const leadRevenueLoss20 = revenueLossYearly * 20; // 80$ × 20 = 1,600$ par voiturette
            const leadOverconsumption20 = overconsumptionYearly * 20; // 24$ × 20 = 480$ par voiturette
            const leadInsuranceIncrease20 = insuranceIncreaseYearly * 20; // 50$ × 20 = 1,000$ par voiturette
            const leadPrematureFailure20 = prematureFailureRisk * 2; // 1200$ × 2 = 2,400$ par voiturette sur 20 ans

            // COÛT TOTAL RÉEL PLOMB par voiturette sur 20 ans
            const leadTotalPerCart20 = leadBatteryCost20 + leadMaintenanceCost20 + leadRecyclingCost20 +
                                     leadRevenueLoss20 + leadOverconsumption20 + leadInsuranceIncrease20 + leadPrematureFailure20;
            // = 12,000 + 7,200 + 180 + 1,600 + 480 + 1,000 + 2,400 = 24,860$ par voiturette sur 20 ans

            // COÛT TOTAL PLOMB pour la flotte
            const leadTotal20 = leadTotalPerCart20 * currentCartCount;

            // Coûts lithium selon la flotte sur 20 ans
            let lithium20, selectedMonthlyRate;
            if (currentCartCount >= 30) {
                selectedMonthlyRate = lithiumFleetMonthly;
                lithium20 = selectedMonthlyRate * 12 * 20 * currentCartCount;
            } else {
                lithium20 = lithiumMonthly20 * 12 * 20 * currentCartCount;
                selectedMonthlyRate = lithiumMonthly20;
            }

            // ÉCONOMIES RÉELLES sur 20 ans (plomb coûte BEAUCOUP plus cher que lithium)
            const totalSavings20 = leadTotal20 - lithium20;
            const savingsPercentage20 = ((totalSavings20 / leadTotal20) * 100).toFixed(1);

            // Fourchette intelligente (variation selon cycle 2-5 ans au lieu de 3.5)
            const minReplacements20 = Math.ceil(20 / 5); // 4 remplacements (batterie dure 5 ans)
            const maxReplacements20 = Math.ceil(20 / 2); // 10 remplacements (batterie dure 2 ans)

            const minLeadCostPerCart20 = leadReplacementCost * minReplacements20 + leadMaintenanceCost * 20 +
                                       leadRecyclingCost20 + leadRevenueLoss20 + leadOverconsumption20 + leadInsuranceIncrease20;
            const maxLeadCostPerCart20 = leadReplacementCost * maxReplacements20 + leadMaintenanceCost * 20 +
                                       leadRecyclingCost20 + leadRevenueLoss20 + leadOverconsumption20 + leadInsuranceIncrease20;

            const minSavings20 = (minLeadCostPerCart20 * currentCartCount) - lithium20;
            const maxSavings20 = (maxLeadCostPerCart20 * currentCartCount) - lithium20;

            // Calculs ROI (lithium vs coûts explosifs plomb)
            const roiPercentage = ((totalSavings20 / lithium20) * 100).toFixed(1);
            const monthlySavingsAverage = totalSavings20 / (20 * 12);
            const perCartMonthlySavings = monthlySavingsAverage / currentCartCount;
            const annualSavingsPerCart = perCartMonthlySavings * 12;

            // === 1. SECTION BATTERIES PLOMB (COÛTS RÉELS selon document) ===
            safeUpdateElement('lead-replacement-schedule', data.calculs?.lead_replacement_schedule || 'Remplacement nécessaire tous les 2-5 ans');
            safeUpdateElement('lead-replacements-20y', `${replacements20Years} remplacements à 2 000$ par voiturette`);

            // Détail complet des coûts cachés du plomb (par voiturette)
            const leadBreakdownText = currentLanguage === 'fr'
                ? `${formatNumber(leadBatteryCost20)}${currency} (batteries) + ${formatNumber(leadMaintenanceCost20)}${currency} (maintenance) + ${formatNumber(leadRecyclingCost20 + leadRevenueLoss20 + leadOverconsumption20 + leadInsuranceIncrease20 + leadPrematureFailure20)}${currency} (coûts cachés) par voiturette`
                : `${formatNumber(leadBatteryCost20)}${currency} (batteries) + ${formatNumber(leadMaintenanceCost20)}${currency} (maintenance) + ${formatNumber(leadRecyclingCost20 + leadRevenueLoss20 + leadOverconsumption20 + leadInsuranceIncrease20 + leadPrematureFailure20)}${currency} (hidden costs) per cart`;

            safeUpdateElement('lead-cost-breakdown-20y', leadBreakdownText);
            safeUpdateElement('lead-total-calc-20y', formatNumber(leadTotal20) + currency);

            const maintenanceDetailText = currentLanguage === 'fr'
                ? `${formatNumber(leadMaintenanceCost20 * currentCartCount)}${currency} (120h/an × 30$/h ÷ 10 voiturettes × 20 ans)`
                : `${formatNumber(leadMaintenanceCost20 * currentCartCount)}${currency} (120h/year × 30$/h ÷ 10 carts × 20 years)`;
            safeUpdateElement('lead-maintenance-total-20y', maintenanceDetailText);

            // === 2. SECTION LITHIUM (SOLUTION ÉCONOMIQUE) ===
            safeUpdateElement('lithium-replacements-20y',
                currentLanguage === 'fr' ? '0 remplacement nécessaire - 15-20 ans de durée de vie' : '0 replacement needed - 15-20 years lifespan');

            const lithiumBreakdownText = currentLanguage === 'fr'
                ? `${formatNumber(lithium20)}${currency} (location ${selectedMonthlyRate}${currency}/mois) + 0${currency} (maintenance) + 0${currency} (recyclage) + 0${currency} (pertes revenus)`
                : `${formatNumber(lithium20)}${currency} (rental ${selectedMonthlyRate}${currency}/month) + 0${currency} (maintenance) + 0${currency} (recycling) + 0${currency} (revenue loss)`;

            safeUpdateElement('lithium-cost-breakdown-20y', lithiumBreakdownText);
            safeUpdateElement('lithium-total-calc-20y', formatNumber(lithium20) + currency);

            // === 3. SECTION ÉCONOMIES (LITHIUM FAIT ÉCONOMISER) ===
            safeUpdateElement('detailed-savings-calc-20y',
                `${formatNumber(leadTotal20)}${currency} (plomb) - ${formatNumber(lithium20)}${currency} (lithium)`);
            safeUpdateElement('total-savings-display-20y', formatNumber(totalSavings20) + currency);

            const rangeText20 = currentLanguage === 'fr'
                ? `Entre ${formatNumber(minSavings20)}${currency} et ${formatNumber(maxSavings20)}${currency} selon fréquence remplacement plomb`
                : `Between ${formatNumber(minSavings20)}${currency} and ${formatNumber(maxSavings20)}${currency} depending on lead replacement frequency`;
            safeUpdateElement('savings-range-20y', rangeText20);

            const savingsText = currentLanguage === 'fr'
                ? `${savingsPercentage20}% d'économie avec lithium vs plomb`
                : `${savingsPercentage20}% savings with lithium vs lead`;
            safeUpdateElement('savings-percentage-20y', savingsText);

            // === 4. SECTION ROI (RETOUR SUR INVESTISSEMENT LITHIUM) ===
            const roiText = currentLanguage === 'fr'
                ? `${roiPercentage}% ROI - Lithium se paie par ses économies`
                : `${roiPercentage}% ROI - Lithium pays for itself through savings`;
            safeUpdateElement('roi-calculation', roiText);

            safeUpdateElement('break-even-point',
                currentLanguage === 'fr' ? 'Rentabilité immédiate vs coûts plomb' : 'Immediate profitability vs lead costs');
            safeUpdateElement('monthly-savings-average',
                `${formatNumber(monthlySavingsAverage)}${currency}/mois économisés`);
            safeUpdateElement('per-cart-monthly-savings',
                `${formatNumber(perCartMonthlySavings)}${currency}/voiturette/mois économisés`);

            // Mise à jour tableau comparaison (garder 10 ans pour la compatibilité)
            const leadTotal10 = (leadReplacementCost * Math.ceil(10 / replacementCycle) + leadMaintenanceCost * 10) * currentCartCount;
            const lithium10 = currentCartCount >= 30 ? lithiumFleetMonthly * 12 * 10 * currentCartCount : lithiumMonthly10 * 12 * 10 * currentCartCount;

            safeUpdateElement('lead-batteries-10-years', formatNumber(leadTotal10) + currency);
            safeUpdateElement('contract-10-total', formatNumber(lithium10) + currency);

            // Mise à jour autres données comparaison
            safeUpdateElement('lead-replacements', `${Math.ceil(10 / replacementCycle)} remplacements sur 10 ans`);
            safeUpdateElement('lithium-replacements', data.comparison.lithium_replacements || '0 remplacement');
            safeUpdateElement('lead-maintenance', data.comparison.lead_maintenance || '12 heures/an');
            safeUpdateElement('lithium-maintenance', data.comparison.lithium_maintenance || '0 heure');
            safeUpdateElement('lead-charging', data.comparison.lead_charging || '8-10 heures');
            safeUpdateElement('lithium-charging', data.comparison.lithium_charging || '2 heures');
        }

        // Event listener pour le slider
        function setupCartSlider() {
            const slider = document.getElementById('cartSlider');
            if (slider) {
                slider.addEventListener('input', function() {
                    currentCartCount = parseInt(this.value);
                    updateCartCalculation();
                    updateFloatingCalculator();
                });
            }
        }

        // Setup du calculateur flottant
        function setupFloatingCalculator() {
            const floatingSlider = document.getElementById('cartSliderFloating');
            if (floatingSlider) {
                floatingSlider.addEventListener('input', function() {
                    currentCartCount = parseInt(this.value);

                    // Synchroniser avec le slider principal
                    const mainSlider = document.getElementById('cartSlider');
                    if (mainSlider) {
                        mainSlider.value = currentCartCount;
                    }

                    updateCartCalculation();
                    updateFloatingCalculator();
                });
            }
        }

        // Mettre à jour le calculateur flottant
        function updateFloatingCalculator() {
            if (!data.pricing) return;

            const currency = ' $';

            // Calculs
            const monthly10 = parseFloat(data.pricing.contract_10_monthly_unit) * currentCartCount;
            const monthly20 = parseFloat(data.pricing.contract_20_monthly_unit) * currentCartCount;
            const monthlyFleet = parseFloat(data.pricing.contract_20_fleet_monthly_unit) * currentCartCount;

            // Mise à jour des affichages
            safeUpdateElement('cart-count-floating', currentCartCount.toString());
            safeUpdateElement('price-10-floating', formatNumber(monthly10) + currency);
            safeUpdateElement('price-20-floating', formatNumber(monthly20) + currency);
            safeUpdateElement('price-fleet-floating', formatNumber(monthlyFleet) + currency);

            // Synchroniser le slider flottant
            const floatingSlider = document.getElementById('cartSliderFloating');
            if (floatingSlider) {
                floatingSlider.value = currentCartCount;
            }

            // Gestion visuelle de l'offre flotte dans le calculateur flottant
            const fleetCard = document.getElementById('price-fleet-card');
            const premiumFloatingCard = document.querySelector('.floating-calculator .pricing-mini:nth-child(2)');

            if (fleetCard) {
                if (currentCartCount >= 30) {
                    // Activer flotte, désactiver 20 ans
                    fleetCard.classList.remove('fleet-inactive');
                    fleetCard.classList.remove('disabled');
                    fleetCard.title = 'Offre flotte activée !';

                    if (premiumFloatingCard) {
                        premiumFloatingCard.classList.add('disabled');
                        premiumFloatingCard.title = 'Offre remplacée par la flotte';
                    }
                } else {
                    // Désactiver flotte, réactiver 20 ans
                    fleetCard.classList.add('fleet-inactive');
                    fleetCard.classList.remove('disabled');
                    fleetCard.title = `Minimum 30 voiturettes (actuellement: ${currentCartCount})`;

                    if (premiumFloatingCard) {
                        premiumFloatingCard.classList.remove('disabled');
                        premiumFloatingCard.title = 'Contrat 20 ans - Solution optimisée';
                    }
                }
            }

            // Mettre à jour les textes selon la langue
            if (data.ui) {
                safeUpdateElement('cart-unit-floating', currentCartCount > 1 ?
                    (currentLanguage === 'fr' ? 'voiturettes' : 'carts') :
                    (currentLanguage === 'fr' ? 'voiturette' : 'cart'));

                safeUpdateElement('floating-calc-title', data.ui.cart_calculator_title || 'Calculateur de Flotte');
            }
        }

        // Système de lecteur audio
        class AudioPlayer {
            constructor() {
                this.musicFolder = 'musique/';
                this.tracks = [];
                this.currentTrackIndex = 0;
                this.currentAudio = null;
                this.nextAudio = null;
                this.isPlaying = false;
                this.userInteracted = false;
                this.volume = 0.15; // 15% par défaut

                this.playBtn = document.getElementById('playPauseBtn');
                this.playIcon = document.getElementById('playIcon');
                this.pauseIcon = document.getElementById('pauseIcon');
                this.volumeSlider = document.getElementById('volumeSlider');
                this.trackInfo = document.getElementById('trackInfo');

                this.init();
            }

            async init() {
                // Charger la liste des musiques de façon non-bloquante
                setTimeout(() => this.loadTrackList(), 100);

                // Setup des contrôles
                this.setupControls();

                // Écouter les interactions utilisateur pour démarrer la musique
                this.setupUserInteractionListener();
            }

            async loadTrackList() {
                try {
                    this.tracks = await this.scanMusicFolder();

                    if (this.tracks.length > 0) {
                        this.shuffleTracks();
                        setTimeout(() => {
                            this.updateTrackInfo();
                        }, 100);
                    } else {
                        setTimeout(() => {
                            if (this.trackInfo) {
                                this.trackInfo.textContent = '♪';
                            }
                        }, 100);
                    }
                } catch (error) {
                    if (this.trackInfo) {
                        this.trackInfo.textContent = '♪';
                    }
                }
            }

            async scanMusicFolder() {
                try {
                    // Charger l'index JSON avec les vrais fichiers
                    const indexResponse = await fetch(this.musicFolder + 'index.json');
                    if (indexResponse.ok) {
                        const indexData = await indexResponse.json();
                        if (indexData.files && indexData.files.length > 0) {
                            return indexData.files;
                        }
                    }

                    // Scanner le listing HTML du serveur
                    const response = await fetch(this.musicFolder);
                    const html = await response.text();

                    // Parser le HTML pour extraire les liens vers les fichiers .mp3
                    const parser = new DOMParser();
                    const doc = parser.parseFromString(html, 'text/html');
                    const links = Array.from(doc.querySelectorAll('a[href]'));

                    const mp3Files = links
                        .map(link => link.getAttribute('href'))
                        .filter(href => href && href.toLowerCase().endsWith('.mp3'))
                        .map(href => {
                            // Nettoyer le nom du fichier
                            const decoded = decodeURIComponent(href);
                            return decoded.split('/').pop();
                        })
                        .filter(filename => !filename.includes('..') && filename !== '' && filename.endsWith('.mp3'))
                        .sort(); // Trier alphabétiquement

                    return mp3Files;

                } catch (error) {
                    return []; // Retourner tableau vide si aucune méthode ne fonctionne
                }
            }


            shuffleTracks() {
                for (let i = this.tracks.length - 1; i > 0; i--) {
                    const j = Math.floor(Math.random() * (i + 1));
                    [this.tracks[i], this.tracks[j]] = [this.tracks[j], this.tracks[i]];
                }
                this.currentTrackIndex = 0;
            }

            setupUserInteractionListener() {
                const startMusic = () => {
                    if (!this.userInteracted && this.tracks.length > 0) {
                        this.userInteracted = true;
                        this.preloadCurrentAndNext();
                        this.startPlayback();

                        document.removeEventListener('click', startMusic, true);
                        document.removeEventListener('keydown', startMusic, true);
                        document.removeEventListener('touchstart', startMusic, true);
                    }
                };

                document.addEventListener('click', startMusic, true);
                document.addEventListener('keydown', startMusic, true);
                document.addEventListener('touchstart', startMusic, true);
            }

            setupControls() {
                this.playBtn.addEventListener('click', () => this.togglePlayPause());

                this.volumeSlider.addEventListener('input', (e) => {
                    this.volume = e.target.value / 100;
                    if (this.currentAudio) {
                        this.currentAudio.volume = this.volume;
                    }
                });
            }

            preloadCurrentAndNext() {
                if (this.tracks.length === 0) return;

                // Nettoyer les objets audio existants
                this.cleanupAudio();

                // Précharger la musique actuelle
                this.loadTrack(this.currentTrackIndex, true);

                // Précharger la suivante seulement s'il y a plus d'une piste
                if (this.tracks.length > 1) {
                    const nextIndex = (this.currentTrackIndex + 1) % this.tracks.length;
                    setTimeout(() => this.loadTrack(nextIndex, false), 500);
                }
            }

            cleanupAudio() {
                // Nettoyer l'audio actuel
                if (this.currentAudio) {
                    this.currentAudio.pause();
                    this.currentAudio.src = '';
                    this.currentAudio.load();
                    this.currentAudio = null;
                }

                // Nettoyer l'audio suivant
                if (this.nextAudio) {
                    this.nextAudio.src = '';
                    this.nextAudio.load();
                    this.nextAudio = null;
                }
            }

            loadTrack(index, isCurrent = true) {
                if (!this.tracks[index]) return null;

                const audio = new Audio();
                audio.src = this.musicFolder + this.tracks[index];
                audio.volume = this.volume;
                audio.preload = isCurrent ? 'auto' : 'metadata';

                if (isCurrent) {
                    this.currentAudio = audio;
                    this.setupCurrentTrackEvents();
                } else {
                    this.nextAudio = audio;
                }

                return audio;
            }

            setupCurrentTrackEvents() {
                if (!this.currentAudio) return;

                this.currentAudio.addEventListener('ended', () => {
                    this.nextTrack();
                });

                this.currentAudio.addEventListener('error', () => {
                    // Erreur de chargement, passer au suivant
                    this.nextTrack();
                });

                this.updateTrackInfo();
            }

            async startPlayback() {
                if (!this.currentAudio || this.isPlaying) return;

                try {
                    await this.currentAudio.play();
                    this.isPlaying = true;
                    this.updatePlayButton();
                } catch (error) {
                    // Échec silencieux
                }
            }

            async togglePlayPause() {
                if (!this.userInteracted) {
                    this.userInteracted = true;
                    this.preloadCurrentAndNext();
                }

                if (!this.currentAudio) return;

                if (this.isPlaying) {
                    this.currentAudio.pause();
                    this.isPlaying = false;
                } else {
                    try {
                        await this.currentAudio.play();
                        this.isPlaying = true;
                    } catch (error) {
                        // Échec silencieux
                    }
                }

                this.updatePlayButton();
            }

            nextTrack() {
                // Passer à la musique suivante
                this.currentAudio = this.nextAudio;
                this.currentTrackIndex = (this.currentTrackIndex + 1) % this.tracks.length;

                // Mettre à jour l'affichage
                this.updateTrackInfo();

                // Précharger la nouvelle musique suivante
                const nextIndex = (this.currentTrackIndex + 1) % this.tracks.length;
                this.nextAudio = this.loadTrack(nextIndex, false);

                this.setupCurrentTrackEvents();

                if (this.isPlaying && this.currentAudio) {
                    this.currentAudio.play().catch(() => {});
                }
            }

            updatePlayButton() {
                if (this.isPlaying) {
                    this.playIcon.style.display = 'none';
                    this.pauseIcon.style.display = 'inline';
                } else {
                    this.playIcon.style.display = 'inline';
                    this.pauseIcon.style.display = 'none';
                }
            }

            updateTrackInfo() {
                // Toujours afficher juste le symbole musical
                if (!this.trackInfo) {
                    this.trackInfo = document.getElementById('trackInfo');
                }

                if (this.trackInfo) {
                    this.trackInfo.textContent = '♪';
                    this.trackInfo.title = 'Lecteur audio';
                }
            }
        }

        // Initialiser le lecteur audio
        let audioPlayer;

        // Chargement automatique des données CSV au démarrage de la page
        document.addEventListener('DOMContentLoaded', function() {
            // Page chargée, initialisation du chargement CSV
            loadDataFromCSV();

            // Setup des sliders après un petit délai pour s'assurer que le DOM est prêt
            setTimeout(() => {
                setupCartSlider();
                setupFloatingCalculator();
                updateFloatingCalculator();
            }, 100);

            // Initialiser le lecteur audio
            audioPlayer = new AudioPlayer();
        });
    </script>
</body>
</html>