<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üé® √âditeur de Widgets Avanc√© - Li-CUBE PRO‚Ñ¢</title>
    
    <style>
        /* Variables CSS Li-CUBE PRO‚Ñ¢ */
        :root {
            --primary-dark: #0F172A;
            --secondary-dark: #1E293B;
            --accent-green: #10B981;
            --accent-blue: #3B82F6;
            --success-green: #059669;
            --warning-orange: #F59E0B;
            --danger-red: #EF4444;
            --text-white: #FFFFFF;
            --text-gray: #94A3B8;
            --text-muted: #64748B;
            --border-color: #334155;
            --bg-primary: #0F172A;
            --bg-secondary: #1E293B;
            --bg-tertiary: #334155;
            --spacing-xs: 0.25rem;
            --spacing-sm: 0.5rem;
            --spacing-md: 1rem;
            --spacing-lg: 1.5rem;
            --spacing-xl: 2rem;
            --border-radius: 8px;
            --border-radius-sm: 4px;
            --font-system: system-ui, -apple-system, 'Segoe UI', sans-serif;
            --font-bold: 700;
            --font-medium: 500;
            --text-xs: 0.75rem;
            --text-sm: 0.875rem;
            --text-lg: 1.125rem;
            --text-xl: 1.25rem;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: var(--font-system);
            background: var(--bg-primary);
            color: var(--text-white);
            overflow: hidden;
        }

        /* Layout Principal */
        .editor-layout {
            display: grid;
            grid-template-areas: 
                "toolbar toolbar toolbar"
                "sidebar canvas properties"
                "footer footer footer";
            grid-template-columns: 300px 1fr 400px;
            grid-template-rows: 60px 1fr 30px;
            height: 100vh;
        }

        /* Toolbar */
        .editor-toolbar {
            grid-area: toolbar;
            background: var(--bg-secondary);
            border-bottom: 1px solid var(--border-color);
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0 var(--spacing-lg);
        }

        .toolbar-left {
            display: flex;
            align-items: center;
            gap: var(--spacing-lg);
        }

        .toolbar-title {
            font-size: var(--text-xl);
            font-weight: var(--font-bold);
            color: var(--accent-green);
        }

        .toolbar-actions {
            display: flex;
            align-items: center;
            gap: var(--spacing-sm);
        }

        .toolbar-btn {
            padding: var(--spacing-xs) var(--spacing-sm);
            background: var(--bg-tertiary);
            border: 1px solid var(--border-color);
            border-radius: var(--border-radius-sm);
            color: var(--text-white);
            cursor: pointer;
            font-size: var(--text-xs);
            transition: all 0.3s ease;
        }

        .toolbar-btn:hover {
            background: var(--accent-green);
            border-color: var(--accent-green);
        }

        /* Sidebar - Widgets disponibles */
        .editor-sidebar {
            grid-area: sidebar;
            background: var(--bg-secondary);
            border-right: 1px solid var(--border-color);
            display: flex;
            flex-direction: column;
        }

        .sidebar-header {
            padding: var(--spacing-md);
            border-bottom: 1px solid var(--border-color);
            font-weight: var(--font-bold);
            color: var(--accent-green);
        }

        .widget-list {
            flex: 1;
            overflow-y: auto;
            padding: var(--spacing-sm);
        }

        .widget-item {
            display: flex;
            align-items: center;
            gap: var(--spacing-sm);
            padding: var(--spacing-sm);
            background: var(--bg-tertiary);
            border-radius: var(--border-radius-sm);
            margin-bottom: var(--spacing-xs);
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .widget-item:hover {
            background: var(--accent-green);
            transform: translateX(2px);
        }

        .widget-icon {
            font-size: var(--text-lg);
        }

        .widget-info {
            flex: 1;
        }

        .widget-name {
            font-weight: var(--font-medium);
            margin-bottom: 2px;
        }

        .widget-desc {
            font-size: var(--text-xs);
            color: var(--text-muted);
        }

        /* Canvas - Zone de pr√©visualisation */
        .editor-canvas {
            grid-area: canvas;
            background: var(--bg-primary);
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }

        .canvas-toolbar {
            display: flex;
            align-items: center;
            justify-content: center;
            padding: var(--spacing-sm);
            background: var(--bg-secondary);
            border-bottom: 1px solid var(--border-color);
            gap: var(--spacing-sm);
        }

        .canvas-content {
            flex: 1;
            padding: var(--spacing-xl);
            display: flex;
            justify-content: center;
            align-items: flex-start;
            overflow-y: auto;
            background: linear-gradient(45deg, #1a1a1a 25%, transparent 25%), 
                        linear-gradient(-45deg, #1a1a1a 25%, transparent 25%), 
                        linear-gradient(45deg, transparent 75%, #1a1a1a 75%), 
                        linear-gradient(-45deg, transparent 75%, #1a1a1a 75%);
            background-size: 20px 20px;
            background-position: 0 0, 0 10px, 10px -10px, -10px 0px;
        }

        .widget-preview {
            background: white;
            border-radius: var(--border-radius);
            min-width: 400px;
            min-height: 300px;
            padding: var(--spacing-lg);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.2);
            position: relative;
        }

        .widget-preview.empty {
            border: 2px dashed var(--border-color);
            display: flex;
            align-items: center;
            justify-content: center;
            flex-direction: column;
            color: var(--text-muted);
        }

        /* Properties Panel */
        .editor-properties {
            grid-area: properties;
            background: var(--bg-secondary);
            border-left: 1px solid var(--border-color);
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }

        .properties-header {
            padding: var(--spacing-md);
            border-bottom: 1px solid var(--border-color);
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .properties-title {
            font-weight: var(--font-bold);
            color: var(--accent-green);
        }

        .properties-content {
            flex: 1;
            overflow-y: auto;
        }

        /* Syst√®me d'onglets */
        .tabs-container {
            margin-bottom: var(--spacing-md);
        }

        .tabs-header {
            display: flex;
            background: var(--bg-tertiary);
            border-radius: var(--border-radius) var(--border-radius) 0 0;
        }

        .tab-button {
            flex: 1;
            padding: var(--spacing-sm);
            background: transparent;
            color: var(--text-muted);
            border: none;
            cursor: pointer;
            font-size: var(--text-xs);
            font-weight: var(--font-medium);
            transition: all 0.3s ease;
        }

        .tab-button.active {
            background: var(--accent-green);
            color: white;
        }

        .tab-content {
            background: var(--bg-tertiary);
            border-radius: 0 0 var(--border-radius) var(--border-radius);
            padding: var(--spacing-md);
            min-height: 300px;
        }

        .tab-pane {
            display: none;
        }

        .tab-pane.active {
            display: block;
        }

        /* Grille de propri√©t√©s moderne */
        .properties-grid {
            display: grid;
            grid-template-columns: 1fr;
            gap: var(--spacing-md);
        }

        .property-section {
            background: rgba(30, 41, 59, 0.3);
            border: 1px solid var(--border-color);
            border-radius: var(--border-radius);
            padding: var(--spacing-md);
        }

        .property-section-title {
            color: var(--accent-green);
            font-weight: var(--font-bold);
            font-size: var(--text-sm);
            margin-bottom: var(--spacing-sm);
            padding-bottom: var(--spacing-xs);
            border-bottom: 1px solid rgba(16, 185, 129, 0.2);
        }

        .property-group {
            margin-bottom: var(--spacing-sm);
        }

        .property-label {
            display: block;
            font-size: var(--text-xs);
            color: var(--text-gray);
            margin-bottom: var(--spacing-xs);
        }

        .property-input {
            width: 100%;
            padding: var(--spacing-xs);
            background: var(--bg-primary);
            border: 1px solid var(--border-color);
            border-radius: var(--border-radius-sm);
            color: var(--text-white);
            font-size: var(--text-xs);
            transition: border-color 0.3s ease;
        }

        .property-input:focus {
            outline: none;
            border-color: var(--accent-green);
        }

        /* Interface CRUD pour √©l√©ments */
        .elements-manager {
            margin-top: var(--spacing-md);
        }

        .elements-list {
            display: flex;
            flex-direction: column;
            gap: var(--spacing-xs);
        }

        .element-item {
            display: flex;
            align-items: center;
            gap: var(--spacing-xs);
            padding: var(--spacing-xs);
            background: var(--bg-primary);
            border: 1px solid var(--border-color);
            border-radius: var(--border-radius-sm);
            cursor: grab;
        }

        .element-item:hover {
            border-color: var(--accent-green);
        }

        .element-item.dragging {
            opacity: 0.5;
            cursor: grabbing;
        }

        .element-handle {
            color: var(--text-muted);
            cursor: grab;
        }

        .element-content {
            flex: 1;
            display: flex;
            align-items: center;
            gap: var(--spacing-xs);
        }

        .element-icon {
            font-size: var(--text-sm);
        }

        .element-text {
            font-size: var(--text-xs);
            color: var(--text-white);
        }

        .element-actions {
            display: flex;
            gap: var(--spacing-xs);
        }

        .element-action {
            padding: 2px 4px;
            background: transparent;
            border: none;
            border-radius: var(--border-radius-sm);
            color: var(--text-muted);
            cursor: pointer;
            font-size: 10px;
            transition: all 0.3s ease;
        }

        .element-action:hover {
            background: var(--accent-green);
            color: white;
        }

        .element-action.danger:hover {
            background: var(--danger-red);
        }

        .add-element-btn {
            width: 100%;
            padding: var(--spacing-sm);
            background: var(--accent-green);
            border: none;
            border-radius: var(--border-radius-sm);
            color: white;
            cursor: pointer;
            font-size: var(--text-xs);
            margin-top: var(--spacing-sm);
            transition: all 0.3s ease;
        }

        .add-element-btn:hover {
            background: var(--success-green);
            transform: translateY(-1px);
        }

        /* Footer */
        .editor-footer {
            grid-area: footer;
            background: var(--bg-secondary);
            border-top: 1px solid var(--border-color);
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0 var(--spacing-md);
            font-size: var(--text-xs);
            color: var(--text-muted);
        }

        /* Range inputs avec affichage valeur */
        .range-group {
            display: grid;
            grid-template-columns: 1fr 50px;
            gap: var(--spacing-xs);
            align-items: center;
        }

        .range-value {
            background: var(--accent-green);
            color: white;
            padding: var(--spacing-xs);
            border-radius: var(--border-radius-sm);
            text-align: center;
            font-size: var(--text-xs);
            font-weight: var(--font-medium);
        }

        /* States et animations */
        .pulse {
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0% { opacity: 1; }
            50% { opacity: 0.5; }
            100% { opacity: 1; }
        }
    </style>
</head>
<body>
    <div class="editor-layout">
        <!-- Toolbar -->
        <div class="editor-toolbar">
            <div class="toolbar-left">
                <div class="toolbar-title">üé® √âditeur de Widgets Avanc√©</div>
                <div class="toolbar-actions">
                    <button class="toolbar-btn" onclick="editor.newProject()">üìÑ Nouveau</button>
                    <button class="toolbar-btn" onclick="editor.saveProject()">üíæ Sauvegarder</button>
                    <button class="toolbar-btn" onclick="editor.exportWidget()">üì§ Exporter</button>
                </div>
            </div>
            <div class="toolbar-right">
                <button class="toolbar-btn" onclick="editor.undo()">‚Ü∂ Annuler</button>
                <button class="toolbar-btn" onclick="editor.redo()">‚Ü∑ Refaire</button>
                <button class="toolbar-btn" onclick="editor.preview()">üëÅ Aper√ßu</button>
            </div>
        </div>

        <!-- Sidebar - Widgets disponibles -->
        <div class="editor-sidebar">
            <div class="sidebar-header">üì¶ Widgets Disponibles</div>
            <div class="widget-list">
                <div class="widget-item" onclick="editor.selectWidget('logo')">
                    <div class="widget-icon">üè¢</div>
                    <div class="widget-info">
                        <div class="widget-name">Logo Widget</div>
                        <div class="widget-desc">Logo avec image et effets</div>
                    </div>
                </div>
                <div class="widget-item" onclick="editor.selectWidget('hero-title')">
                    <div class="widget-icon">üéØ</div>
                    <div class="widget-info">
                        <div class="widget-name">Hero Title</div>
                        <div class="widget-desc">Titre principal avec sous-titre</div>
                    </div>
                </div>
                <div class="widget-item" onclick="editor.selectWidget('pricing-card')">
                    <div class="widget-icon">üí∞</div>
                    <div class="widget-info">
                        <div class="widget-name">Pricing Card</div>
                        <div class="widget-desc">Carte de tarification</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Canvas -->
        <div class="editor-canvas">
            <div class="canvas-toolbar">
                <button class="toolbar-btn" onclick="editor.zoomOut()">üîç-</button>
                <span id="zoomLevel">100%</span>
                <button class="toolbar-btn" onclick="editor.zoomIn()">üîç+</button>
                <button class="toolbar-btn" onclick="editor.resetZoom()">üéØ Reset</button>
            </div>
            <div class="canvas-content">
                <div class="widget-preview empty" id="widgetPreview">
                    <div>
                        <div style="font-size: 3rem; opacity: 0.3; margin-bottom: 1rem;">üé®</div>
                        <div>S√©lectionnez un widget pour commencer l'√©dition</div>
                        <div style="font-size: 0.875rem; color: #666; margin-top: 0.5rem;">
                            Choisissez un widget dans le panneau de gauche
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Properties Panel -->
        <div class="editor-properties">
            <div class="properties-header">
                <div class="properties-title">‚öôÔ∏è Propri√©t√©s</div>
                <div class="properties-title" id="currentWidgetName">Aucun widget</div>
            </div>
            <div class="properties-content" id="propertiesContent">
                <div style="text-align: center; padding: 2rem; color: var(--text-muted);">
                    <div style="font-size: 2rem; margin-bottom: 1rem; opacity: 0.5;">‚öôÔ∏è</div>
                    <div>S√©lectionnez un widget pour voir ses propri√©t√©s</div>
                </div>
            </div>
        </div>

        <!-- Footer -->
        <div class="editor-footer">
            <div>Li-CUBE PRO‚Ñ¢ - √âditeur de Widgets Avanc√© v2.0</div>
            <div id="statusBar">Pr√™t</div>
        </div>
    </div>

    <script>
        // √âditeur de Widgets Avanc√© - Li-CUBE PRO‚Ñ¢
        class AdvancedWidgetEditor {
            constructor() {
                this.currentWidget = null;
                this.currentWidgetType = null;
                this.zoomLevel = 100;
                this.history = [];
                this.historyIndex = -1;
                this.widgetData = {};
                this.widgetElements = {};
                
                this.initializeEditor();
            }

            initializeEditor() {
                this.setupWidgetDefinitions();
                this.updateStatus('√âditeur initialis√© et pr√™t');
            }

            // D√©finitions des widgets avec syst√®me CRUD √©tendu
            setupWidgetDefinitions() {
                this.widgetDefinitions = {
                    'logo': {
                        name: 'Logo Widget',
                        icon: 'üè¢',
                        elements: {
                            logo: {
                                type: 'logo',
                                name: 'Logo Principal',
                                icon: 'üè¢',
                                selector: '.nav-logo',
                                allowMultiple: false,
                                properties: [
                                    { name: 'imagePath', type: 'text', label: 'Chemin Image', defaultValue: './assets/images/logo.png', category: 'Image' },
                                    { name: 'altText', type: 'text', label: 'Texte alternatif', defaultValue: 'Logo', category: 'Image' },
                                    { name: 'width', type: 'range', label: 'Largeur (px)', defaultValue: 80, min: 20, max: 200, category: 'Dimensions' },
                                    { name: 'height', type: 'range', label: 'Hauteur (px)', defaultValue: 80, min: 20, max: 200, category: 'Dimensions' },
                                    { name: 'borderColor', type: 'color', label: 'Couleur bordure', defaultValue: '#10B981', category: 'Style' },
                                    { name: 'backgroundColor', type: 'color', label: 'Couleur fond', defaultValue: '#1E293B', category: 'Style' },
                                    { name: 'borderRadius', type: 'range', label: 'Arrondi (px)', defaultValue: 12, min: 0, max: 50, category: 'Style' }
                                ]
                            }
                        }
                    },
                    'hero-title': {
                        name: 'Hero Title Widget',
                        icon: 'üéØ',
                        elements: {
                            title: {
                                type: 'title',
                                name: 'Titre Principal',
                                icon: 'üìù',
                                selector: '.hero-title',
                                allowMultiple: true,
                                properties: [
                                    { name: 'text', type: 'text', label: 'Texte', defaultValue: 'Titre Principal', category: 'Contenu' },
                                    { name: 'fontSize', type: 'range', label: 'Taille (px)', defaultValue: 32, min: 16, max: 72, category: 'Typographie' },
                                    { name: 'color', type: 'color', label: 'Couleur', defaultValue: '#FFFFFF', category: 'Couleurs' },
                                    { name: 'fontWeight', type: 'select', label: 'Poids', defaultValue: '700', options: [
                                        { value: '400', label: 'Normal' },
                                        { value: '500', label: 'Medium' },
                                        { value: '600', label: 'Semi-bold' },
                                        { value: '700', label: 'Bold' },
                                        { value: '900', label: 'Black' }
                                    ], category: 'Typographie' },
                                    { name: 'textAlign', type: 'select', label: 'Alignement', defaultValue: 'center', options: [
                                        { value: 'left', label: 'Gauche' },
                                        { value: 'center', label: 'Centr√©' },
                                        { value: 'right', label: 'Droite' }
                                    ], category: 'Alignement' }
                                ]
                            },
                            subtitle: {
                                type: 'subtitle',
                                name: 'Sous-titre',
                                icon: 'üìÑ',
                                selector: '.hero-subtitle',
                                allowMultiple: true,
                                properties: [
                                    { name: 'text', type: 'textarea', label: 'Texte', defaultValue: 'Sous-titre descriptif', category: 'Contenu' },
                                    { name: 'fontSize', type: 'range', label: 'Taille (px)', defaultValue: 18, min: 12, max: 36, category: 'Typographie' },
                                    { name: 'color', type: 'color', label: 'Couleur', defaultValue: '#94A3B8', category: 'Couleurs' },
                                    { name: 'textAlign', type: 'select', label: 'Alignement', defaultValue: 'center', options: [
                                        { value: 'left', label: 'Gauche' },
                                        { value: 'center', label: 'Centr√©' },
                                        { value: 'right', label: 'Droite' }
                                    ], category: 'Alignement' }
                                ]
                            }
                        }
                    },
                    'pricing-card': {
                        name: 'Pricing Card Widget',
                        icon: 'üí∞',
                        elements: {
                            badge: {
                                type: 'badge',
                                name: 'Badge',
                                icon: 'üè∑Ô∏è',
                                selector: '.pricing-badge',
                                allowMultiple: false,
                                properties: [
                                    { name: 'text', type: 'text', label: 'Texte', defaultValue: 'POPULAIRE', category: 'Contenu' },
                                    { name: 'backgroundColor', type: 'color', label: 'Couleur fond', defaultValue: '#10B981', category: 'Style' },
                                    { name: 'textColor', type: 'color', label: 'Couleur texte', defaultValue: '#FFFFFF', category: 'Style' }
                                ]
                            },
                            planName: {
                                type: 'plan-name',
                                name: 'Nom du Plan',
                                icon: 'üéØ',
                                selector: 'h3',
                                allowMultiple: false,
                                properties: [
                                    { name: 'text', type: 'text', label: 'Nom', defaultValue: 'PROFESSIONNEL', category: 'Contenu' },
                                    { name: 'fontSize', type: 'range', label: 'Taille (px)', defaultValue: 24, min: 16, max: 36, category: 'Typographie' },
                                    { name: 'color', type: 'color', label: 'Couleur', defaultValue: '#10B981', category: 'Couleurs' },
                                    { name: 'textAlign', type: 'select', label: 'Alignement', defaultValue: 'center', options: [
                                        { value: 'left', label: 'Gauche' },
                                        { value: 'center', label: 'Centr√©' },
                                        { value: 'right', label: 'Droite' }
                                    ], category: 'Alignement' }
                                ]
                            },
                            price: {
                                type: 'price',
                                name: 'Prix',
                                icon: 'üí∞',
                                selector: '.pricing-price',
                                allowMultiple: false,
                                properties: [
                                    { name: 'amount', type: 'number', label: 'Prix', defaultValue: 599, category: 'Contenu' },
                                    { name: 'currency', type: 'text', label: 'Devise', defaultValue: '$', category: 'Contenu' },
                                    { name: 'period', type: 'text', label: 'P√©riode', defaultValue: '/mois', category: 'Contenu' },
                                    { name: 'fontSize', type: 'range', label: 'Taille (px)', defaultValue: 48, min: 24, max: 72, category: 'Typographie' },
                                    { name: 'color', type: 'color', label: 'Couleur', defaultValue: '#FFFFFF', category: 'Couleurs' },
                                    { name: 'textAlign', type: 'select', label: 'Alignement', defaultValue: 'center', options: [
                                        { value: 'left', label: 'Gauche' },
                                        { value: 'center', label: 'Centr√©' },
                                        { value: 'right', label: 'Droite' }
                                    ], category: 'Alignement' }
                                ]
                            },
                            feature: {
                                type: 'feature',
                                name: 'Fonctionnalit√©',
                                icon: '‚úÖ',
                                selector: 'ul li',
                                allowMultiple: true,
                                properties: [
                                    { name: 'text', type: 'text', label: 'Texte', defaultValue: '‚úÖ Nouvelle fonctionnalit√©', category: 'Contenu' },
                                    { name: 'color', type: 'color', label: 'Couleur', defaultValue: '#CBD5E1', category: 'Style' }
                                ]
                            },
                            cta: {
                                type: 'cta',
                                name: 'Bouton CTA',
                                icon: 'üîò',
                                selector: '.pricing-cta',
                                allowMultiple: false,
                                properties: [
                                    { name: 'text', type: 'text', label: 'Texte', defaultValue: 'Choisir ce Plan', category: 'Contenu' },
                                    { name: 'backgroundColor', type: 'color', label: 'Couleur fond', defaultValue: '#10B981', category: 'Style' },
                                    { name: 'textColor', type: 'color', label: 'Couleur texte', defaultValue: '#FFFFFF', category: 'Style' },
                                    { name: 'borderRadius', type: 'range', label: 'Arrondi (px)', defaultValue: 8, min: 0, max: 25, category: 'Style' },
                                    { name: 'textAlign', type: 'select', label: 'Alignement', defaultValue: 'center', options: [
                                        { value: 'left', label: 'Gauche' },
                                        { value: 'center', label: 'Centr√©' },
                                        { value: 'right', label: 'Droite' }
                                    ], category: 'Alignement' }
                                ]
                            }
                        }
                    }
                };
            }

            // S√©lection d'un widget
            selectWidget(widgetType) {
                this.currentWidgetType = widgetType;
                this.widgetElements = this.getDefaultElementsForWidget(widgetType);
                this.renderWidget();
                this.renderProperties();
                this.updateStatus(`Widget ${widgetType} s√©lectionn√©`);
                
                // Mise √† jour du titre
                document.getElementById('currentWidgetName').textContent = this.widgetDefinitions[widgetType].name;
            }

            // Obtenir les √©l√©ments par d√©faut pour un widget
            getDefaultElementsForWidget(widgetType) {
                const definition = this.widgetDefinitions[widgetType];
                const elements = {};
                
                Object.entries(definition.elements).forEach(([elementType, elementDef]) => {
                    if (!elementDef.allowMultiple) {
                        // √âl√©ment unique
                        elements[elementType] = {
                            id: elementType + '_1',
                            type: elementType,
                            properties: this.getDefaultPropertiesForElement(elementDef)
                        };
                    } else {
                        // √âl√©ments multiples - cr√©er un exemplaire par d√©faut
                        elements[elementType] = [{
                            id: elementType + '_1',
                            type: elementType,
                            properties: this.getDefaultPropertiesForElement(elementDef)
                        }];
                        
                        // Pour les fonctionnalit√©s, cr√©er 4 par d√©faut
                        if (elementType === 'feature') {
                            const defaultFeatures = [
                                '‚úÖ Installation gratuite',
                                '‚úÖ Maintenance incluse', 
                                '‚úÖ Support 24/7',
                                '‚úÖ Jusqu\'√† 200 √©quipements'
                            ];
                            
                            elements[elementType] = defaultFeatures.map((text, index) => ({
                                id: `feature_${index + 1}`,
                                type: 'feature',
                                properties: {
                                    text: text,
                                    color: '#CBD5E1'
                                }
                            }));
                        }
                    }
                });
                
                return elements;
            }

            // Propri√©t√©s par d√©faut pour un √©l√©ment
            getDefaultPropertiesForElement(elementDef) {
                const properties = {};
                elementDef.properties.forEach(prop => {
                    properties[prop.name] = prop.defaultValue;
                });
                return properties;
            }

            // Rendu du widget
            renderWidget() {
                const preview = document.getElementById('widgetPreview');
                
                if (!this.currentWidgetType) {
                    preview.className = 'widget-preview empty';
                    preview.innerHTML = `
                        <div>
                            <div style="font-size: 3rem; opacity: 0.3; margin-bottom: 1rem;">üé®</div>
                            <div>S√©lectionnez un widget pour commencer l'√©dition</div>
                        </div>
                    `;
                    return;
                }

                preview.className = 'widget-preview';
                
                switch (this.currentWidgetType) {
                    case 'logo':
                        this.renderLogoWidget(preview);
                        break;
                    case 'hero-title':
                        this.renderHeroTitleWidget(preview);
                        break;
                    case 'pricing-card':
                        this.renderPricingCardWidget(preview);
                        break;
                }
                
                this.currentWidget = preview;
            }

            // Rendu Logo Widget
            renderLogoWidget(container) {
                const logoElement = this.widgetElements.logo;
                const props = logoElement.properties;
                
                container.innerHTML = `
                    <div style="display: flex; justify-content: center; align-items: center; height: 200px;">
                        <div class="nav-logo" style="
                            width: ${props.width}px;
                            height: ${props.height}px;
                            background-image: url('${props.imagePath}');
                            background-size: contain;
                            background-repeat: no-repeat;
                            background-position: center;
                            border: 2px solid ${props.borderColor};
                            background-color: ${props.backgroundColor};
                            border-radius: ${props.borderRadius}px;
                            transition: all 0.3s ease;
                        " title="${props.altText}"></div>
                    </div>
                `;
            }

            // Rendu Hero Title Widget  
            renderHeroTitleWidget(container) {
                let titlesHTML = '';
                let subtitlesHTML = '';
                
                // G√©n√©rer les titres
                if (Array.isArray(this.widgetElements.title)) {
                    this.widgetElements.title.forEach((titleElement, index) => {
                        const props = titleElement.properties;
                        titlesHTML += `
                            <h1 class="hero-title" data-element-id="${titleElement.id}" style="
                                font-size: ${props.fontSize}px;
                                color: ${props.color};
                                font-weight: ${props.fontWeight};
                                text-align: ${props.textAlign};
                                margin-bottom: 1rem;
                                line-height: 1.2;
                            ">${props.text}</h1>
                        `;
                    });
                } else {
                    const props = this.widgetElements.title.properties;
                    titlesHTML = `
                        <h1 class="hero-title" data-element-id="${this.widgetElements.title.id}" style="
                            font-size: ${props.fontSize}px;
                            color: ${props.color};
                            font-weight: ${props.fontWeight};
                            text-align: ${props.textAlign};
                            margin-bottom: 1rem;
                            line-height: 1.2;
                        ">${props.text}</h1>
                    `;
                }
                
                // G√©n√©rer les sous-titres
                if (Array.isArray(this.widgetElements.subtitle)) {
                    this.widgetElements.subtitle.forEach((subtitleElement, index) => {
                        const props = subtitleElement.properties;
                        subtitlesHTML += `
                            <div class="hero-subtitle" data-element-id="${subtitleElement.id}" style="
                                font-size: ${props.fontSize}px;
                                color: ${props.color};
                                text-align: ${props.textAlign};
                                margin-bottom: 1rem;
                                line-height: 1.5;
                            ">${props.text.replace(/\n/g, '<br>')}</div>
                        `;
                    });
                } else {
                    const props = this.widgetElements.subtitle.properties;
                    subtitlesHTML = `
                        <div class="hero-subtitle" data-element-id="${this.widgetElements.subtitle.id}" style="
                            font-size: ${props.fontSize}px;
                            color: ${props.color};
                            text-align: ${props.textAlign};
                            margin-bottom: 1rem;
                            line-height: 1.5;
                        ">${props.text.replace(/\n/g, '<br>')}</div>
                    `;
                }
                
                container.innerHTML = `
                    <div class="hero-text-content" style="text-align: center; padding: 2rem;">
                        ${titlesHTML}
                        ${subtitlesHTML}
                    </div>
                `;
            }

            // Rendu Pricing Card Widget
            renderPricingCardWidget(container) {
                const badge = this.widgetElements.badge;
                const planName = this.widgetElements.planName;
                const price = this.widgetElements.price;
                const cta = this.widgetElements.cta;
                
                // G√©n√©rer les fonctionnalit√©s
                let featuresHTML = '';
                if (Array.isArray(this.widgetElements.feature)) {
                    this.widgetElements.feature.forEach((featureElement) => {
                        const props = featureElement.properties;
                        featuresHTML += `
                            <li data-element-id="${featureElement.id}" style="
                                margin-bottom: 0.5rem; 
                                color: ${props.color};
                            ">${props.text}</li>
                        `;
                    });
                }
                
                container.innerHTML = `
                    <div class="pricing-card" style="
                        background: rgba(30, 41, 59, 0.8);
                        border: 2px solid rgba(16, 185, 129, 0.2);
                        border-radius: 16px;
                        padding: 2rem;
                        text-align: center;
                        max-width: 300px;
                        margin: 0 auto;
                        color: white;
                    ">
                        <div class="pricing-badge" data-element-id="${badge.id}" style="
                            background: ${badge.properties.backgroundColor};
                            color: ${badge.properties.textColor};
                            padding: 0.5rem 1rem;
                            border-radius: 8px;
                            font-size: 0.875rem;
                            font-weight: bold;
                            margin-bottom: 1rem;
                            display: inline-block;
                        ">${badge.properties.text}</div>
                        
                        <h3 data-element-id="${planName.id}" style="
                            font-size: ${planName.properties.fontSize}px; 
                            margin-bottom: 1rem; 
                            color: ${planName.properties.color};
                            text-align: ${planName.properties.textAlign};
                        ">${planName.properties.text}</h3>
                        
                        <div class="pricing-price" data-element-id="${price.id}" style="
                            margin-bottom: 2rem;
                            text-align: ${price.properties.textAlign};
                        ">
                            <span style="font-size: 1.5rem; color: #10B981;">${price.properties.currency}</span>
                            <span style="font-size: ${price.properties.fontSize}px; font-weight: 900; color: ${price.properties.color};">${price.properties.amount}</span>
                            <span style="color: #94A3B8;">${price.properties.period}</span>
                        </div>
                        
                        <ul style="list-style: none; margin-bottom: 2rem; text-align: left;">
                            ${featuresHTML}
                        </ul>
                        
                        <button class="pricing-cta" data-element-id="${cta.id}" style="
                            width: 100%;
                            padding: 1rem;
                            background: ${cta.properties.backgroundColor};
                            color: ${cta.properties.textColor};
                            border: none;
                            border-radius: ${cta.properties.borderRadius}px;
                            font-weight: bold;
                            cursor: pointer;
                            text-align: ${cta.properties.textAlign};
                        ">${cta.properties.text}</button>
                    </div>
                `;
            }

            // Interface des propri√©t√©s avec onglets et CRUD
            renderProperties() {
                const container = document.getElementById('propertiesContent');
                
                if (!this.currentWidgetType) {
                    container.innerHTML = `
                        <div style="text-align: center; padding: 2rem; color: var(--text-muted);">
                            <div style="font-size: 2rem; margin-bottom: 1rem; opacity: 0.5;">‚öôÔ∏è</div>
                            <div>S√©lectionnez un widget pour voir ses propri√©t√©s</div>
                        </div>
                    `;
                    return;
                }

                container.innerHTML = `
                    <div class="tabs-container">
                        <div class="tabs-header">
                            <button class="tab-button active" onclick="editor.switchPropertiesTab('properties')">üìù Propri√©t√©s</button>
                            <button class="tab-button" onclick="editor.switchPropertiesTab('elements')">üß© √âl√©ments</button>
                            <button class="tab-button" onclick="editor.switchPropertiesTab('organization')">üîÄ Organisation</button>
                        </div>
                        
                        <div class="tab-content">
                            <div id="propertiesTab" class="tab-pane active">
                                ${this.renderPropertiesContent()}
                            </div>
                            
                            <div id="elementsTab" class="tab-pane">
                                ${this.renderElementsManager()}
                            </div>
                            
                            <div id="organizationTab" class="tab-pane">
                                ${this.renderOrganizationInterface()}
                            </div>
                        </div>
                    </div>
                `;
            }

            // Contenu de l'onglet Propri√©t√©s
            renderPropertiesContent() {
                let html = '<div class="properties-grid">';
                
                // Pour chaque type d'√©l√©ment dans le widget
                Object.entries(this.widgetDefinitions[this.currentWidgetType].elements).forEach(([elementType, elementDef]) => {
                    const elements = this.widgetElements[elementType];
                    
                    if (Array.isArray(elements)) {
                        // √âl√©ments multiples
                        elements.forEach((element, index) => {
                            html += this.renderElementProperties(element, elementDef, `${elementDef.name} #${index + 1}`);
                        });
                    } else {
                        // √âl√©ment unique
                        html += this.renderElementProperties(elements, elementDef, elementDef.name);
                    }
                });
                
                html += '</div>';
                return html;
            }

            // Rendu des propri√©t√©s d'un √©l√©ment
            renderElementProperties(element, elementDef, title) {
                const categories = {};
                
                elementDef.properties.forEach(prop => {
                    const category = prop.category || 'G√©n√©ral';
                    if (!categories[category]) categories[category] = [];
                    categories[category].push(prop);
                });
                
                let html = `<div class="property-section">
                    <div class="property-section-title">${elementDef.icon} ${title}</div>`;
                
                Object.entries(categories).forEach(([categoryName, props]) => {
                    html += `<div style="margin-bottom: 1rem;">
                        <div style="font-weight: 600; color: var(--accent-green); margin-bottom: 0.5rem; font-size: 0.75rem;">${categoryName}</div>`;
                    
                    props.forEach(prop => {
                        html += this.renderPropertyInput(element, prop);
                    });
                    
                    html += '</div>';
                });
                
                html += '</div>';
                return html;
            }

            // Rendu d'un input de propri√©t√©
            renderPropertyInput(element, prop) {
                const value = element.properties[prop.name];
                let input = '';
                
                switch (prop.type) {
                    case 'text':
                        input = `<input type="text" class="property-input" value="${value}" 
                                onchange="editor.updateElementProperty('${element.id}', '${prop.name}', this.value)" 
                                oninput="editor.updateElementProperty('${element.id}', '${prop.name}', this.value)">`;
                        break;
                    case 'textarea':
                        input = `<textarea class="property-input" rows="3" 
                                onchange="editor.updateElementProperty('${element.id}', '${prop.name}', this.value)" 
                                oninput="editor.updateElementProperty('${element.id}', '${prop.name}', this.value)">${value}</textarea>`;
                        break;
                    case 'number':
                        input = `<input type="number" class="property-input" value="${value}" 
                                onchange="editor.updateElementProperty('${element.id}', '${prop.name}', this.value)" 
                                oninput="editor.updateElementProperty('${element.id}', '${prop.name}', this.value)">`;
                        break;
                    case 'color':
                        input = `<input type="color" class="property-input" value="${value}" 
                                onchange="editor.updateElementProperty('${element.id}', '${prop.name}', this.value)">`;
                        break;
                    case 'range':
                        input = `<div class="range-group">
                            <input type="range" class="property-input" value="${value}" 
                                   min="${prop.min}" max="${prop.max}" 
                                   onchange="editor.updateElementProperty('${element.id}', '${prop.name}', this.value)" 
                                   oninput="editor.updateElementProperty('${element.id}', '${prop.name}', this.value)">
                            <span class="range-value">${value}</span>
                        </div>`;
                        break;
                    case 'select':
                        let options = '';
                        prop.options.forEach(option => {
                            options += `<option value="${option.value}" ${option.value === value ? 'selected' : ''}>${option.label}</option>`;
                        });
                        input = `<select class="property-input" onchange="editor.updateElementProperty('${element.id}', '${prop.name}', this.value)">${options}</select>`;
                        break;
                }
                
                return `<div class="property-group">
                    <label class="property-label">${prop.label}</label>
                    ${input}
                </div>`;
            }

            // Gestionnaire d'√©l√©ments (CRUD)
            renderElementsManager() {
                let html = '<div class="elements-manager">';
                
                Object.entries(this.widgetDefinitions[this.currentWidgetType].elements).forEach(([elementType, elementDef]) => {
                    html += `<div class="property-section">
                        <div class="property-section-title">${elementDef.icon} ${elementDef.name} ${elementDef.allowMultiple ? '(Multi)' : ''}</div>
                        <div class="elements-list" id="elements-${elementType}">`;
                    
                    const elements = this.widgetElements[elementType];
                    
                    if (Array.isArray(elements)) {
                        elements.forEach((element, index) => {
                            html += this.renderElementItem(element, elementDef, index);
                        });
                    } else {
                        html += this.renderElementItem(elements, elementDef, 0);
                    }
                    
                    html += '</div>';
                    
                    if (elementDef.allowMultiple) {
                        html += `<button class="add-element-btn" onclick="editor.addElement('${elementType}')">
                            ‚ûï Ajouter ${elementDef.name}
                        </button>`;
                    }
                    
                    html += '</div>';
                });
                
                html += '</div>';
                return html;
            }

            // √âl√©ment individuel dans le gestionnaire
            renderElementItem(element, elementDef, index) {
                const isMultiple = Array.isArray(this.widgetElements[element.type]);
                const displayText = element.properties.text || element.properties.amount || '√âl√©ment';
                
                return `<div class="element-item" data-element-id="${element.id}" draggable="true">
                    <div class="element-handle">‚ãÆ‚ãÆ</div>
                    <div class="element-content">
                        <div class="element-icon">${elementDef.icon}</div>
                        <div class="element-text">${displayText}</div>
                    </div>
                    <div class="element-actions">
                        ${isMultiple ? `<button class="element-action" onclick="editor.moveElement('${element.type}', '${element.id}', 'up')" title="D√©placer vers le haut">‚¨ÜÔ∏è</button>` : ''}
                        ${isMultiple ? `<button class="element-action" onclick="editor.moveElement('${element.type}', '${element.id}', 'down')" title="D√©placer vers le bas">‚¨áÔ∏è</button>` : ''}
                        ${isMultiple ? `<button class="element-action" onclick="editor.duplicateElement('${element.type}', '${element.id}')">üìã</button>` : ''}
                        ${isMultiple ? `<button class="element-action danger" onclick="editor.deleteElement('${element.type}', '${element.id}')">üóëÔ∏è</button>` : ''}
                        <button class="element-action" onclick="editor.editElement('${element.id}')">‚úèÔ∏è</button>
                    </div>
                </div>`;
            }

            // Interface d'organisation avanc√©e (gestion multi-√©l√©ments)
            // R√¥le     : Fournit une vue d'ensemble compl√®te pour g√©rer tous les √©l√©ments
            // Type     : string (HTML interface)
            // Action   : G√©n√®re l'interface compl√®te de gestion des √©l√©ments multiples
            renderOrganizationInterface() {
                // R√¥le     : Statistiques des √©l√©ments pr√©sents
                // Type     : object {totalElements, byType}
                // Action   : Calcule le nombre total et par type d'√©l√©ment
                const stats = this.calculateElementStats();
                
                return `
                    <div class="organization-header" style="text-align: center; margin-bottom: 1rem;">
                        <div style="color: var(--accent-green); font-weight: bold; margin-bottom: 0.5rem;">
                            üîÄ Gestion Avanc√©e Multi-√âl√©ments
                        </div>
                        <div style="font-size: 0.75rem; color: var(--text-muted); margin-bottom: 0.5rem;">
                            ${stats.totalElements} √©l√©ments ‚Ä¢ ${Object.keys(stats.byType).length} types diff√©rents
                        </div>
                        <div class="stats-bar" style="display: flex; justify-content: center; gap: 1rem; margin-bottom: 1rem;">
                            ${Object.entries(stats.byType).map(([type, count]) => 
                                `<span class="stat-item" style="font-size: 0.7rem; padding: 0.2rem 0.5rem; background: var(--secondary-dark); border-radius: 0.3rem;">
                                    ${this.getElementTypeIcon(type)} ${count}
                                </span>`
                            ).join('')}
                        </div>
                    </div>

                    <div class="organization-tools" style="margin-bottom: 1rem;">
                        <div class="tool-row" style="display: flex; gap: 0.5rem; justify-content: center; margin-bottom: 0.5rem;">
                            <button class="toolbar-btn" onclick="editor.addMultipleElements()" title="Ajouter plusieurs √©l√©ments">
                                ‚ûï Ajout Multiple
                            </button>
                            <button class="toolbar-btn" onclick="editor.duplicateAllElements()" title="Dupliquer tous les √©l√©ments">
                                üìã Dupliquer Tout
                            </button>
                            <button class="toolbar-btn" onclick="editor.resetElementsOrder()" title="R√©initialiser l'ordre">
                                üîÑ R√©organiser
                            </button>
                        </div>
                        <div class="tool-row" style="display: flex; gap: 0.5rem; justify-content: center;">
                            <button class="toolbar-btn" onclick="editor.toggleElementsVisibility()" title="Masquer/Afficher √©l√©ments">
                                üëÅÔ∏è Visibilit√©
                            </button>
                            <button class="toolbar-btn danger" onclick="editor.clearAllElements()" title="Supprimer tous les √©l√©ments">
                                üóëÔ∏è Vider Tout
                            </button>
                        </div>
                    </div>

                    <div id="organizationElements">
                        ${this.renderOrganizationElements()}
                    </div>
                    
                    <div class="organization-footer" style="text-align: center; margin-top: 1rem; font-size: 0.7rem; color: var(--text-muted);">
                        üí° Utilisez les boutons ‚¨ÜÔ∏è ‚¨áÔ∏è pour r√©organiser ‚Ä¢ üìã pour dupliquer ‚Ä¢ üóëÔ∏è pour supprimer
                    </div>
                `;
            }

            renderOrganizationElements() {
                // Impl√©mentation de l'organisation des √©l√©ments
                return '<div style="text-align: center; padding: 2rem; color: var(--text-muted);">Fonctionnalit√© d\'organisation en d√©veloppement</div>';
            }

            // === M√âTHODES CRUD ===

            // Ajouter un √©l√©ment
            addElement(elementType) {
                const elementDef = this.widgetDefinitions[this.currentWidgetType].elements[elementType];
                const elements = this.widgetElements[elementType];
                
                if (!Array.isArray(elements)) {
                    this.updateStatus('Impossible d\'ajouter : √©l√©ment non multiple');
                    return;
                }
                
                const newId = `${elementType}_${Date.now()}`;
                const newElement = {
                    id: newId,
                    type: elementType,
                    properties: this.getDefaultPropertiesForElement(elementDef)
                };
                
                elements.push(newElement);
                this.renderWidget();
                this.renderProperties();
                this.updateStatus(`√âl√©ment ${elementDef.name} ajout√©`);
            }

            // Dupliquer un √©l√©ment
            duplicateElement(elementType, elementId) {
                const elements = this.widgetElements[elementType];
                if (!Array.isArray(elements)) return;
                
                const elementIndex = elements.findIndex(el => el.id === elementId);
                if (elementIndex === -1) return;
                
                const originalElement = elements[elementIndex];
                const newId = `${elementType}_${Date.now()}`;
                const duplicatedElement = {
                    id: newId,
                    type: elementType,
                    properties: { ...originalElement.properties }
                };
                
                elements.splice(elementIndex + 1, 0, duplicatedElement);
                this.renderWidget();
                this.renderProperties();
                this.updateStatus(`√âl√©ment dupliqu√©`);
            }

            // Supprimer un √©l√©ment
            deleteElement(elementType, elementId) {
                const elements = this.widgetElements[elementType];
                if (!Array.isArray(elements) || elements.length <= 1) {
                    this.updateStatus('Impossible de supprimer : au moins un √©l√©ment requis');
                    return;
                }
                
                const elementIndex = elements.findIndex(el => el.id === elementId);
                if (elementIndex === -1) return;
                
                elements.splice(elementIndex, 1);
                this.renderWidget();
                this.renderProperties();
                this.updateStatus(`√âl√©ment supprim√©`);
            }

            // M√©thode : D√©placer un √©l√©ment (haut/bas dans la liste)
            // R√¥le     : Change l'ordre d'affichage des √©l√©ments multiples
            // Param√®tres : elementType (string), elementId (string), direction ('up'|'down')
            // Action   : R√©organise les √©l√©ments dans le DOM et met √† jour les donn√©es
            moveElement(elementType, elementId, direction) {
                console.log(`üîÑ D√©placement ${elementType} ${elementId} vers ${direction}`);
                
                // R√¥le     : R√©cup√©ration du tableau d'√©l√©ments de m√™me type
                // Type     : Array d'objets element
                // Action   : Trouve la liste des √©l√©ments √† r√©organiser
                const elements = this.widgetElements[elementType];
                if (!Array.isArray(elements) || elements.length <= 1) {
                    this.updateStatus('D√©placement impossible : un seul √©l√©ment pr√©sent');
                    return;
                }

                // R√¥le     : Index actuel de l'√©l√©ment dans la liste
                // Type     : number (position dans le tableau)
                // Domaine  : 0 ‚â§ currentIndex < elements.length
                const currentIndex = elements.findIndex(el => el.id === elementId);
                if (currentIndex === -1) {
                    this.updateStatus('√âl√©ment introuvable pour d√©placement');
                    return;
                }

                let targetIndex;

                // R√¥le     : Calcul de l'index de destination
                // Type     : number (nouvelle position)
                // Action   : D√©termine o√π d√©placer l'√©l√©ment selon la direction
                if (direction === 'up') {
                    targetIndex = Math.max(0, currentIndex - 1);
                } else if (direction === 'down') {
                    targetIndex = Math.min(elements.length - 1, currentIndex + 1);
                } else {
                    this.updateStatus('Direction invalide pour d√©placement');
                    return;
                }

                // R√¥le     : V√©rification si d√©placement n√©cessaire
                // Type     : boolean
                // Action   : √âvite les op√©rations inutiles si position identique
                if (currentIndex === targetIndex) {
                    this.updateStatus('√âl√©ment d√©j√† √† la position demand√©e');
                    return;
                }

                // R√¥le     : √âchange des √©l√©ments dans le tableau
                // Type     : void (manipulation array)
                // Action   : Intervertit les positions dans la liste des √©l√©ments
                const elementToMove = elements[currentIndex];
                elements.splice(currentIndex, 1);
                elements.splice(targetIndex, 0, elementToMove);

                // R√¥le     : Mise √† jour de l'affichage
                // Type     : void (rendu)
                // Action   : Actualise le widget et l'interface pour refl√©ter le nouvel ordre
                this.renderWidget();
                this.renderProperties();
                
                // R√¥le     : Message de confirmation
                // Type     : string (feedback utilisateur)
                // Action   : Indique le succ√®s de l'op√©ration
                const directionText = direction === 'up' ? 'vers le haut' : 'vers le bas';
                this.updateStatus(`√âl√©ment d√©plac√© ${directionText} avec succ√®s`);
                
                console.log(`‚úÖ √âl√©ment ${elementId} d√©plac√© avec succ√®s ${direction}`);
            }

            // Modifier les propri√©t√©s d'un √©l√©ment
            updateElementProperty(elementId, propertyName, value) {
                let found = false;
                
                Object.values(this.widgetElements).forEach(elements => {
                    if (Array.isArray(elements)) {
                        elements.forEach(element => {
                            if (element.id === elementId) {
                                element.properties[propertyName] = value;
                                found = true;
                            }
                        });
                    } else {
                        if (elements.id === elementId) {
                            elements.properties[propertyName] = value;
                            found = true;
                        }
                    }
                });
                
                if (found) {
                    this.renderWidget();
                    // Mettre √† jour l'affichage de la valeur pour les ranges
                    const rangeValue = document.querySelector(`.range-value`);
                    if (rangeValue && propertyName.includes('Size') || propertyName === 'width' || propertyName === 'height') {
                        rangeValue.textContent = value;
                    }
                }
            }

            // === M√âTHODES D'INTERFACE ===

            // Changer d'onglet dans les propri√©t√©s
            switchPropertiesTab(tabName) {
                document.querySelectorAll('.tab-button').forEach(btn => btn.classList.remove('active'));
                document.querySelectorAll('.tab-pane').forEach(pane => pane.classList.remove('active'));
                
                document.querySelector(`button[onclick="editor.switchPropertiesTab('${tabName}')"]`).classList.add('active');
                document.getElementById(`${tabName}Tab`).classList.add('active');
            }

            // === M√âTHODES D'√âDITION ===

            // Zoom
            zoomIn() {
                this.zoomLevel = Math.min(this.zoomLevel + 25, 200);
                this.updateZoom();
            }

            zoomOut() {
                this.zoomLevel = Math.max(this.zoomLevel - 25, 25);
                this.updateZoom();
            }

            resetZoom() {
                this.zoomLevel = 100;
                this.updateZoom();
            }

            updateZoom() {
                document.getElementById('zoomLevel').textContent = `${this.zoomLevel}%`;
                const preview = document.getElementById('widgetPreview');
                preview.style.transform = `scale(${this.zoomLevel / 100})`;
                preview.style.transformOrigin = 'center top';
            }

            // === M√âTHODES UTILITAIRES ===

            updateStatus(message) {
                document.getElementById('statusBar').textContent = message;
                console.log(`[Widget Editor] ${message}`);
            }

            // M√©thodes de sauvegarde/export (√† impl√©menter)
            newProject() {
                if (confirm('Cr√©er un nouveau projet ? Les modifications non sauvegard√©es seront perdues.')) {
                    this.currentWidget = null;
                    this.currentWidgetType = null;
                    this.widgetElements = {};
                    this.renderWidget();
                    this.renderProperties();
                    this.updateStatus('Nouveau projet cr√©√©');
                }
            }

            saveProject() {
                const projectData = {
                    widgetType: this.currentWidgetType,
                    elements: this.widgetElements,
                    timestamp: new Date().toISOString()
                };
                
                // Sauvegarder dans localStorage pour cette d√©mo
                localStorage.setItem('widget_editor_project', JSON.stringify(projectData));
                this.updateStatus('Projet sauvegard√©');
            }

            exportWidget() {
                if (!this.currentWidget) {
                    this.updateStatus('Aucun widget √† exporter');
                    return;
                }
                
                const exportData = {
                    html: this.currentWidget.innerHTML,
                    widgetType: this.currentWidgetType,
                    elements: this.widgetElements
                };
                
                const blob = new Blob([JSON.stringify(exportData, null, 2)], { type: 'application/json' });
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = `widget_${this.currentWidgetType}_${Date.now()}.json`;
                a.click();
                URL.revokeObjectURL(url);
                
                this.updateStatus('Widget export√©');
            }

            undo() {
                this.updateStatus('Annuler (√† impl√©menter)');
            }

            redo() {
                this.updateStatus('Refaire (√† impl√©menter)');
            }

            preview() {
                this.updateStatus('Aper√ßu (√† impl√©menter)');
            }

            // ===============================================
            // M√âTHODES DE GESTION MULTI-√âL√âMENTS AVANC√âES
            // ===============================================

            // M√©thode : Calcul des statistiques des √©l√©ments
            // R√¥le     : Comptabilise les √©l√©ments par type pour l'interface d'organisation
            // Type     : object {totalElements, byType}
            // Action   : Analyse la r√©partition des √©l√©ments dans le widget actuel
            calculateElementStats() {
                const stats = {
                    totalElements: 0,
                    byType: {}
                };

                if (!this.widgetElements) return stats;

                // R√¥le     : Parcours de tous les types d'√©l√©ments
                // Type     : void (comptage)
                // Action   : Comptabilise chaque type et calcule le total
                Object.entries(this.widgetElements).forEach(([type, elements]) => {
                    const count = Array.isArray(elements) ? elements.length : 1;
                    stats.byType[type] = count;
                    stats.totalElements += count;
                });

                return stats;
            }

            // M√©thode : R√©cup√©ration d'ic√¥ne par type d'√©l√©ment
            // R√¥le     : Fournit l'ic√¥ne emoji correspondant au type d'√©l√©ment
            // Param√®tres : type (string) - le type d'√©l√©ment (title, subtitle, feature, etc.)
            // Retour   : string (emoji)
            getElementTypeIcon(type) {
                // R√¥le     : Mapping des types vers leurs ic√¥nes
                // Type     : object (dictionnaire type->ic√¥ne)
                const typeIcons = {
                    'title': 'üìù',
                    'subtitle': 'üìÑ',
                    'feature': '‚ú®',
                    'logo': 'üè¢',
                    'badge': 'üè∑Ô∏è',
                    'planName': 'üíº',
                    'price': 'üí∞',
                    'cta': 'üîò'
                };
                
                return typeIcons[type] || 'üì¶';
            }

            // M√©thode : Ajout de plusieurs √©l√©ments en une fois
            // R√¥le     : Interface pour ajouter rapidement plusieurs √©l√©ments
            // Action   : Ouvre une bo√Æte de dialogue pour s√©lection multiple
            addMultipleElements() {
                if (!this.currentWidget) {
                    this.updateStatus('Aucun widget s√©lectionn√©');
                    return;
                }

                // R√¥le     : Types d'√©l√©ments pouvant √™tre multiples
                // Type     : Array de strings
                // Action   : Filtre les √©l√©ments du widget actuel qui permettent la multiplicit√©
                const multipleTypes = Object.entries(this.widgetDefinitions[this.currentWidgetType].elements)
                    .filter(([key, def]) => def.allowMultiple)
                    .map(([key, def]) => ({ type: key, name: def.name, icon: def.icon }));

                if (multipleTypes.length === 0) {
                    this.updateStatus('Aucun √©l√©ment multiple disponible pour ce widget');
                    return;
                }

                // R√¥le     : Interface de s√©lection multiple
                // Type     : string (HTML prompt)
                // Action   : G√©n√®re une liste de checkboxes pour s√©lection
                const checkboxList = multipleTypes.map(item => 
                    `<label style="display: block; margin: 0.5rem 0;">
                        <input type="checkbox" value="${item.type}" style="margin-right: 0.5rem;">
                        ${item.icon} ${item.name}
                    </label>`
                ).join('');

                // R√¥le     : Bo√Æte de dialogue personnalis√©e
                // Type     : boolean (confirmation)
                // Action   : Affiche les options et traite la s√©lection
                const dialog = document.createElement('div');
                dialog.innerHTML = `
                    <div style="background: var(--bg-primary); border: 2px solid var(--accent-green); padding: 1rem; border-radius: 0.5rem; max-width: 400px;">
                        <h3 style="color: var(--accent-green); margin-top: 0;">‚ûï Ajout Multiple d'√âl√©ments</h3>
                        <div style="margin: 1rem 0;">
                            ${checkboxList}
                        </div>
                        <div style="text-align: right; margin-top: 1rem;">
                            <button onclick="this.parentElement.parentElement.remove()" style="margin-right: 0.5rem;">Annuler</button>
                            <button onclick="editor.processMultipleAddition()" style="background: var(--accent-green); color: white; border: none; padding: 0.5rem 1rem; border-radius: 0.3rem;">Ajouter</button>
                        </div>
                    </div>
                `;
                
                dialog.style.position = 'fixed';
                dialog.style.top = '50%';
                dialog.style.left = '50%';
                dialog.style.transform = 'translate(-50%, -50%)';
                dialog.style.zIndex = '10000';
                dialog.style.background = 'rgba(0,0,0,0.8)';
                dialog.style.width = '100%';
                dialog.style.height = '100%';
                dialog.style.display = 'flex';
                dialog.style.alignItems = 'center';
                dialog.style.justifyContent = 'center';
                
                document.body.appendChild(dialog);
                this.multiAddDialog = dialog;
            }

            // M√©thode : Traitement de l'ajout multiple
            // R√¥le     : Ajoute les √©l√©ments s√©lectionn√©s dans la bo√Æte de dialogue
            // Action   : Lit les checkboxes coch√©es et cr√©e les √©l√©ments correspondants
            processMultipleAddition() {
                if (!this.multiAddDialog) return;

                // R√¥le     : R√©cup√©ration des s√©lections
                // Type     : Array de strings (types s√©lectionn√©s)
                const selectedTypes = Array.from(this.multiAddDialog.querySelectorAll('input[type="checkbox"]:checked'))
                    .map(cb => cb.value);

                // R√¥le     : Ajout de chaque type s√©lectionn√©
                // Type     : void (cr√©ation d'√©l√©ments)
                selectedTypes.forEach(type => {
                    this.addElement(type);
                });

                // R√¥le     : Fermeture et nettoyage
                // Type     : void (cleanup UI)
                this.multiAddDialog.remove();
                this.multiAddDialog = null;

                if (selectedTypes.length > 0) {
                    this.updateStatus(`${selectedTypes.length} nouveaux √©l√©ments ajout√©s`);
                } else {
                    this.updateStatus('Aucun √©l√©ment s√©lectionn√©');
                }
            }

            // M√©thode : Duplication de tous les √©l√©ments multiples
            // R√¥le     : Cr√©e une copie de chaque √©l√©ment qui permet la multiplicit√©
            // Action   : Parcourt tous les √©l√©ments et les duplique si possible
            duplicateAllElements() {
                if (!this.currentWidget) {
                    this.updateStatus('Aucun widget s√©lectionn√©');
                    return;
                }

                let duplicatedCount = 0;

                // R√¥le     : Parcours de tous les types d'√©l√©ments
                // Type     : void (duplication)
                // Action   : Duplique chaque √©l√©ment s'il permet la multiplicit√©
                Object.entries(this.widgetElements).forEach(([type, elements]) => {
                    const elementDef = this.widgetDefinitions[this.currentWidgetType].elements[type];
                    
                    if (elementDef && elementDef.allowMultiple) {
                        if (Array.isArray(elements)) {
                            // Dupliquer le dernier √©l√©ment de chaque type
                            const lastElement = elements[elements.length - 1];
                            if (lastElement) {
                                this.duplicateElement(type, lastElement.id);
                                duplicatedCount++;
                            }
                        }
                    }
                });

                if (duplicatedCount > 0) {
                    this.updateStatus(`${duplicatedCount} √©l√©ments dupliqu√©s`);
                } else {
                    this.updateStatus('Aucun √©l√©ment √† dupliquer');
                }
            }

            // M√©thode : Basculer la visibilit√© des √©l√©ments
            // R√¥le     : Cache/affiche temporairement certains types d'√©l√©ments
            // Action   : Toggle la propri√©t√© CSS visibility pour pr√©visualisation
            toggleElementsVisibility() {
                if (!this.currentWidget || !this.currentWidget.instance) {
                    this.updateStatus('Aucun widget s√©lectionn√©');
                    return;
                }

                // R√¥le     : √âtat de visibilit√© global
                // Type     : boolean (toggle state)
                // Action   : D√©termine si les √©l√©ments sont actuellement cach√©s
                this.elementsHidden = !this.elementsHidden;
                
                const widget = this.currentWidget.instance;
                const opacity = this.elementsHidden ? '0.3' : '1';

                // R√¥le     : Application du style de visibilit√©
                // Type     : void (manipulation CSS)
                // Action   : Change l'opacit√© de tous les √©l√©ments avec data-element-id
                widget.querySelectorAll('[data-element-id]').forEach(element => {
                    element.style.opacity = opacity;
                    element.style.transition = 'opacity 0.3s ease';
                });

                const statusText = this.elementsHidden ? '√âl√©ments masqu√©s (30% opacit√©)' : '√âl√©ments affich√©s normalement';
                this.updateStatus(statusText);
            }

            // M√©thode : Vider tous les √©l√©ments (avec confirmation)
            // R√¥le     : Supprime tous les √©l√©ments multiples apr√®s confirmation
            // Action   : Remet le widget √† son √©tat minimal avec un √©l√©ment par type
            clearAllElements() {
                if (!this.currentWidget) {
                    this.updateStatus('Aucun widget s√©lectionn√©');
                    return;
                }

                // R√¥le     : Confirmation de s√©curit√©
                // Type     : boolean (confirmation utilisateur)
                // Action   : Emp√™che les suppressions accidentelles
                const confirmed = confirm('‚ö†Ô∏è √ätes-vous s√ªr de vouloir supprimer tous les √©l√©ments multiples ?\n\nCette action ne peut pas √™tre annul√©e.');
                
                if (!confirmed) {
                    this.updateStatus('Op√©ration annul√©e');
                    return;
                }

                let clearedCount = 0;

                // R√¥le     : Suppression des √©l√©ments multiples
                // Type     : void (nettoyage)
                // Action   : Garde uniquement le premier √©l√©ment de chaque type
                Object.entries(this.widgetElements).forEach(([type, elements]) => {
                    const elementDef = this.widgetDefinitions[this.currentWidgetType].elements[type];
                    
                    if (elementDef && elementDef.allowMultiple && Array.isArray(elements) && elements.length > 1) {
                        const elementsToRemove = elements.length - 1;
                        // Garder seulement le premier √©l√©ment
                        this.widgetElements[type] = [elements[0]];
                        clearedCount += elementsToRemove;
                    }
                });

                if (clearedCount > 0) {
                    this.renderWidget();
                    this.renderProperties();
                    this.updateStatus(`${clearedCount} √©l√©ments supprim√©s - Widget remis √† l'√©tat minimal`);
                } else {
                    this.updateStatus('Aucun √©l√©ment multiple √† supprimer');
                }
            }

            // M√©thode : R√©initialiser l'ordre des √©l√©ments
            // R√¥le     : Remet les √©l√©ments dans leur ordre d'origine par type
            // Action   : Trie les √©l√©ments par ID pour un ordre coh√©rent
            resetElementsOrder() {
                if (!this.currentWidget) {
                    this.updateStatus('Aucun widget s√©lectionn√©');
                    return;
                }

                // R√¥le     : Tri des √©l√©ments par ID
                // Type     : void (r√©organisation)
                // Action   : Trie chaque type d'√©l√©ment par ordre alphab√©tique d'ID
                Object.entries(this.widgetElements).forEach(([type, elements]) => {
                    if (Array.isArray(elements) && elements.length > 1) {
                        elements.sort((a, b) => a.id.localeCompare(b.id));
                    }
                });

                this.renderWidget();
                this.renderProperties();
                this.updateStatus('Ordre des √©l√©ments r√©initialis√©');
            }
        }

        // Initialisation
        const editor = new AdvancedWidgetEditor();
    </script>
</body>
</html>