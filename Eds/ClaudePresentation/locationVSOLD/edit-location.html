<!DOCTYPE html>
<html lang="fr">
<head>
    <!-- Configuration éditeur version LOCATION -->
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Éditeur Présentation LOCATION - Interface Vendeur</title>
    <meta name="description" content="Interface d'édition pour vendeurs - Personnaliser les arguments de présentation LOCATION">
    
    <!-- Polices cohérentes avec la page de location -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <style>
        /* Variables CSS thème LOCATION : vert et bleu - IDENTIQUES à location.html */
        :root {
            --primary-dark: #0F172A;
            --secondary-dark: #1E293B;
            --accent-green: #10B981;
            --accent-blue: #3B82F6;
            --accent-teal: #14B8A6;
            --success-green: #059669;
            --warning-orange: #F59E0B;
            --text-white: #F8FAFC;
            --text-gray: #CBD5E1;
            
            --gradient-primary: linear-gradient(135deg, var(--primary-dark) 0%, var(--secondary-dark) 100%);
            --gradient-green: linear-gradient(135deg, var(--accent-green) 0%, var(--accent-teal) 100%);
            --gradient-blue: linear-gradient(135deg, var(--accent-blue) 0%, #60A5FA 100%);
            --shadow-lg: 0 10px 15px rgba(0,0,0,0.5);
            --shadow-glow: 0 0 30px rgba(16, 185, 129, 0.4);
        }
        
        * { margin: 0; padding: 0; box-sizing: border-box; }
        
        body {
            font-family: 'Inter', sans-serif; background: var(--gradient-primary);
            color: var(--text-white); line-height: 1.6; min-height: 100vh;
        }
        
        .editor-header {
            background: rgba(15, 23, 42, 0.95); 
            backdrop-filter: blur(20px);
            padding: 1.5rem 2rem; 
            border-bottom: 1px solid var(--accent-green);
            position: sticky; top: 0; z-index: 100;
        }
        
        .header-content {
            max-width: 1200px; margin: 0 auto; display: flex;
            justify-content: space-between; align-items: center;
        }
        
        .editor-title {
            font-size: 1.8rem; font-weight: 700;
            background: var(--gradient-green);
            -webkit-background-clip: text; -webkit-text-fill-color: transparent;
        }
        
        .header-actions { display: flex; gap: 1rem; align-items: center; }
        
        .btn {
            padding: 0.75rem 1.5rem; border: none; border-radius: 8px;
            font-size: 0.95rem; font-weight: 600; cursor: pointer;
            transition: all 0.3s ease; text-decoration: none;
            display: inline-flex; align-items: center; gap: 0.5rem;
        }
        
        .btn-back {
            background: rgba(16, 185, 129, 0.1); 
            color: var(--accent-green);
            border: 1px solid var(--accent-green);
        }
        
        .btn-save { 
            background: var(--gradient-green); 
            color: white; 
            border: none;
        }
        
        .btn-preview { 
            background: var(--gradient-blue); 
            color: white; 
            border: none;
        }
        
        .btn:hover { 
            transform: translateY(-2px); 
            box-shadow: var(--shadow-glow); 
        }
        
        .editor-container { max-width: 1200px; margin: 0 auto; padding: 2rem; }
        
        .status-message {
            background: rgba(16, 185, 129, 0.1); border: 1px solid var(--accent-green);
            border-radius: 10px; padding: 1rem; margin-bottom: 2rem;
            text-align: center; display: none;
        }
        
        .status-message.success {
            background: rgba(16, 185, 129, 0.1); border-color: var(--success-green);
            color: var(--success-green); display: block;
        }
        
        .status-message.error {
            background: rgba(239, 68, 68, 0.1); border-color: var(--warning-red);
            color: var(--warning-red); display: block;
        }
        
        .edit-section {
            background: var(--gradient-primary);
            border-radius: 18px;
            padding: 2rem; 
            margin-bottom: 2rem;
            border-left: 4px solid var(--accent-green);
            box-shadow: var(--shadow-lg);
        }
        
        .section-title {
            font-size: 1.5rem; font-weight: 700; color: var(--accent-green);
            margin-bottom: 1.5rem; display: flex; align-items: center; gap: 0.5rem;
        }
        
        .edit-grid { display: grid; gap: 1.5rem; }
        
        .edit-field { display: flex; flex-direction: column; gap: 0.5rem; }
        
        .field-label {
            font-weight: 600; color: var(--text-white); font-size: 0.95rem;
        }
        
        .field-description {
            font-size: 0.85rem; color: var(--text-gray); font-style: italic;
        }
        
        .field-input {
            background: rgba(16, 185, 129, 0.08);
            border: 1px solid rgba(16, 185, 129, 0.2);
            border-radius: 12px; 
            padding: 1rem; 
            color: var(--text-white);
            font-size: 1rem; 
            transition: all 0.3s ease; 
            font-family: inherit;
        }
        
        .field-textarea { min-height: 100px; resize: vertical; }
        
        .field-input:focus {
            outline: none; 
            border-color: var(--accent-green);
            background: rgba(16, 185, 129, 0.12);
            box-shadow: var(--shadow-glow);
            transform: translateY(-1px);
        }
        
        .field-input::placeholder { color: rgba(203, 213, 225, 0.5); }
        
        .numeric-field { display: flex; align-items: center; gap: 1rem; }
        .numeric-input { flex: 1; }
        .field-unit { color: var(--text-gray); font-size: 0.9rem; font-weight: 500; }
        
        .pricing-grid {
            display: grid; grid-template-columns: repeat(3, 1fr);
            gap: 1.5rem; margin-top: 1rem;
        }
        
        .pricing-edit-card {
            background: rgba(16, 185, 129, 0.08); 
            border-radius: 18px;
            padding: 2rem; 
            border-left: 4px solid var(--accent-green);
            transition: all 0.3s ease;
            box-shadow: var(--shadow-lg);
        }
        
        .pricing-edit-card:hover {
            transform: translateX(8px); 
            background: rgba(16, 185, 129, 0.12);
        }
        
        .pricing-edit-card.featured {
            border-left: 4px solid var(--warning-orange);
            background: rgba(245, 158, 11, 0.08);
            box-shadow: var(--shadow-glow);
        }
        
        .live-preview {
            background: rgba(30, 41, 59, 0.3); border-radius: 10px;
            padding: 1rem; margin-top: 1rem;
            border-left: 4px solid var(--accent-green);
        }
        
        .preview-title {
            font-size: 0.9rem; color: var(--accent-green);
            font-weight: 600; margin-bottom: 0.5rem;
        }
        
        .preview-content { color: var(--text-gray); font-style: italic; }
        
        .editor-actions {
            position: sticky; bottom: 0;
            background: rgba(15, 23, 42, 0.95); backdrop-filter: blur(20px);
            padding: 1.5rem 2rem; border-top: 1px solid rgba(16, 185, 129, 0.2);
            margin-top: 3rem;
        }
        
        .actions-content {
            max-width: 1200px; margin: 0 auto; display: flex;
            justify-content: space-between; align-items: center;
        }
        
        .save-status { display: flex; align-items: center; gap: 0.5rem;
            color: var(--text-gray); font-size: 0.9rem; }
        
        .status-icon { font-size: 1rem; }
        
        .status-icon.saving {
            color: var(--accent-teal); animation: spin 1s infinite;
        }
        
        .status-icon.saved { color: var(--success-green); }
        
        @keyframes spin {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }
        
        /* === ÉDITEUR CSS SIMPLE === */
        .css-editor-section {
            background: rgba(31, 154, 60, 0.1);
            border: 1px solid var(--primary-green);
            border-radius: 12px;
            margin: 1rem auto;
            max-width: 1200px;
            overflow: hidden;
        }
        
        .css-title {
            background: var(--primary-green);
            color: white;
            padding: 1rem;
            margin: 0;
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: 1.2rem;
            font-weight: 600;
        }
        
        .css-toggle {
            background: none;
            border: none;
            color: white;
            cursor: pointer;
            padding: 0.5rem;
            border-radius: 4px;
            transition: background 0.2s;
        }
        
        .css-toggle:hover {
            background: rgba(255, 255, 255, 0.2);
        }
        
        .css-editor {
            padding: 1.5rem;
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1.5rem;
        }
        
        .css-editor.collapsed {
            display: none;
        }
        
        .css-group {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 8px;
            padding: 1rem;
        }
        
        .css-group h3 {
            color: var(--accent-green);
            margin: 0 0 1rem 0;
            font-size: 1rem;
            font-weight: 600;
        }
        
        .css-group h4 {
            color: var(--text-white);
            margin: 1.5rem 0 0.8rem 0;
            font-size: 0.9rem;
            font-weight: 500;
            border-bottom: 1px solid rgba(16, 185, 129, 0.2);
            padding-bottom: 0.3rem;
        }
        
        /* Grille de couleurs 2D optimisée (4 colonnes × 3 lignes) */
        .color-grid-2d {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 0.8rem;
            margin-bottom: 1.5rem;
            max-width: 100%;
            overflow: hidden;
            box-sizing: border-box;
        }
        
        /* Responsive : réduction en 2 colonnes sur petits écrans */
        @media (max-width: 768px) {
            .color-grid-2d {
                grid-template-columns: repeat(2, 1fr);
                gap: 0.6rem;
            }
        }
        
        /* Ancienne grille de couleurs (conservée pour compatibilité) */
        .color-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
            margin-bottom: 1rem;
        }
        
        .color-item {
            display: flex;
            flex-direction: column;
            gap: 0.3rem;
            background: rgba(255, 255, 255, 0.03);
            padding: 0.6rem;
            border-radius: 6px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            transition: all 0.3s ease;
            cursor: pointer;
            box-sizing: border-box;
            min-width: 0;
            overflow: hidden;
        }
        
        .color-item:hover {
            background: rgba(16, 185, 129, 0.1);
            border-color: rgba(16, 185, 129, 0.3);
        }
        
        .color-item span {
            color: var(--text-white);
            font-size: 0.8rem;
            font-weight: 500;
            text-align: center;
            line-height: 1.3;
            margin-bottom: 0.2rem;
            /* Texte sur 2 lignes max pour meilleure lisibilité */
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
            overflow: hidden;
        }
        
        .color-item input[type="color"] {
            width: 100%;
            height: 35px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            box-sizing: border-box;
        }
        
        .color-item small {
            color: var(--text-gray);
            font-size: 0.65rem;
            font-style: italic;
            text-align: center;
            line-height: 1.2;
            /* Description sur 2 lignes max avec tooltip */
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
            overflow: hidden;
            cursor: help;
        }
        
        /* Tooltip pour les descriptions complètes */
        .color-item {
            position: relative;
        }
        
        .color-item:hover small::after {
            content: attr(title);
            position: absolute;
            bottom: 100%;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(0, 0, 0, 0.9);
            color: white;
            padding: 0.5rem;
            border-radius: 4px;
            font-size: 0.7rem;
            white-space: nowrap;
            z-index: 1000;
            pointer-events: none;
            opacity: 0;
            transition: opacity 0.3s ease;
        }
        
        .color-item:hover small[title]::after {
            opacity: 1;
        }
        
        /* Système de réorganisation des sections */
        .reorganizable-section {
            position: relative;
            transition: all 0.3s ease;
        }
        
        .section-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            width: 100%;
        }
        
        .section-info {
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        
        .section-controls {
            display: flex;
            align-items: center;
            gap: 0.8rem;
        }
        
        .section-btn {
            background: rgba(16, 185, 129, 0.1);
            border: 1px solid rgba(16, 185, 129, 0.3);
            color: var(--accent-green);
            padding: 0.4rem 0.6rem;
            border-radius: 4px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 0.8rem;
        }
        
        .section-btn:hover {
            background: rgba(16, 185, 129, 0.2);
            border-color: rgba(16, 185, 129, 0.5);
            transform: translateY(-1px);
        }
        
        .section-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }
        
        .section-spacer-control {
            display: flex;
            align-items: center;
            gap: 0.3rem;
            background: rgba(255, 255, 255, 0.05);
            padding: 0.3rem 0.6rem;
            border-radius: 4px;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .section-spacer-control label {
            color: var(--text-gray);
            font-size: 0.75rem;
            margin: 0;
        }
        
        /* Contrôles d'espacement de sections (ne s'appliquent QUE à location.html) */
        .section-spacing-input {
            width: 60px;
            background: rgba(0, 0, 0, 0.3);
            border: 1px solid rgba(255, 255, 255, 0.2);
            color: var(--text-white);
            padding: 0.2rem 0.4rem;
            border-radius: 3px;
            font-size: 0.8rem;
        }
        
        .section-spacing-input:focus {
            outline: none;
            border-color: var(--accent-green);
        }
        
        /* Contrôles d'espacement pour l'éditeur de styles avancé */
        .spacing-input {
            width: 60px;
            background: rgba(0, 0, 0, 0.3);
            border: 1px solid rgba(255, 255, 255, 0.2);
            color: var(--text-white);
            padding: 0.2rem 0.4rem;
            border-radius: 3px;
            font-size: 0.8rem;
        }
        
        .spacing-input:focus {
            outline: none;
            border-color: var(--accent-green);
        }
        
        .section-moving {
            opacity: 0.7;
            transform: scale(0.98);
        }
        
        .css-controls {
            display: flex;
            flex-direction: column;
            gap: 0.8rem;
        }
        
        .css-controls label {
            color: var(--text-white);
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-size: 0.9rem;
        }
        
        .css-controls input[type="color"] {
            width: 40px;
            height: 30px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
        }
        
        .css-controls input[type="range"] {
            flex: 1;
            margin: 0 0.5rem;
        }
        
        .css-controls select {
            background: var(--bg-field, #475569);
            border: 1px solid rgba(255, 255, 255, 0.2);
            color: var(--text-primary, #FFFFFF);
            padding: 0.3rem;
            border-radius: 4px;
            cursor: pointer;
        }
        
        .css-controls select option {
            background: var(--bg-field, #475569);
            color: var(--text-primary, #FFFFFF);
            padding: 0.3rem;
        }
        
        .css-controls span {
            color: var(--accent-green);
            font-weight: 500;
            min-width: 60px;
            text-align: right;
            font-size: 0.85rem;
        }
        
        .range-control {
            display: flex;
            flex-direction: column;
            gap: 0.3rem;
        }
        
        .range-control .range-label {
            color: var(--text-white);
            font-size: 0.9rem;
            margin-bottom: 0.2rem;
        }
        
        .range-control .range-value {
            color: var(--accent-green);
            font-weight: 600;
            text-align: center;
            font-size: 0.85rem;
            margin-bottom: 0.2rem;
        }
        
        .range-control input[type="range"] {
            width: 100%;
        }
        
        .css-actions {
            grid-column: 1 / -1;
            display: flex;
            gap: 1rem;
            justify-content: center;
            margin-top: 1rem;
        }
        
        .css-btn {
            padding: 0.8rem 1.5rem;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            transition: all 0.3s ease;
        }
        
        .css-btn.reset {
            background: #dc3545;
            color: white;
        }
        
        .css-btn.save {
            background: var(--success-green);
            color: white;
        }
        
        .css-btn.import {
            background: #17a2b8;
            color: white;
        }
        
        .css-btn.export {
            background: #28a745;
            color: white;
        }
        
        .css-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
        }

        @media (max-width: 768px) {
            .editor-container { padding: 1rem; }
            .header-content { flex-direction: column; gap: 1rem; text-align: center; }
            .header-actions { flex-wrap: wrap; justify-content: center; }
            .actions-content { flex-direction: column; gap: 1rem; text-align: center; }
            .pricing-grid { grid-template-columns: 1fr; }
            .css-editor { grid-template-columns: 1fr; }
            .css-actions { flex-wrap: wrap; }
        }
    </style>
</head>
<body>
    <!-- En-tête éditeur LOCATION -->
    <header class="editor-header">
        <div class="header-content">
            <h1 class="editor-title">
                <i class="fas fa-presentation"></i>
                Interface Vendeur - SOLUTION ZÉRO RISQUE
            </h1>
            <div class="header-actions">
                <a href="location.html" class="btn btn-back">
                    <i class="fas fa-arrow-left"></i>
                    Retour Présentation Location
                </a>
                <button class="btn btn-preview" onclick="togglePreview()">
                    <i class="fas fa-sync"></i>
                    Synchroniser & Prévisualiser
                </button>
            </div>
        </div>
    </header>

    <!-- Message de statut -->
    <div class="status-message" id="statusMessage">
        <i class="fas fa-info-circle"></i>
        <span id="statusText">Interface Vendeur LOCATION prête</span>
    </div>

    <!-- Section Styles CSS Globaux -->
    <section class="css-editor-section">
        <h2 class="css-title">
            <i class="fas fa-palette"></i>
            Style de la Page
            <button class="css-toggle" onclick="toggleCSSEditor()">
                <i class="fas fa-chevron-up"></i>
            </button>
        </h2>
        <div class="css-editor" id="cssEditor">
            <!-- Couleurs Thème Location - Grille 2D Optimisée -->
            <div class="css-group">
                <h3>🎨 Couleurs Thème Location</h3>
                <p class="section-description">Personnalisez toutes les couleurs de votre présentation avec cette grille complète 2D</p>
                
                <!-- Grille de Couleurs 2D (4x3) -->
                <div class="color-grid-2d">
                    <!-- Ligne 1: Couleurs de Base -->
                    <label class="color-item">
                        <span>Fond Principal</span>
                        <input type="color" id="primaryDark" value="#0F172A">
                        <small title="Couleur d'arrière-plan principal de toute la présentation">Arrière-plan principal</small>
                    </label>
                    <label class="color-item">
                        <span>Fond Sections</span>
                        <input type="color" id="secondaryDark" value="#1E293B">
                        <small title="Couleur d'arrière-plan des sections et contenus">Arrière-plan sections</small>
                    </label>
                    <label class="color-item">
                        <span>Texte Blanc</span>
                        <input type="color" id="textWhite" value="#F8FAFC">
                        <small title="Couleur du texte principal blanc utilisé partout">Texte principal blanc</small>
                    </label>
                    <label class="color-item">
                        <span>Texte Gris</span>
                        <input type="color" id="textGray" value="#CBD5E1">
                        <small title="Couleur du texte gris pour descriptions et détails">Texte gris descriptif</small>
                    </label>
                    
                    <!-- Ligne 2: Couleurs d'Accent -->
                    <label class="color-item">
                        <span>Vert Principal</span>
                        <input type="color" id="accentGreen" value="#10B981">
                        <small title="Couleur principale pour boutons, liens et éléments interactifs">Boutons et éléments</small>
                    </label>
                    <label class="color-item">
                        <span>Bleu Accent</span>
                        <input type="color" id="accentBlue" value="#3B82F6">
                        <small title="Couleur d'accent bleu pour liens et détails visuels">Liens et détails</small>
                    </label>
                    <label class="color-item">
                        <span>Teal Accent</span>
                        <input type="color" id="accentTeal" value="#14B8A6">
                        <small title="Couleur teal pour gradients, bordures et effets spéciaux">Gradients et effets</small>
                    </label>
                    <label class="color-item">
                        <span>Vert Succès</span>
                        <input type="color" id="successGreen" value="#059669">
                        <small title="Couleur verte pour messages de succès et éléments positifs">Messages positifs</small>
                    </label>
                    
                    <!-- Ligne 3: Couleurs d'État -->
                    <label class="color-item">
                        <span>Orange Alert</span>
                        <input type="color" id="warningOrange" value="#F59E0B">
                        <small title="Couleur orange pour alertes, avertissements et warnings">Alertes et warnings</small>
                    </label>
                    <label class="color-item">
                        <span>Rouge Erreur</span>
                        <input type="color" id="warningRed" value="#EF4444">
                        <small title="Couleur rouge pour erreurs, annulations et éléments négatifs">Erreurs et négatif</small>
                    </label>
                    <label class="color-item">
                        <span>Bleu Info</span>
                        <input type="color" id="infoBlue" value="#60A5FA">
                        <small title="Couleur bleue pour informations, conseils et aide">Informations</small>
                    </label>
                    <label class="color-item">
                        <span>Gris Neutre</span>
                        <input type="color" id="neutralGray" value="#9CA3AF">
                        <small title="Couleur grise neutre pour éléments secondaires et séparateurs">Éléments neutres</small>
                    </label>
                </div>
            </div>
            
            <!-- Navigation -->
            <div class="css-group">
                <h3>Navigation</h3>
                <div class="css-controls">
                    <div class="range-control">
                        <span class="range-label">Taille Titre Nav:</span>
                        <span class="range-value" id="navTitleSizeValue">28px</span>
                        <input type="range" id="navTitleSize" min="20" max="40" value="28">
                    </div>
                    <label>Épaisseur Titre Nav: 
                        <select id="navTitleWeight">
                            <option value="600">Semi-Bold</option>
                            <option value="700">Bold</option>
                            <option value="800">Extra-Bold</option>
                            <option value="900">Black</option>
                        </select>
                    </label>
                    <div class="range-control">
                        <span class="range-label">Taille Items Nav:</span>
                        <span class="range-value" id="navItemSizeValue">16px</span>
                        <input type="range" id="navItemSize" min="12" max="22" value="16">
                    </div>
                    <div class="range-control">
                        <span class="range-label">Padding Nav:</span>
                        <span class="range-value" id="navPaddingValue">12px</span>
                        <input type="range" id="navPadding" min="8" max="24" value="12">
                    </div>
                </div>
            </div>
            
            <!-- Hero Section -->
            <div class="css-group">
                <h3>Section Hero</h3>
                <div class="css-controls">
                    <div class="range-control">
                        <span class="range-label">Taille Titre Hero:</span>
                        <span class="range-value" id="heroTitleSizeValue">72px</span>
                        <input type="range" id="heroTitleSize" min="40" max="100" value="72">
                    </div>
                    <div class="range-control">
                        <span class="range-label">Taille Highlight Hero:</span>
                        <span class="range-value" id="heroHighlightSizeValue">80px</span>
                        <input type="range" id="heroHighlightSize" min="50" max="120" value="80">
                    </div>
                    <div class="range-control">
                        <span class="range-label">Taille Sous-titre:</span>
                        <span class="range-value" id="heroSubtitleSizeValue">22px</span>
                        <input type="range" id="heroSubtitleSize" min="16" max="32" value="22">
                    </div>
                    <label>Épaisseur Titre Hero: 
                        <select id="heroTitleWeight">
                            <option value="700">Bold</option>
                            <option value="800">Extra-Bold</option>
                            <option value="900">Black</option>
                        </select>
                    </label>
                </div>
            </div>
            
            <!-- Prix Banner -->
            <div class="css-group">
                <h3>Bannière Prix</h3>
                <div class="css-controls">
                    <div class="range-control">
                        <span class="range-label">Taille Prix Principal:</span>
                        <span class="range-value" id="priceMainSizeValue">56px</span>
                        <input type="range" id="priceMainSize" min="30" max="80" value="56">
                    </div>
                    <div class="range-control">
                        <span class="range-label">Taille Prix Secondaire:</span>
                        <span class="range-value" id="priceSubSizeValue">18px</span>
                        <input type="range" id="priceSubSize" min="12" max="26" value="18">
                    </div>
                    <div class="range-control">
                        <span class="range-label">Padding Prix:</span>
                        <span class="range-value" id="pricePaddingValue">24px</span>
                        <input type="range" id="pricePadding" min="12" max="40" value="24">
                    </div>
                </div>
            </div>
            
            <!-- Titres de Sections -->
            <div class="css-group">
                <h3>Titres de Sections</h3>
                <div class="css-controls">
                    <div class="range-control">
                        <span class="range-label">Taille Titre Section:</span>
                        <span class="range-value" id="sectionTitleSizeValue">56px</span>
                        <input type="range" id="sectionTitleSize" min="30" max="80" value="56">
                    </div>
                    <label>Épaisseur Titre Section: 
                        <select id="sectionTitleWeight">
                            <option value="600">Semi-Bold</option>
                            <option value="700">Bold</option>
                            <option value="800">Extra-Bold</option>
                            <option value="900">Black</option>
                        </select>
                    </label>
                </div>
            </div>
            
            <!-- Cards et Benefits -->
            <div class="css-group">
                <h3>Cartes et Avantages</h3>
                <div class="css-controls">
                    <div class="range-control">
                        <span class="range-label">Padding Cartes:</span>
                        <span class="range-value" id="cardPaddingValue">28px</span>
                        <input type="range" id="cardPadding" min="16" max="50" value="28">
                    </div>
                    <div class="range-control">
                        <span class="range-label">Border Radius:</span>
                        <span class="range-value" id="cardBorderRadiusValue">16px</span>
                        <input type="range" id="cardBorderRadius" min="8" max="30" value="16">
                    </div>
                    <div class="range-control">
                        <span class="range-label">Taille Icônes:</span>
                        <span class="range-value" id="benefitIconSizeValue">40px</span>
                        <input type="range" id="benefitIconSize" min="24" max="60" value="40">
                    </div>
                    <div class="range-control">
                        <span class="range-label">Taille Titre Avantage:</span>
                        <span class="range-value" id="benefitTitleSizeValue">18px</span>
                        <input type="range" id="benefitTitleSize" min="14" max="26" value="18">
                    </div>
                    <div class="range-control">
                        <span class="range-label">Taille Texte Avantage:</span>
                        <span class="range-value" id="benefitTextSizeValue">14px</span>
                        <input type="range" id="benefitTextSize" min="12" max="20" value="14">
                    </div>
                </div>
            </div>
            
            <!-- Cartes de Prix -->
            <div class="css-group">
                <h3>Cartes de Prix</h3>
                <div class="css-controls">
                    <div class="range-control">
                        <span class="range-label">Padding Prix Cards:</span>
                        <span class="range-value" id="pricingCardPaddingValue">40px</span>
                        <input type="range" id="pricingCardPadding" min="20" max="60" value="40">
                    </div>
                    <div class="range-control">
                        <span class="range-label">Taille Valeur Prix:</span>
                        <span class="range-value" id="pricingValueSizeValue">48px</span>
                        <input type="range" id="pricingValueSize" min="30" max="70" value="48">
                    </div>
                    <div class="range-control">
                        <span class="range-label">Taille Durée:</span>
                        <span class="range-value" id="pricingDurationSizeValue">18px</span>
                        <input type="range" id="pricingDurationSize" min="14" max="24" value="18">
                    </div>
                </div>
            </div>
            
            <!-- Boutons CTA -->
            <div class="css-group">
                <h3>Boutons d'Action</h3>
                <div class="css-controls">
                    <div class="range-control">
                        <span class="range-label">Taille Police CTA:</span>
                        <span class="range-value" id="ctaFontSizeValue">19px</span>
                        <input type="range" id="ctaFontSize" min="14" max="26" value="19">
                    </div>
                    <label>Épaisseur CTA: 
                        <select id="ctaFontWeight">
                            <option value="600">Semi-Bold</option>
                            <option value="700">Bold</option>
                            <option value="800">Extra-Bold</option>
                        </select>
                    </label>
                    <div class="range-control">
                        <span class="range-label">Padding CTA:</span>
                        <span class="range-value" id="ctaPaddingValue">19px</span>
                        <input type="range" id="ctaPadding" min="12" max="30" value="19">
                    </div>
                </div>
            </div>
            
            <!-- Espacement Global -->
            <div class="css-group">
                <h3>Espacement Global</h3>
                <div class="css-controls">
                    <div class="range-control">
                        <span class="range-label">Padding Sections:</span>
                        <span class="range-value" id="sectionPaddingValue">64px</span>
                        <input type="range" id="sectionPadding" min="32" max="100" value="64">
                    </div>
                    <div class="range-control">
                        <span class="range-label">Largeur Max Container:</span>
                        <span class="range-value" id="containerMaxWidthValue">1400px</span>
                        <input type="range" id="containerMaxWidth" min="1000" max="1800" value="1400">
                    </div>
                    <div class="range-control">
                        <span class="range-label">Espacement Grid:</span>
                        <span class="range-value" id="gridGapValue">32px</span>
                        <input type="range" id="gridGap" min="16" max="60" value="32">
                    </div>
                </div>
            </div>
            
            <!-- Actions -->
            <div class="css-actions">
                <button onclick="resetCSS()" class="css-btn reset">
                    <i class="fas fa-undo"></i> Réinitialiser
                </button>
                <button onclick="saveCSS()" class="css-btn save">
                    <i class="fas fa-save"></i> Sauvegarder
                </button>
                <button onclick="importCSS()" class="css-btn import">
                    <i class="fas fa-upload"></i> Importer
                </button>
                <button onclick="exportCSS()" class="css-btn export">
                    <i class="fas fa-download"></i> Exporter
                </button>
            </div>
        </div>
    </section>

    <!-- Conteneur principal éditeur LOCATION -->
    <main class="editor-container">
        
        <!-- Section Configuration Header et Métadonnées -->
        <section class="edit-section">
            <h2 class="section-title">
                <i class="fas fa-cog"></i>
                Configuration Header et Métadonnées
            </h2>
            <div class="edit-grid">
                <!-- Métadonnées de la page -->
                <div class="edit-field">
                    <label class="field-label" for="page-title">Titre de la page (title)</label>
                    <p class="field-description">Titre affiché dans l'onglet du navigateur</p>
                    <input type="text" id="page-title" class="field-input" data-field="page-title" 
                           placeholder="Li-CUBE PRO™ - Outil Présentation LOCATION | EDS Québec" 
                           value="Li-CUBE PRO™ - Outil Présentation LOCATION | EDS Québec">
                </div>

                <div class="edit-field">
                    <label class="field-label" for="page-description">Description SEO (meta description)</label>
                    <p class="field-description">Description pour les moteurs de recherche et réseaux sociaux</p>
                    <textarea id="page-description" class="field-input field-textarea" data-field="page-description" 
                              placeholder="Outil de présentation commerciale Li-CUBE PRO™ LOCATION...">Outil de présentation commerciale Li-CUBE PRO™ LOCATION : Arguments de service et tranquillité pour équipes de vente EDS Québec.</textarea>
                </div>

                <div class="edit-field">
                    <label class="field-label" for="nav-title">Titre navigation header</label>
                    <p class="field-description">Titre affiché dans la barre de navigation (actuellement: 🛡️ SOLUTION ZÉRO RISQUE)</p>
                    <input type="text" id="nav-title" class="field-input" data-field="nav-title" 
                           placeholder="🛡️ SOLUTION ZÉRO RISQUE" value="🛡️ SOLUTION ZÉRO RISQUE">
                </div>

                <!-- Boutons de navigation du header -->
                <div class="edit-field">
                    <label class="field-label" for="nav-btn1">Bouton navigation 1</label>
                    <p class="field-description">Premier bouton de navigation (actuellement: Sans Risque)</p>
                    <input type="text" id="nav-btn1" class="field-input" data-field="nav-btn1" 
                           placeholder="Sans Risque" value="Sans Risque">
                </div>

                <div class="edit-field">
                    <label class="field-label" for="nav-btn2">Bouton navigation 2</label>
                    <p class="field-description">Deuxième bouton de navigation (actuellement: Tarifs)</p>
                    <input type="text" id="nav-btn2" class="field-input" data-field="nav-btn2" 
                           placeholder="Tarifs" value="Tarifs">
                </div>

                <div class="edit-field">
                    <label class="field-label" for="nav-btn3">Bouton navigation 3</label>
                    <p class="field-description">Troisième bouton de navigation (actuellement: Avantages)</p>
                    <input type="text" id="nav-btn3" class="field-input" data-field="nav-btn3" 
                           placeholder="Avantages" value="Avantages">
                </div>

                <div class="edit-field">
                    <label class="field-label" for="nav-btn4">Bouton navigation 4</label>
                    <p class="field-description">Quatrième bouton de navigation (actuellement: Louer Maintenant)</p>
                    <input type="text" id="nav-btn4" class="field-input" data-field="nav-btn4" 
                           placeholder="Louer Maintenant" value="Louer Maintenant">
                </div>

                <div class="edit-field">
                    <label class="field-label" for="nav-btn5">Bouton navigation 5</label>
                    <p class="field-description">Cinquième bouton de navigation (actuellement: Voir Achat)</p>
                    <input type="text" id="nav-btn5" class="field-input" data-field="nav-btn5" 
                           placeholder="Voir Achat" value="Voir Achat">
                </div>
                
                <div class="edit-field">
                    <label class="field-label" for="logo-path">Chemin logo entreprise</label>
                    <p class="field-description">Chemin vers le logo de l'entreprise dans la navigation</p>
                    <input type="text" id="logo-path" class="field-input" data-field="logo-path" 
                           placeholder="./images/logo edsquebec.png" value="./images/logo edsquebec.png">
                </div>
                
                
                <div class="edit-field">
                    <label class="field-label" for="company-image-path">Chemin image entreprise</label>
                    <p class="field-description">Chemin vers l'image de l'entreprise</p>
                    <input type="text" id="company-image-path" class="field-input" data-field="company-image-path" 
                           placeholder="./images/edsQuebec.png" value="./images/edsQuebec.png">
                </div>
            </div>
        </section>


        <!-- Section Héro Principal -->
        <section class="edit-section reorganizable-section" data-section-id="hero" data-section-order="1">
            <h2 class="section-title">
                <div class="section-header">
                    <div class="section-info">
                        <i class="fas fa-home"></i>
                        Section Héro Principale
                    </div>
                    <div class="section-controls">
                        <button class="section-btn move-up" onclick="moveSectionUp('hero')" title="Monter la section">
                            <i class="fas fa-chevron-up"></i>
                        </button>
                        <button class="section-btn move-down" onclick="moveSectionDown('hero')" title="Descendre la section">
                            <i class="fas fa-chevron-down"></i>
                        </button>
                        <div class="section-spacer-control">
                            <label for="heroSpacing">Espacement (px):</label>
                            <input type="number" id="heroSpacing" class="section-spacing-input" data-field="heroSpacerHeight" 
                                   value="80" min="0" max="500" step="10">
                        </div>
                    </div>
                </div>
            </h2>
            <div class="edit-grid">
                <!-- COLONNE GAUCHE : Texte Héro (comme dans location.html) -->
                <div style="grid-column: span 2; background: rgba(16, 185, 129, 0.1); border-radius: 12px; padding: 1.5rem; margin-bottom: 1rem;">
                    <h3 style="color: var(--accent-green); margin-bottom: 1rem; display: flex; align-items: center; gap: 0.5rem;">
                        <i class="fas fa-align-left"></i> Contenu Textuel (Colonne Gauche)
                    </h3>
                    
                    <div class="edit-grid" style="grid-template-columns: 1fr 1fr; gap: 1rem;">
                        <div class="edit-field">
                            <label class="field-label" for="hero-title">Titre héro principal</label>
                            <p class="field-description">Titre principal dans la section héro</p>
                            <input type="text" id="hero-title" class="field-input" data-field="hero-title" 
                                   placeholder="Li-CUBE PRO™" value="Li-CUBE PRO™">
                        </div>

                        <div class="edit-field">
                            <label class="field-label" for="hero-subtitle">Sous-titre héro</label>
                            <p class="field-description">Sous-titre accrocheur</p>
                            <input type="text" id="hero-subtitle" class="field-input" data-field="hero-subtitle" 
                                   placeholder="LOCATION INTELLIGENTE ZÉRO RISQUE" value="LOCATION INTELLIGENTE ZÉRO RISQUE">
                        </div>
                    </div>

                    <div class="edit-field">
                        <label class="field-label" for="hero-description">Description héro</label>
                        <p class="field-description">Description détaillée du service de location</p>
                        <textarea id="hero-description" class="field-input field-textarea" data-field="hero-description" 
                                  placeholder="Pourquoi prendre des risques...">Pourquoi prendre des risques ? Louez votre Li-CUBE PRO™ et laissez EDS gérer tout ! Performance garantie, maintenance incluse, remplacement immédiat en cas de problème. Vous payez, vous utilisez, nous nous occupons du reste.</textarea>
                    </div>

                    <div class="edit-grid" style="grid-template-columns: 1fr 1fr; gap: 1rem;">
                        <div class="edit-field">
                            <label class="field-label" for="monthly-price">Prix mensuel</label>
                            <p class="field-description">Prix affiché (avec $)</p>
                            <input type="text" id="monthly-price" class="field-input" data-field="monthly-price" 
                                   placeholder="150 $" value="150 $">
                        </div>

                        <div class="edit-field">
                            <label class="field-label" for="cta-text">Texte bouton</label>
                            <p class="field-description">Appel à l'action</p>
                            <input type="text" id="cta-text" class="field-input" data-field="cta-text" 
                                   placeholder="ARGUMENTS DE CLOSING - 150-200$/MOIS" value="ARGUMENTS DE CLOSING - 150-200$/MOIS">
                        </div>
                    </div>

                    <div class="edit-field">
                        <label class="field-label" for="price-included">Services inclus</label>
                        <p class="field-description">Liste des services inclus</p>
                        <textarea id="price-included" class="field-input field-textarea" data-field="price-included" 
                                  placeholder="Maintenance, monitoring, support...">Maintenance, monitoring, support et garantie totale inclus</textarea>
                    </div>
                </div>

                <!-- COLONNE DROITE : Gestion des Images (comme dans location.html) -->
                <div style="grid-column: span 2; background: rgba(59, 130, 246, 0.1); border-radius: 12px; padding: 1.5rem;">
                    <h3 style="color: var(--accent-blue); margin-bottom: 1rem; display: flex; align-items: center; gap: 0.5rem;">
                        <i class="fas fa-image"></i> Gestion des Images (Colonne Droite)
                    </h3>
                    
                    <!-- Rôle : Configuration des chemins d'images pour la section héro -->
                    <!-- Type : input text (chemin de fichier) -->
                    <!-- Domaine : chemins relatifs vers images (.png, .jpg, .jpeg, .webp, .svg) -->
                    <!-- Usage : définir les images affichées dans la présentation héro -->
                    <div class="edit-grid" style="grid-template-columns: 1fr 1fr; gap: 1rem;">
                        <div class="edit-field">
                            <label class="field-label" for="product-image-path">Chemin image produit principal</label>
                            <p class="field-description">Chemin vers l'image du produit principal dans la section héro</p>
                            <input type="text" id="product-image-path" class="field-input" data-field="product-image-path" 
                                   placeholder="./images/Li-CUBE PRO.png" value="./images/Li-CUBE PRO.png">
                        </div>

                        <div class="edit-field">
                            <label class="field-label" for="competitor-image-path">Chemin image produit concurrent</label>
                            <p class="field-description">Chemin vers l'image du produit concurrent pour comparaison</p>
                            <input type="text" id="competitor-image-path" class="field-input" data-field="competitor-image-path" 
                                   placeholder="./images/concurrent.png" value="./images/concurrent.png">
                        </div>
                    </div>

                    <!-- Rôle : Élément visuel VS pour la comparaison -->
                    <!-- Type : input text (texte court) -->
                    <!-- Domaine : texte de 1-10 caractères (généralement "VS" ou équivalent) -->
                    <!-- Usage : séparateur visuel entre les deux produits comparés -->
                    <div class="edit-field">
                        <label class="field-label" for="vs-element-text">Texte élément VS</label>
                        <p class="field-description">Texte affiché entre les deux images (produit vs concurrent)</p>
                        <input type="text" id="vs-element-text" class="field-input" data-field="vs-element-text" 
                               placeholder="VS" value="VS" maxlength="10">
                    </div>

                    <p style="color: var(--text-gray); font-style: italic; margin-top: 1rem; font-size: 0.9rem;">
                        <i class="fas fa-info-circle"></i> Les images seront affichées côte à côte dans la présentation avec l'élément VS au centre
                    </p>
                </div>
            </div>
        </section>
        
        <!-- Section Arguments Héro LOCATION -->
        <section class="edit-section reorganizable-section" data-section-id="hero-arguments" data-section-order="1.5">
            <h2 class="section-title">
                <div class="section-header">
                    <div class="section-info">
                        <i class="fas fa-shield-alt"></i>
                        Arguments de Location Principaux
                    </div>
                    <div class="section-controls">
                        <button class="section-btn move-up" onclick="moveSectionUp('hero-arguments')" title="Monter la section">
                            <i class="fas fa-chevron-up"></i>
                        </button>
                        <button class="section-btn move-down" onclick="moveSectionDown('hero-arguments')" title="Descendre la section">
                            <i class="fas fa-chevron-down"></i>
                        </button>
                        <div class="section-spacer-control">
                            <label for="heroArgumentsSpacing">Espacement (px):</label>
                            <input type="number" id="heroArgumentsSpacing" class="section-spacing-input" data-field="heroArgumentsSpacerHeight" 
                                   value="0" min="0" max="500" step="10">
                        </div>
                    </div>
                </div>
            </h2>
            <div class="edit-grid">
                <div class="edit-field">
                    <label class="field-label" for="hero-title">Titre produit principal</label>
                    <p class="field-description">Nom du produit pour la version LOCATION</p>
                    <input type="text" id="hero-title" class="field-input" data-field="hero-title" 
                           placeholder="Li-CUBE PRO™" value="Li-CUBE PRO™">
                    <div class="live-preview">
                        <div class="preview-title">Aperçu location :</div>
                        <div class="preview-content" id="preview-hero-title">Produit Principal</div>
                    </div>
                </div>

                <div class="edit-field">
                    <label class="field-label" for="hero-subtitle">Accroche location sans risque</label>
                    <p class="field-description">Message principal axé sur l'absence de risque</p>
                    <input type="text" id="hero-subtitle" class="field-input" data-field="hero-subtitle" 
                           placeholder="LOCATION INTELLIGENTE ZÉRO RISQUE" 
                           value="LOCATION INTELLIGENTE ZÉRO RISQUE">
                    <div class="live-preview">
                        <div class="preview-title">Aperçu location :</div>
                        <div class="preview-content" id="preview-hero-subtitle">LOCATION INTELLIGENTE ZÉRO RISQUE</div>
                    </div>
                </div>

                <div class="edit-field">
                    <label class="field-label" for="hero-description">Description argumentaire de location</label>
                    <p class="field-description">Paragraphe de location avec arguments zéro risque et service inclus</p>
                    <textarea id="hero-description" class="field-input field-textarea" data-field="hero-description" 
                              placeholder="Pourquoi prendre des risques...">Pourquoi prendre des risques ? Louez votre Li-CUBE PRO™ et laissez EDS gérer tout ! Performance garantie, maintenance incluse, remplacement immédiat en cas de problème. Vous payez, vous utilisez, nous nous occupons du reste.</textarea>
                </div>

                <div class="edit-field">
                    <label class="field-label" for="monthly-price">Prix mensuel principal</label>
                    <p class="field-description">Tarif de location mis en avant</p>
                    <div class="numeric-field">
                        <input type="text" id="monthly-price" class="field-input numeric-input" data-field="monthly-price" 
                               placeholder="150 $" value="150 $">
                        <span class="field-unit">/mois</span>
                    </div>
                </div>

                <div class="edit-field">
                    <label class="field-label" for="price-included">Services inclus dans le prix</label>
                    <p class="field-description">Ce qui est compris dans le tarif mensuel</p>
                    <textarea id="price-included" class="field-input field-textarea" data-field="price-included" 
                              placeholder="Maintenance, monitoring, support...">Maintenance, monitoring, support et garantie totale inclus</textarea>
                </div>

                <div class="edit-field">
                    <label class="field-label" for="cta-text">Call-to-action principal</label>
                    <p class="field-description">Texte du bouton d'action avec prix de location</p>
                    <input type="text" id="cta-text" class="field-input" data-field="cta-text" 
                           placeholder="LOUER MAINTENANT - 150$/MOIS" 
                           value="LOUER MAINTENANT - 150$/MOIS">
                </div>

                <!-- Arguments de Vente Héro -->
                <div class="edit-field">
                    <label class="field-label" for="hero-arg1-icon">Icône argument 1</label>
                    <p class="field-description">Icône pour ZÉRO RISQUE</p>
                    <input type="text" id="hero-arg1-icon" class="field-input" data-field="hero-arg1-icon" 
                           placeholder="🛡️" value="🛡️">
                </div>

                <div class="edit-field">
                    <label class="field-label" for="hero-arg1-title">Titre argument 1</label>
                    <p class="field-description">Titre principal premier argument</p>
                    <input type="text" id="hero-arg1-title" class="field-input" data-field="hero-arg1-title" 
                           placeholder="ZÉRO RISQUE" value="ZÉRO RISQUE">
                </div>

                <div class="edit-field">
                    <label class="field-label" for="hero-arg1-desc">Description argument 1</label>
                    <p class="field-description">Explication ZÉRO RISQUE</p>
                    <input type="text" id="hero-arg1-desc" class="field-input" data-field="hero-arg1-desc" 
                           placeholder="EDS assume 100% des pannes" value="EDS assume 100% des pannes">
                </div>

                <div class="edit-field">
                    <label class="field-label" for="hero-arg2-icon">Icône argument 2</label>
                    <p class="field-description">Icône pour BUDGET PRÉVISIBLE</p>
                    <input type="text" id="hero-arg2-icon" class="field-input" data-field="hero-arg2-icon" 
                           placeholder="💰" value="💰">
                </div>

                <div class="edit-field">
                    <label class="field-label" for="hero-arg2-title">Titre argument 2</label>
                    <p class="field-description">Titre principal deuxième argument</p>
                    <input type="text" id="hero-arg2-title" class="field-input" data-field="hero-arg2-title" 
                           placeholder="BUDGET PRÉVISIBLE" value="BUDGET PRÉVISIBLE">
                </div>

                <div class="edit-field">
                    <label class="field-label" for="hero-arg2-desc">Description argument 2</label>
                    <p class="field-description">Explication BUDGET PRÉVISIBLE</p>
                    <input type="text" id="hero-arg2-desc" class="field-input" data-field="hero-arg2-desc" 
                           placeholder="Coût fixe mensuel garanti" value="Coût fixe mensuel garanti">
                </div>

                <div class="edit-field">
                    <label class="field-label" for="hero-arg3-icon">Icône argument 3</label>
                    <p class="field-description">Icône pour MAINTENANCE INCLUSE</p>
                    <input type="text" id="hero-arg3-icon" class="field-input" data-field="hero-arg3-icon" 
                           placeholder="🔧" value="🔧">
                </div>

                <div class="edit-field">
                    <label class="field-label" for="hero-arg3-title">Titre argument 3</label>
                    <p class="field-description">Titre principal troisième argument</p>
                    <input type="text" id="hero-arg3-title" class="field-input" data-field="hero-arg3-title" 
                           placeholder="MAINTENANCE INCLUSE" value="MAINTENANCE INCLUSE">
                </div>

                <div class="edit-field">
                    <label class="field-label" for="hero-arg3-desc">Description argument 3</label>
                    <p class="field-description">Explication MAINTENANCE INCLUSE</p>
                    <input type="text" id="hero-arg3-desc" class="field-input" data-field="hero-arg3-desc" 
                           placeholder="Monitoring 24/7 automatique" value="Monitoring 24/7 automatique">
                </div>

                <div class="edit-field">
                    <label class="field-label" for="hero-arg4-icon">Icône argument 4</label>
                    <p class="field-description">Icône pour MISE À JOUR CONTINUE</p>
                    <input type="text" id="hero-arg4-icon" class="field-input" data-field="hero-arg4-icon" 
                           placeholder="⚡" value="⚡">
                </div>

                <div class="edit-field">
                    <label class="field-label" for="hero-arg4-title">Titre argument 4</label>
                    <p class="field-description">Titre principal quatrième argument</p>
                    <input type="text" id="hero-arg4-title" class="field-input" data-field="hero-arg4-title" 
                           placeholder="MISE À JOUR CONTINUE" value="MISE À JOUR CONTINUE">
                </div>

                <div class="edit-field">
                    <label class="field-label" for="hero-arg4-desc">Description argument 4</label>
                    <p class="field-description">Explication MISE À JOUR CONTINUE</p>
                    <input type="text" id="hero-arg4-desc" class="field-input" data-field="hero-arg4-desc" 
                           placeholder="Dernière technologie toujours" value="Dernière technologie toujours">
                </div>
            </div>
        </section>

        <!-- Section Grille Tarifaire -->
        <section class="edit-section reorganizable-section" data-section-id="pricing" data-section-order="2">
            <h2 class="section-title">
                <div class="section-header">
                    <div class="section-info">
                        <i class="fas fa-dollar-sign"></i>
                        Grille Tarifaire de Location
                    </div>
                    <div class="section-controls">
                        <button class="section-btn move-up" onclick="moveSectionUp('pricing')" title="Monter la section">
                            <i class="fas fa-chevron-up"></i>
                        </button>
                        <button class="section-btn move-down" onclick="moveSectionDown('pricing')" title="Descendre la section">
                            <i class="fas fa-chevron-down"></i>
                        </button>
                        <div class="section-spacer-control">
                            <label for="pricingSpacing">Espacement (px):</label>
                            <input type="number" id="pricingSpacing" class="section-spacing-input" data-field="heroPricingSpacerHeight" 
                                   value="0" min="0" max="500" step="10">
                        </div>
                    </div>
                </div>
            </h2>
            <div class="edit-grid">
                <div class="edit-field">
                    <label class="field-label" for="pricing-title">Titre section tarifs</label>
                    <p class="field-description">Titre accrocheur pour la grille de prix</p>
                    <input type="text" id="pricing-title" class="field-input" data-field="pricing-title" 
                           placeholder="TARIFS DE LOCATION TRANSPARENTS" value="TARIFS DE LOCATION TRANSPARENTS">
                </div>

                <div class="edit-field">
                    <label class="field-label" for="pricing-subtitle">Explication tarifs</label>
                    <p class="field-description">Phrase explicative des avantages tarifaires</p>
                    <textarea id="pricing-subtitle" class="field-input field-textarea" data-field="pricing-subtitle" 
                              placeholder="Prix tout inclus, sans surprise...">Prix tout inclus, sans surprise. Plus vous louez longtemps, moins vous payez !</textarea>
                </div>

                <!-- Grille des 3 offres de location -->
                <div class="pricing-grid">
                    <!-- Offre 6 mois -->
                    <div class="pricing-edit-card">
                        <div class="edit-field">
                            <label class="field-label" for="pricing-duration-6m">Titre durée pack 1</label>
                            <p class="field-description">Titre affiché pour la première offre</p>
                            <input type="text" id="pricing-duration-6m" class="field-input" data-field="pricing-duration-6m" 
                                   placeholder="ESSAI 6 MOIS" value="ESSAI 6 MOIS">
                        </div>
                        <div class="edit-field">
                            <label class="field-label" for="price-6months">Prix 6 mois</label>
                            <div class="numeric-field">
                                <input type="text" id="price-6months" class="field-input numeric-input" data-field="price-6months" 
                                       placeholder="175 $" value="175 $">
                                <span class="field-unit">/mois</span>
                            </div>
                        </div>
                        <div class="edit-field">
                            <label class="field-label" for="pack6-service1">Service 1 (6 mois)</label>
                            <input type="text" id="pack6-service1" class="field-input" data-field="pack6-service1" 
                                   placeholder="Installation gratuite" value="Installation gratuite">
                        </div>
                        <div class="edit-field">
                            <label class="field-label" for="pack6-service2">Service 2 (6 mois)</label>
                            <input type="text" id="pack6-service2" class="field-input" data-field="pack6-service2" 
                                   placeholder="Maintenance incluse" value="Maintenance incluse">
                        </div>
                        <div class="edit-field">
                            <label class="field-label" for="pack6-service3">Service 3 (6 mois)</label>
                            <input type="text" id="pack6-service3" class="field-input" data-field="pack6-service3" 
                                   placeholder="Support 8h-17h" value="Support 8h-17h">
                        </div>
                        <div class="edit-field">
                            <label class="field-label" for="pack6-service4">Service 4 (6 mois)</label>
                            <input type="text" id="pack6-service4" class="field-input" data-field="pack6-service4" 
                                   placeholder="Monitoring de base" value="Monitoring de base">
                        </div>
                    </div>

                    <!-- Offre 2 ans (recommandée) -->
                    <div class="pricing-edit-card featured">
                        <div class="edit-field">
                            <label class="field-label" for="pricing-duration-2y">Titre durée pack 2</label>
                            <p class="field-description">Titre affiché pour l'offre standard (recommandée)</p>
                            <input type="text" id="pricing-duration-2y" class="field-input" data-field="pricing-duration-2y" 
                                   placeholder="STANDARD 2 ANS" value="STANDARD 2 ANS">
                        </div>
                        <div class="edit-field">
                            <label class="field-label" for="price-2years">Prix 2 ans (recommandé)</label>
                            <div class="numeric-field">
                                <input type="text" id="price-2years" class="field-input numeric-input" data-field="price-2years" 
                                       placeholder="150 $" value="150 $">
                                <span class="field-unit">/mois</span>
                            </div>
                        </div>
                        <div class="edit-field">
                            <label class="field-label" for="pack24-service1">Service 1 (2 ans)</label>
                            <input type="text" id="pack24-service1" class="field-input" data-field="pack24-service1" 
                                   placeholder="Installation gratuite" value="Installation gratuite">
                        </div>
                        <div class="edit-field">
                            <label class="field-label" for="pack24-service2">Service 2 (2 ans)</label>
                            <input type="text" id="pack24-service2" class="field-input" data-field="pack24-service2" 
                                   placeholder="Maintenance incluse" value="Maintenance incluse">
                        </div>
                        <div class="edit-field">
                            <label class="field-label" for="pack24-service3">Service 3 (2 ans)</label>
                            <input type="text" id="pack24-service3" class="field-input" data-field="pack24-service3" 
                                   placeholder="Support 24/7" value="Support 24/7">
                        </div>
                        <div class="edit-field">
                            <label class="field-label" for="pack24-service4">Service 4 (2 ans)</label>
                            <input type="text" id="pack24-service4" class="field-input" data-field="pack24-service4" 
                                   placeholder="Monitoring avancé IoT" value="Monitoring avancé IoT">
                        </div>
                        <div class="edit-field">
                            <label class="field-label" for="pack24-service5">Service 5 (2 ans)</label>
                            <input type="text" id="pack24-service5" class="field-input" data-field="pack24-service5" 
                                   placeholder="Remplacement immédiat" value="Remplacement immédiat">
                        </div>
                    </div>

                    <!-- Offre 5 ans -->
                    <div class="pricing-edit-card">
                        <div class="edit-field">
                            <label class="field-label" for="pricing-duration-5y">Titre durée pack 3</label>
                            <p class="field-description">Titre affiché pour l'offre longue durée</p>
                            <input type="text" id="pricing-duration-5y" class="field-input" data-field="pricing-duration-5y" 
                                   placeholder="PREMIUM 5 ANS" value="PREMIUM 5 ANS">
                        </div>
                        <div class="edit-field">
                            <label class="field-label" for="price-5years">Prix 5 ans</label>
                            <div class="numeric-field">
                                <input type="text" id="price-5years" class="field-input numeric-input" data-field="price-5years" 
                                       placeholder="125 $" value="125 $">
                                <span class="field-unit">/mois</span>
                            </div>
                        </div>
                        <div class="edit-field">
                            <label class="field-label" for="pack60-service1">Service 1 (5 ans)</label>
                            <input type="text" id="pack60-service1" class="field-input" data-field="pack60-service1" 
                                   placeholder="Installation gratuite" value="Installation gratuite">
                        </div>
                        <div class="edit-field">
                            <label class="field-label" for="pack60-service2">Service 2 (5 ans)</label>
                            <input type="text" id="pack60-service2" class="field-input" data-field="pack60-service2" 
                                   placeholder="Maintenance incluse" value="Maintenance incluse">
                        </div>
                        <div class="edit-field">
                            <label class="field-label" for="pack60-service3">Service 3 (5 ans)</label>
                            <input type="text" id="pack60-service3" class="field-input" data-field="pack60-service3" 
                                   placeholder="Support premium 24/7" value="Support premium 24/7">
                        </div>
                        <div class="edit-field">
                            <label class="field-label" for="pack60-service4">Service 4 (5 ans)</label>
                            <input type="text" id="pack60-service4" class="field-input" data-field="pack60-service4" 
                                   placeholder="Monitoring IA prédictif" value="Monitoring IA prédictif">
                        </div>
                        <div class="edit-field">
                            <label class="field-label" for="pack60-service5">Service 5 (5 ans)</label>
                            <input type="text" id="pack60-service5" class="field-input" data-field="pack60-service5" 
                                   placeholder="Upgrade technologique inclus" value="Upgrade technologique inclus">
                        </div>
                        <div class="edit-field">
                            <label class="field-label" for="pack60-service6">Service 6 (5 ans)</label>
                            <input type="text" id="pack60-service6" class="field-input" data-field="pack60-service6" 
                                   placeholder="Option d'achat privilégiée" value="Option d'achat privilégiée">
                        </div>
                    </div>
                </div>

                <div class="edit-field">
                    <label class="field-label" for="pricing-note">Note tarifaire</label>
                    <p class="field-description">Information complémentaire sur les prix</p>
                    <textarea id="pricing-note" class="field-input field-textarea" data-field="pricing-note" 
                              placeholder="💡 Astuce : Tarifs dégressifs...">💡 Astuce : Tarifs dégressifs pour multiple unités !</textarea>
                </div>

                <div class="edit-field">
                    <label class="field-label" for="volume-discounts">Remises volume</label>
                    <p class="field-description">Détail des remises selon quantité</p>
                    <textarea id="volume-discounts" class="field-input field-textarea" data-field="volume-discounts" 
                              placeholder="2-4 unités : -10%...">2-4 unités : -10% | 5-9 unités : -15% | 10+ unités : -20% | 20+ unités : sur devis personnalisé</textarea>
                </div>
            </div>
        </section>


        <!-- Section Avantages Location -->
        <section class="edit-section reorganizable-section" data-section-id="advantages" data-section-order="3">
            <h2 class="section-title">
                <div class="section-header">
                    <div class="section-info">
                        <i class="fas fa-thumbs-up"></i>
                        Arguments Avantages Location
                    </div>
                    <div class="section-controls">
                        <button class="section-btn move-up" onclick="moveSectionUp('advantages')" title="Monter la section">
                            <i class="fas fa-chevron-up"></i>
                        </button>
                        <button class="section-btn move-down" onclick="moveSectionDown('advantages')" title="Descendre la section">
                            <i class="fas fa-chevron-down"></i>
                        </button>
                        <div class="section-spacer-control">
                            <label for="advantagesSpacing">Espacement (px):</label>
                            <input type="number" id="advantagesSpacing" class="section-spacing-input" data-field="pricingAdvantagesSpacerHeight" 
                                   value="0" min="0" max="500" step="10">
                        </div>
                    </div>
                </div>
            </h2>
            <div class="edit-grid">
                <!-- TITRE DE LA SECTION -->
                <div class="edit-field" style="grid-column: span 2; margin-bottom: 1.5rem;">
                    <label class="field-label" for="advantages-title">Titre avantages location</label>
                    <p class="field-description">Question engageante pour les avantages location</p>
                    <input type="text" id="advantages-title" class="field-input" data-field="advantages-title" 
                           placeholder="POURQUOI CHOISIR LA LOCATION ?" value="POURQUOI CHOISIR LA LOCATION ?">
                </div>

                <!-- GRILLE 2x3 DES AVANTAGES (comme dans location.html) -->
                
                <!-- LIGNE 1 -->
                <div style="background: rgba(16, 185, 129, 0.08); border-radius: 12px; padding: 1.5rem; border-left: 4px solid var(--accent-green);">
                    <h4 style="color: var(--accent-green); margin-bottom: 1rem; display: flex; align-items: center; gap: 0.5rem;">
                        <span>🚫</span> Avantage 1 (Position: Haut-Gauche)
                    </h4>
                    
                    <div class="edit-field">
                        <label class="field-label" for="adv1-title">Titre avantage 1</label>
                        <input type="text" id="adv1-title" class="field-input" data-field="adv1-title" 
                               placeholder="ZÉRO INVESTISSEMENT INITIAL" value="ZÉRO INVESTISSEMENT INITIAL">
                    </div>
                    <div class="edit-field">
                        <label class="field-label" for="adv1-text">Description avantage 1</label>
                        <textarea id="adv1-text" class="field-input field-textarea" data-field="adv1-text" 
                                  placeholder="Pas de sortie de cash...">Pas de sortie de cash importante ! Préservez votre trésorerie pour votre cœur de métier. 150 $/mois c'est accessible à toutes les entreprises, même les plus petites. Déductible fiscalement comme charge d'exploitation.</textarea>
                    </div>
                </div>

                <div style="background: rgba(16, 185, 129, 0.08); border-radius: 12px; padding: 1.5rem; border-left: 4px solid var(--accent-green);">
                    <h4 style="color: var(--accent-green); margin-bottom: 1rem; display: flex; align-items: center; gap: 0.5rem;">
                        <span>🛡️</span> Avantage 2 (Position: Haut-Droite)
                    </h4>
                    
                    <div class="edit-field">
                        <label class="field-label" for="adv2-title">Titre avantage 2</label>
                        <input type="text" id="adv2-title" class="field-input" data-field="adv2-title" 
                               placeholder="RISQUE ZÉRO GARANTI" value="RISQUE ZÉRO GARANTI">
                    </div>
                    <div class="edit-field">
                        <label class="field-label" for="adv2-text">Description avantage 2</label>
                        <textarea id="adv2-text" class="field-input field-textarea" data-field="adv2-text" 
                                  placeholder="Panne ? Nous remplaçons...">Panne ? Nous remplaçons. Obsolescence ? Nous mettons à jour. Performance insuffisante ? Nous optimisons. Vous n'assumez JAMAIS aucun risque technique ou financier. EDS est responsable de TOUT.</textarea>
                    </div>
                </div>

                <!-- LIGNE 2 -->
                <div style="background: rgba(16, 185, 129, 0.08); border-radius: 12px; padding: 1.5rem; border-left: 4px solid var(--accent-green);">
                    <h4 style="color: var(--accent-green); margin-bottom: 1rem; display: flex; align-items: center; gap: 0.5rem;">
                        <span>📊</span> Avantage 3 (Position: Milieu-Gauche)
                    </h4>
                    
                    <div class="edit-field">
                        <label class="field-label" for="adv3-title">Titre avantage 3</label>
                        <input type="text" id="adv3-title" class="field-input" data-field="adv3-title" 
                               placeholder="MONITORING INTELLIGENT INCLUS" value="MONITORING INTELLIGENT INCLUS">
                    </div>
                    <div class="edit-field">
                        <label class="field-label" for="adv3-text">Description avantage 3</label>
                        <textarea id="adv3-text" class="field-input field-textarea" data-field="adv3-text" 
                                  placeholder="Surveillance 24/7 automatique...">Surveillance 24/7 automatique, alertes prédictives, rapports de performance mensuel. Vous savez toujours où vous en êtes. Optimisation continue de vos opérations grâce aux données IoT en temps réel.</textarea>
                    </div>
                </div>

                <div style="background: rgba(16, 185, 129, 0.08); border-radius: 12px; padding: 1.5rem; border-left: 4px solid var(--accent-green);">
                    <h4 style="color: var(--accent-green); margin-bottom: 1rem; display: flex; align-items: center; gap: 0.5rem;">
                        <span>💼</span> Avantage 4 (Position: Milieu-Droite)
                    </h4>
                    
                    <div class="edit-field">
                        <label class="field-label" for="adv4-title">Titre avantage 4</label>
                        <input type="text" id="adv4-title" class="field-input" data-field="adv4-title" 
                               placeholder="BUDGET PRÉVISIBLE" value="BUDGET PRÉVISIBLE">
                    </div>
                    <div class="edit-field">
                        <label class="field-label" for="adv4-text">Description avantage 4</label>
                        <textarea id="adv4-text" class="field-input field-textarea" data-field="adv4-text" 
                                  placeholder="Coût fixe mensuel...">Coût fixe mensuel, aucune surprise, aucun dépassement. Planification financière facilitée, comptabilité simplifiée. Pas de provisions pour maintenance, pas de budget remplacement à prévoir.</textarea>
                    </div>
                </div>

                <!-- LIGNE 3 -->
                <div style="background: rgba(16, 185, 129, 0.08); border-radius: 12px; padding: 1.5rem; border-left: 4px solid var(--accent-green);">
                    <h4 style="color: var(--accent-green); margin-bottom: 1rem; display: flex; align-items: center; gap: 0.5rem;">
                        <span>🔄</span> Avantage 5 (Position: Bas-Gauche)
                    </h4>
                    
                    <div class="edit-field">
                        <label class="field-label" for="adv5-title">Titre avantage 5</label>
                        <input type="text" id="adv5-title" class="field-input" data-field="adv5-title" 
                               placeholder="ÉVOLUTION TECHNOLOGIQUE" value="ÉVOLUTION TECHNOLOGIQUE">
                    </div>
                    <div class="edit-field">
                        <label class="field-label" for="adv5-text">Description avantage 5</label>
                        <textarea id="adv5-text" class="field-input field-textarea" data-field="adv5-text" 
                                  placeholder="Toujours la dernière version...">Toujours la dernière version ! Mises à jour logicielles automatiques, upgrade matériel inclus après 3 ans. Vous restez à la pointe sans effort ni investissement supplémentaire.</textarea>
                    </div>
                </div>

                <div style="background: rgba(16, 185, 129, 0.08); border-radius: 12px; padding: 1.5rem; border-left: 4px solid var(--accent-green);">
                    <h4 style="color: var(--accent-green); margin-bottom: 1rem; display: flex; align-items: center; gap: 0.5rem;">
                        <span>🏢</span> Avantage 6 (Position: Bas-Droite)
                    </h4>
                    
                    <div class="edit-field">
                        <label class="field-label" for="adv6-title">Titre avantage 6</label>
                        <input type="text" id="adv6-title" class="field-input" data-field="adv6-title" 
                               placeholder="FLEXIBILITÉ CONTRACTUELLE" value="FLEXIBILITÉ CONTRACTUELLE">
                    </div>
                    <div class="edit-field">
                        <label class="field-label" for="adv6-text">Description avantage 6</label>
                        <textarea id="adv6-text" class="field-input field-textarea" data-field="adv6-text" 
                                  placeholder="Contrats adaptés...">Contrats adaptés à vos besoins : court terme pour tests, long terme pour économies. Possibilité d'ajustement du parc, option d'achat privilégiée, résiliation facilitée.</textarea>
                    </div>
                </div>
            </div>
        </section>

        <!-- Section Contact et Location -->
        <section class="edit-section reorganizable-section" data-section-id="contact" data-section-order="5">
            <h2 class="section-title">
                <div class="section-header">
                    <div class="section-info">
                        <i class="fas fa-phone"></i>
                        Contact et Mise en Service
                    </div>
                    <div class="section-controls">
                        <button class="section-btn move-up" onclick="moveSectionUp('contact')" title="Monter la section">
                            <i class="fas fa-chevron-up"></i>
                        </button>
                        <button class="section-btn move-down" onclick="moveSectionDown('contact')" title="Descendre la section">
                            <i class="fas fa-chevron-down"></i>
                        </button>
                        <div class="section-spacer-control">
                            <label for="contactSpacing">Espacement (px):</label>
                            <input type="number" id="contactSpacing" class="section-spacing-input" data-field="comparisonContactSpacerHeight" 
                                   value="0" min="0" max="500" step="10">
                        </div>
                    </div>
                </div>
            </h2>
            <div class="edit-grid">
                <div class="edit-field">
                    <label class="field-label" for="contact-title">Titre section contact</label>
                    <p class="field-description">Appel à l'action pour louer</p>
                    <input type="text" id="contact-title" class="field-input" data-field="contact-title" 
                           placeholder="LOUEZ VOTRE Li-CUBE PRO™ MAINTENANT" value="LOUEZ VOTRE Li-CUBE PRO™ MAINTENANT">
                </div>

                <div class="edit-field">
                    <label class="field-label" for="contact-subtitle">Sous-titre contact</label>
                    <p class="field-description">Message de renforcement pour la location</p>
                    <textarea id="contact-subtitle" class="field-input field-textarea" data-field="contact-subtitle" 
                              placeholder="Zéro risque, zéro surprise...">Zéro risque, zéro surprise, performance maximale garantie</textarea>
                </div>

                <div class="edit-field">
                    <label class="field-label" for="rental-phone">Téléphone division location</label>
                    <p class="field-description">Numéro spécialisé pour les locations</p>
                    <input type="tel" id="rental-phone" class="field-input" data-field="rental-phone" 
                           placeholder="819-323-LOCA" value="819-323-LOCA">
                </div>

                <div class="edit-field">
                    <label class="field-label" for="rental-email">Email location</label>
                    <p class="field-description">Email spécialisé pour les demandes de location</p>
                    <input type="email" id="rental-email" class="field-input" data-field="rental-email" 
                           placeholder="location@edsquebec.com" value="location@edsquebec.com">
                </div>

                <div class="edit-field">
                    <label class="field-label" for="installation-time">Délai de mise en service</label>
                    <p class="field-description">Temps entre signature et installation</p>
                    <input type="text" id="installation-time" class="field-input" data-field="installation-time" 
                           placeholder="48h" value="48h">
                </div>

                <div class="edit-field">
                    <label class="field-label" for="rental-guarantees">Garanties location</label>
                    <p class="field-description">Liste des garanties offertes en location</p>
                    <textarea id="rental-guarantees" class="field-input field-textarea" data-field="rental-guarantees" 
                              placeholder="✅ Devis gratuit...">✅ Devis gratuit et sans engagement
✅ Installation par techniciens certifiés EDS
✅ Contrat flexible adapté à vos besoins
✅ Support québécois en français 24/7</textarea>
                </div>
            </div>
        </section>

        <!-- Section Comparaison Technique -->
        <section class="edit-section reorganizable-section" data-section-id="technical" data-section-order="4">
            <h2 class="section-title">
                <div class="section-header">
                    <div class="section-info">
                        <i class="fas fa-balance-scale"></i>
                        Comparaison Technique
                    </div>
                    <div class="section-controls">
                        <button class="section-btn move-up" onclick="moveSectionUp('technical')" title="Monter la section">
                            <i class="fas fa-chevron-up"></i>
                        </button>
                        <button class="section-btn move-down" onclick="moveSectionDown('technical')" title="Descendre la section">
                            <i class="fas fa-chevron-down"></i>
                        </button>
                        <div class="section-spacer-control">
                            <label for="technicalSpacing">Espacement (px):</label>
                            <input type="number" id="technicalSpacing" class="section-spacing-input" data-field="advantagesComparisonSpacerHeight" 
                                   value="0" min="0" max="500" step="10">
                        </div>
                    </div>
                </div>
            </h2>
            <div class="edit-grid">
                <!-- TITRES DE LA SECTION -->
                <div class="edit-field" style="grid-column: span 2; margin-bottom: 2rem;">
                    <label class="field-label" for="tech-title">Titre section comparaison</label>
                    <p class="field-description">Titre accrocheur pour la comparaison technique</p>
                    <input type="text" id="tech-title" class="field-input" data-field="tech-title" 
                           placeholder="Li-CUBE PRO™ vs BATTERIES Ni-Cd OBSOLÈTES" value="Li-CUBE PRO™ vs BATTERIES Ni-Cd OBSOLÈTES">
                </div>

                <div class="edit-field" style="grid-column: span 2; margin-bottom: 3rem;">
                    <label class="field-label" for="tech-subtitle">Sous-titre comparaison</label>
                    <p class="field-description">Explication de la supériorité technique</p>
                    <textarea id="tech-subtitle" class="field-input field-textarea" data-field="tech-subtitle" 
                              placeholder="Comparaison technique objective...">Comparaison technique objective : Pourquoi Li-CUBE PRO™ surclasse totalement les anciennes batteries Ni-Cd</textarea>
                </div>

                <!-- COMPARAISON EN 2 COLONNES (comme dans location.html) -->
                
                <!-- COLONNE GAUCHE : Faiblesses du Concurrent (❌) -->
                <div style="background: rgba(239, 68, 68, 0.08); border-radius: 12px; padding: 1.5rem; border-left: 4px solid var(--warning-red);">
                    <h3 style="color: var(--warning-red); margin-bottom: 1.5rem; display: flex; align-items: center; gap: 0.5rem;">
                        <span>❌</span> Batteries Ni-Cd (Obsolètes) - Colonne Gauche
                    </h3>
                    <div class="edit-grid">
                        <div class="edit-field">
                            <label class="field-label" for="weakness1-title">Faiblesse 1 - Titre</label>
                            <p class="field-description">Premier défaut majeur du concurrent</p>
                            <input type="text" id="weakness1-title" class="field-input" data-field="weakness1-title" 
                                   placeholder="Cadmium Hautement Toxique" value="Cadmium Hautement Toxique">
                        </div>
                        <div class="edit-field">
                            <label class="field-label" for="weakness1-desc">Faiblesse 1 - Description</label>
                            <p class="field-description">Description détaillée de la toxicité</p>
                            <textarea id="weakness1-desc" class="field-input field-textarea" data-field="weakness1-desc" 
                                      placeholder="Classé dangereux REACH...">Classé dangereux REACH, recyclage coûteux, manipulation à risque</textarea>
                        </div>
                        <div class="edit-field">
                            <label class="field-label" for="weakness2-title">Faiblesse 2 - Titre</label>
                            <p class="field-description">Second défaut critique</p>
                            <input type="text" id="weakness2-title" class="field-input" data-field="weakness2-title" 
                                   placeholder="Maintenance Obligatoire Coûteuse" value="Maintenance Obligatoire Coûteuse">
                        </div>
                        <div class="edit-field">
                            <label class="field-label" for="weakness2-desc">Faiblesse 2 - Description</label>
                            <p class="field-description">Description de la maintenance coûteuse</p>
                            <textarea id="weakness2-desc" class="field-input field-textarea" data-field="weakness2-desc" 
                                      placeholder="Appoint électrolyte, fuites KOH...">Appoint électrolyte, fuites KOH, interventions techniques fréquentes</textarea>
                        </div>
                        <div class="edit-field">
                            <label class="field-label" for="weakness3-title">Faiblesse 3 - Titre</label>
                            <p class="field-description">Troisième problème technique</p>
                            <input type="text" id="weakness3-title" class="field-input" data-field="weakness3-title" 
                                   placeholder="Durée de Vie Limitée" value="Durée de Vie Limitée">
                        </div>
                        <div class="edit-field">
                            <label class="field-label" for="weakness3-desc">Faiblesse 3 - Description</label>
                            <p class="field-description">Description de la durée de vie limitée</p>
                            <textarea id="weakness3-desc" class="field-input field-textarea" data-field="weakness3-desc" 
                                      placeholder="2000-3000 cycles seulement...">2000-3000 cycles seulement (5-6 ans) → remplacement fréquent</textarea>
                        </div>
                        <div class="edit-field">
                            <label class="field-label" for="weakness4-title">Faiblesse 4 - Titre</label>
                            <p class="field-description">Quatrième défaut structurel</p>
                            <input type="text" id="weakness4-title" class="field-input" data-field="weakness4-title" 
                                   placeholder="Poids et Encombrement" value="Poids et Encombrement">
                        </div>
                        <div class="edit-field">
                            <label class="field-label" for="weakness4-desc">Faiblesse 4 - Description</label>
                            <p class="field-description">Description du problème de poids</p>
                            <textarea id="weakness4-desc" class="field-input field-textarea" data-field="weakness4-desc" 
                                      placeholder="80-100 kg, manipulation dangereuse...">80-100 kg, manipulation dangereuse, installation contraignante</textarea>
                        </div>
                        <div class="edit-field">
                            <label class="field-label" for="weakness5-title">Faiblesse 5 - Titre</label>
                            <p class="field-description">Cinquième problème de charge</p>
                            <input type="text" id="weakness5-title" class="field-input" data-field="weakness5-title" 
                                   placeholder="Charge Lente 8-12h" value="Charge Lente 8-12h">
                        </div>
                        <div class="edit-field">
                            <label class="field-label" for="weakness5-desc">Faiblesse 5 - Description</label>
                            <p class="field-description">Description du problème de charge lente</p>
                            <textarea id="weakness5-desc" class="field-input field-textarea" data-field="weakness5-desc" 
                                      placeholder="Indisponibilité longue...">Indisponibilité longue, productivité réduite</textarea>
                        </div>
                        <div class="edit-field">
                            <label class="field-label" for="weakness6-title">Faiblesse 6 - Titre</label>
                            <p class="field-description">Sixième défaut de connectivité</p>
                            <input type="text" id="weakness6-title" class="field-input" data-field="weakness6-title" 
                                   placeholder="Aucune Connectivité" value="Aucune Connectivité">
                        </div>
                        <div class="edit-field">
                            <label class="field-label" for="weakness6-desc">Faiblesse 6 - Description</label>
                            <p class="field-description">Description du manque de connectivité</p>
                            <textarea id="weakness6-desc" class="field-input field-textarea" data-field="weakness6-desc" 
                                      placeholder="Pas de télémétrie...">Pas de télémétrie, aucun suivi à distance, pannes surprises</textarea>
                        </div>
                        <div class="edit-field">
                            <label class="field-label" for="weakness7">Faiblesse 7</label>
                            <p class="field-description">Septième problème technique</p>
                            <input type="text" id="weakness7-title" class="field-input" data-field="weakness7-title" 
                                   placeholder="Réglementation Transport Stricte" value="Réglementation Transport Stricte">
                            <textarea id="weakness7-desc" class="field-input field-textarea" data-field="weakness7-desc" 
                                      placeholder="Classé UN2795 Batteries Wet Alkali...">Classé UN2795 Batteries Wet Alkali, transport coûteux et contraignant</textarea>
                        </div>
                        <div class="edit-field">
                            <label class="field-label" for="weakness8">Faiblesse 8</label>
                            <p class="field-description">Huitième défaut de sécurité</p>
                            <input type="text" id="weakness8-title" class="field-input" data-field="weakness8-title" 
                                   placeholder="Effet Mémoire Dégradant" value="Effet Mémoire Dégradant">
                            <textarea id="weakness8-desc" class="field-input field-textarea" data-field="weakness8-desc" 
                                      placeholder="Perte capacité progressive...">Perte capacité progressive avec cycles partiels, performance décroissante</textarea>
                        </div>
                        <div class="edit-field">
                            <label class="field-label" for="weakness9">Faiblesse 9</label>
                            <p class="field-description">Neuvième problème d'entretien</p>
                            <input type="text" id="weakness9-title" class="field-input" data-field="weakness9-title" 
                                   placeholder="Profondeur Décharge Limitée" value="Profondeur Décharge Limitée">
                            <textarea id="weakness9-desc" class="field-input field-textarea" data-field="weakness9-desc" 
                                      placeholder="60% seulement exploitable...">60% seulement exploitable vs 96% Li-CUBE PRO™ → capacité réelle inférieure</textarea>
                        </div>
                        <div class="edit-field">
                            <label class="field-label" for="weakness10">Faiblesse 10</label>
                            <p class="field-description">Dixième défaut de fiabilité</p>
                            <input type="text" id="weakness10-title" class="field-input" data-field="weakness10-title" 
                                   placeholder="Location Plus Chère" value="Location Plus Chère">
                            <textarea id="weakness10-desc" class="field-input field-textarea" data-field="weakness10-desc" 
                                      placeholder="250$/mois vs 150-200$...">250$/mois vs 150-200$ Li-CUBE PRO™ → 25% plus cher sans maintenance incluse</textarea>
                        </div>
                        <div class="edit-field">
                            <label class="field-label" for="weakness11">Faiblesse 11</label>
                            <p class="field-description">Onzième problème technologique</p>
                            <input type="text" id="weakness11-title" class="field-input" data-field="weakness11-title" 
                                   placeholder="Remplacements Fréquents" value="Remplacements Fréquents">
                            <textarea id="weakness11-desc" class="field-input field-textarea" data-field="weakness11-desc" 
                                      placeholder="3 remplacements sur 20 ans...">3 remplacements sur 20 ans (4 unités au total) vs 0 pour Li-CUBE PRO™</textarea>
                        </div>
                    </div>
                </div>

                <!-- Section Avantages Produit Principal (vert) -->
                <div class="edit-section" style="background: rgba(16, 185, 129, 0.05); border-color: rgba(16, 185, 129, 0.2);">
                    <h3 style="color: var(--success-green); margin-bottom: 1rem;">
                        <i class="fas fa-check-circle"></i>
                        Avantages du Produit Principal
                    </h3>
                    <div class="edit-grid">
                        <div class="edit-field">
                            <label class="field-label" for="strength1-title">Avantage 1 - Titre</label>
                            <p class="field-description">Premier atout technique majeur</p>
                            <input type="text" id="strength1-title" class="field-input" data-field="strength1-title" 
                                   placeholder="Durée Vie Exceptionnelle" value="Durée Vie Exceptionnelle">
                        </div>
                        <div class="edit-field">
                            <label class="field-label" for="strength1-desc">Avantage 1 - Description</label>
                            <p class="field-description">Description de la durée de vie</p>
                            <textarea id="strength1-desc" class="field-input field-textarea" data-field="strength1-desc" 
                                      placeholder="≥8000 cycles...">≥8000 cycles (20-25 ans réels) → 4× plus longue que Ni-Cd</textarea>
                        </div>
                        <div class="edit-field">
                            <label class="field-label" for="strength2-title">Avantage 2 - Titre</label>
                            <p class="field-description">Deuxième supériorité technique</p>
                            <input type="text" id="strength2-title" class="field-input" data-field="strength2-title" 
                                   placeholder="Zéro Maintenance" value="Zéro Maintenance">
                        </div>
                        <div class="edit-field">
                            <label class="field-label" for="strength2-desc">Avantage 2 - Description</label>
                            <p class="field-description">Description maintenance nulle</p>
                            <textarea id="strength2-desc" class="field-input field-textarea" data-field="strength2-desc" 
                                      placeholder="Aucun électrolyte...">Aucun électrolyte, aucun effet mémoire, suivi automatisé par BMS</textarea>
                        </div>
                        <div class="edit-field">
                            <label class="field-label" for="strength3-title">Avantage 3 - Titre</label>
                            <p class="field-description">Troisième atout de monitoring</p>
                            <input type="text" id="strength3-title" class="field-input" data-field="strength3-title" 
                                   placeholder="Surveillance Temps Réel" value="Surveillance Temps Réel">
                        </div>
                        <div class="edit-field">
                            <label class="field-label" for="strength3-desc">Avantage 3 - Description</label>
                            <p class="field-description">Description surveillance temps réel</p>
                            <textarea id="strength3-desc" class="field-input field-textarea" data-field="strength3-desc" 
                                      placeholder="GPS, Bluetooth, Wi-Fi...">GPS, Bluetooth, Wi-Fi, GPRS → maintenance préventive, zéro panne surprise</textarea>
                        </div>
                        <div class="edit-field">
                            <label class="field-label" for="strength4-title">Avantage 4 - Titre</label>
                            <p class="field-description">Quatrième supériorité performance</p>
                            <input type="text" id="strength4-title" class="field-input" data-field="strength4-title" 
                                   placeholder="Performance Énergétique" value="Performance Énergétique">
                        </div>
                        <div class="edit-field">
                            <label class="field-label" for="strength4-desc">Avantage 4 - Description</label>
                            <p class="field-description">Description performance énergétique</p>
                            <textarea id="strength4-desc" class="field-input field-textarea" data-field="strength4-desc" 
                                      placeholder="110 Wh/kg (4× plus)...">110 Wh/kg (4× plus), 157 Wh/L (6× plus compact), charge 1-2h</textarea>
                        </div>
                        <div class="edit-field">
                            <label class="field-label" for="strength5-title">Avantage 5 - Titre</label>
                            <p class="field-description">Cinquième atout climatique</p>
                            <input type="text" id="strength5-title" class="field-input" data-field="strength5-title" 
                                   placeholder="Climat Canadien" value="Climat Canadien">
                        </div>
                        <div class="edit-field">
                            <label class="field-label" for="strength5-desc">Avantage 5 - Description</label>
                            <p class="field-description">Description résistance climat canadien</p>
                            <textarea id="strength5-desc" class="field-input field-textarea" data-field="strength5-desc" 
                                      placeholder="Fonctionnement -40°C à +55°C...">Fonctionnement -40°C à +55°C, BMS intelligent, hivers québécois</textarea>
                        </div>
                        <div class="edit-field">
                            <label class="field-label" for="strength6-title">Avantage 6 - Titre</label>
                            <p class="field-description">Sixième supériorité écologique</p>
                            <input type="text" id="strength6-title" class="field-input" data-field="strength6-title" 
                                   placeholder="100% Écologique" value="100% Écologique">
                        </div>
                        <div class="edit-field">
                            <label class="field-label" for="strength6-desc">Avantage 6 - Description</label>
                            <p class="field-description">Description aspect écologique</p>
                            <textarea id="strength6-desc" class="field-input field-textarea" data-field="strength6-desc" 
                                      placeholder="Zéro cadmium...">Zéro cadmium, conforme RoHS, recyclable, image environnementale</textarea>
                        </div>
                        <div class="edit-field">
                            <label class="field-label" for="strength7">Avantage 7</label>
                            <p class="field-description">Septième atout de rapidité</p>
                            <input type="text" id="strength7-title" class="field-input" data-field="strength7-title" 
                                   placeholder="Sécurité BMS Multi-niveau" value="Sécurité BMS Multi-niveau">
                            <textarea id="strength7-desc" class="field-input field-textarea" data-field="strength7-desc" 
                                      placeholder="Protections OVP, UVP, OCP...">Protections OVP, UVP, OCP, OTP, court-circuit → risques incidents réduits drastiquement</textarea>
                        </div>
                        <div class="edit-field">
                            <label class="field-label" for="strength8">Avantage 8</label>
                            <p class="field-description">Huitième supériorité sécuritaire</p>
                            <input type="text" id="strength8-title" class="field-input" data-field="strength8-title" 
                                   placeholder="Réduction Coûts Opérationnels" value="Réduction Coûts Opérationnels">
                            <textarea id="strength8-desc" class="field-input field-textarea" data-field="strength8-desc" 
                                      placeholder="Moins d'interventions...">Moins d'interventions, déplacements équipes réduits, fiabilité accrue</textarea>
                        </div>
                        <div class="edit-field">
                            <label class="field-label" for="strength9">Avantage 9</label>
                            <p class="field-description">Neuvième atout de simplicité</p>
                            <input type="text" id="strength9-title" class="field-input" data-field="strength9-title" 
                                   placeholder="Fabrication SAV Québec" value="Fabrication SAV Québec">
                            <textarea id="strength9-desc" class="field-input field-textarea" data-field="strength9-desc" 
                                      placeholder="Délais réduits, service local...">Délais réduits, service local français, réactivité pièces et support</textarea>
                        </div>
                        <div class="edit-field">
                            <label class="field-label" for="strength10">Avantage 10</label>
                            <p class="field-description">Dixième supériorité de fiabilité</p>
                            <input type="text" id="strength10-title" class="field-input" data-field="strength10-title" 
                                   placeholder="Installation Simplifiée" value="Installation Simplifiée">
                            <textarea id="strength10-desc" class="field-input field-textarea" data-field="strength10-desc" 
                                      placeholder="23 kg vs 80 kg...">23 kg vs 80 kg, boîtier compact acier, manutention sécurisée</textarea>
                        </div>
                        <div class="edit-field">
                            <label class="field-label" for="strength11">Avantage 11</label>
                            <p class="field-description">Onzième atout technologique</p>
                            <input type="text" id="strength11-title" class="field-input" data-field="strength11-title" 
                                   placeholder="Profondeur Décharge Optimale" value="Profondeur Décharge Optimale">
                            <textarea id="strength11-desc" class="field-input field-textarea" data-field="strength11-desc" 
                                      placeholder="96% exploitable vs 60% Ni-Cd...">96% exploitable vs 60% Ni-Cd → capacité réelle supérieure</textarea>
                        </div>
                        <div class="edit-field">
                            <label class="field-label" for="strength12">Avantage 12</label>
                            <p class="field-description">Douzième supériorité finale</p>
                            <input type="text" id="strength12-title" class="field-input" data-field="strength12-title" 
                                   placeholder="Location Flexible Avantageuse" value="Location Flexible Avantageuse">
                            <textarea id="strength12-desc" class="field-input field-textarea" data-field="strength12-desc" 
                                      placeholder="150-200$/mois vs 250$ Ni-Cd...">150-200$/mois vs 250$ Ni-Cd → plus économique avec maintenance incluse</textarea>
                        </div>
                    </div>
                </div>

                <!-- Conclusion comparative -->
                <div class="edit-field">
                    <label class="field-label" for="conclusion-title">Titre conclusion comparative</label>
                    <p class="field-description">Titre de la conclusion finale</p>
                    <input type="text" id="conclusion-title" class="field-input" data-field="conclusion-title" 
                           placeholder="RÉSULTAT : Li-CUBE PRO™ LOCATION = 25% PLUS ÉCONOMIQUE !" 
                           value="RÉSULTAT : Li-CUBE PRO™ LOCATION = 25% PLUS ÉCONOMIQUE !">
                </div>
                <div class="edit-field">
                    <label class="field-label" for="conclusion-text">Texte conclusion</label>
                    <p class="field-description">Explication détaillée de la supériorité économique</p>
                    <textarea id="conclusion-text" class="field-input field-textarea" data-field="conclusion-text" 
                              placeholder="Location Li-CUBE PRO™ 150-200$/mois vs Ni-Cd...">Location Li-CUBE PRO™ 150-200$/mois vs Ni-Cd 250$/mois + maintenance = minimum 25% d'économies + performance supérieure + zéro risque technique. Le choix rationnel est évident : Li-CUBE PRO™ domine sur TOUS les critères économiques, techniques et environnementaux.</textarea>
                </div>

                <!-- Conclusion technique intermédiaire -->
                <div class="edit-field">
                    <label class="field-label" for="tech-conclusion-title">Titre conclusion technique</label>
                    <p class="field-description">Conclusion dans la section comparaison technique</p>
                    <input type="text" id="tech-conclusion-title" class="field-input" data-field="tech-conclusion-title" 
                           placeholder="RÉSULTAT : Li-CUBE PRO™ LOCATION = 25% PLUS ÉCONOMIQUE !" 
                           value="RÉSULTAT : Li-CUBE PRO™ LOCATION = 25% PLUS ÉCONOMIQUE !">
                </div>
                <div class="edit-field">
                    <label class="field-label" for="tech-conclusion-text">Texte conclusion technique</label>
                    <p class="field-description">Conclusion intermédiaire dans la section technique</p>
                    <textarea id="tech-conclusion-text" class="field-input field-textarea" data-field="tech-conclusion-text" 
                              placeholder="TCO Location 20 ans..."><strong>TCO Location 20 ans :</strong> Li-CUBE PRO™ 48500$ (200$/mois) vs Ni-Cd 60000$ → <strong>20% d'économies + maintenance incluse !</strong><br>
<strong>Zéro risque technique</strong> (EDS assume tout), <strong>monitoring 24/7 inclus</strong>, <strong>remplacement immédiat</strong> si panne.<br>
Location Li-CUBE PRO™ = <strong>La tranquillité absolue</strong> avec technologie de pointe et budget maîtrisé.</textarea>
                </div>
            </div>
        </section>

        <!-- Section Conclusion et Appel à l'Action -->
        <section class="edit-section reorganizable-section" data-section-id="conclusion-action" data-section-order="6">
            <h2 class="section-title">
                <div class="section-header">
                    <div class="section-info">
                        <i class="fas fa-flag-checkered"></i>
                        Conclusion et Appel à l'Action Final
                    </div>
                    <div class="section-controls">
                        <button class="section-btn move-up" onclick="moveSectionUp('conclusion-action')" title="Monter la section">
                            <i class="fas fa-chevron-up"></i>
                        </button>
                        <button class="section-btn move-down" onclick="moveSectionDown('conclusion-action')" title="Descendre la section">
                            <i class="fas fa-chevron-down"></i>
                        </button>
                        <div class="section-spacer-control">
                            <label for="conclusionActionSpacing">Espacement (px):</label>
                            <input type="number" id="conclusionActionSpacing" class="section-spacing-input" data-field="conclusionActionSpacerHeight" 
                                   value="0" min="0" max="500" step="10">
                        </div>
                    </div>
                </div>
            </h2>
            <div class="edit-grid">
                <div class="edit-field">
                    <label class="field-label" for="final-title">Titre conclusion finale</label>
                    <p class="field-description">Message final percutant</p>
                    <input type="text" id="final-title" class="field-input" data-field="final-title" 
                           placeholder="LE CHOIX EST ÉVIDENT" value="LE CHOIX EST ÉVIDENT">
                </div>

                <div class="edit-field">
                    <label class="field-label" for="final-message">Message conclusion</label>
                    <p class="field-description">Résumé des bénéfices décisifs</p>
                    <textarea id="final-message" class="field-input field-textarea" data-field="final-message" 
                              placeholder="Pourquoi risquer avec des technologies obsolètes...">Pourquoi risquer avec des technologies obsolètes ? Li-CUBE PRO™ en location vous offre le meilleur des deux mondes : technologie de pointe + risque zéro. Pendant que vos concurrents subissent pannes et remplacements, vous fonctionnez sereinement.</textarea>
                </div>

                <div class="edit-field">
                    <label class="field-label" for="urgency-message">Message d'urgence</label>
                    <p class="field-description">Incitation à l'action immédiate</p>
                    <input type="text" id="urgency-message" class="field-input" data-field="urgency-message" 
                           placeholder="NE LAISSEZ PAS LA CONCURRENCE PRENDRE L'AVANTAGE !" value="NE LAISSEZ PAS LA CONCURRENCE PRENDRE L'AVANTAGE !">
                </div>

                <div class="edit-field">
                    <label class="field-label" for="cta-final">Appel à l'action final</label>
                    <p class="field-description">Demande d'action concrète</p>
                    <textarea id="cta-final" class="field-input field-textarea" data-field="cta-final" 
                              placeholder="Appelez maintenant...">Appelez maintenant 819-323-LOCA ou écrivez à location@edsquebec.com
Votre devis personnalisé sous 24h, installation sous 48h.
L'énergie fiable, c'est maintenant ou jamais !</textarea>
                </div>

                <div class="edit-field">
                    <label class="field-label" for="signature">Signature EDS</label>
                    <p class="field-description">Signature professionnelle finale</p>
                    <textarea id="signature" class="field-input field-textarea" data-field="signature" 
                              placeholder="EDS Québec - Votre partenaire énergétique...">EDS Québec - Votre partenaire énergétique depuis plus de 25 ans
Solutions Batteries Lithium Li-CUBE PRO™
Fabrication et Support 100% Québécois</textarea>
                </div>
            </div>
        </section>

        <!-- Section Conclusion Comparative -->
        <section class="edit-section reorganizable-section" data-section-id="conclusion-comparative" data-section-order="7">
            <h2 class="section-title">
                <div class="section-header">
                    <div class="section-info">
                        <i class="fas fa-trophy"></i>
                        Conclusion Finale Comparative
                    </div>
                    <div class="section-controls">
                        <button class="section-btn move-up" onclick="moveSectionUp('conclusion-comparative')" title="Monter la section">
                            <i class="fas fa-chevron-up"></i>
                        </button>
                        <button class="section-btn move-down" onclick="moveSectionDown('conclusion-comparative')" title="Descendre la section">
                            <i class="fas fa-chevron-down"></i>
                        </button>
                        <div class="section-spacer-control">
                            <label for="conclusionComparativeSpacing">Espacement (px):</label>
                            <input type="number" id="conclusionComparativeSpacing" class="section-spacing-input" data-field="conclusionComparativeSpacerHeight" 
                                   value="0" min="0" max="500" step="10">
                        </div>
                    </div>
                </div>
            </h2>
            <div class="edit-grid">
                <div class="edit-field">
                    <label class="field-label" for="conclusion-title">Titre conclusion comparative</label>
                    <p class="field-description">Titre de la conclusion finale</p>
                    <input type="text" id="conclusion-title" class="field-input" data-field="conclusion-title" 
                           placeholder="RÉSULTAT : Li-CUBE PRO™ LOCATION = 25% PLUS ÉCONOMIQUE !" 
                           value="RÉSULTAT : Li-CUBE PRO™ LOCATION = 25% PLUS ÉCONOMIQUE !">
                </div>

                <div class="edit-field">
                    <label class="field-label" for="conclusion-text">Texte conclusion</label>
                    <p class="field-description">Explication détaillée de la supériorité économique</p>
                    <textarea id="conclusion-text" class="field-input field-textarea" data-field="conclusion-text" 
                              placeholder="Location Li-CUBE PRO™ 150-200$/mois vs Ni-Cd...">Location Li-CUBE PRO™ 150-200$/mois vs Ni-Cd 250$/mois + maintenance = minimum 25% d'économies + performance supérieure + zéro risque technique. Le choix rationnel est évident : Li-CUBE PRO™ domine sur TOUS les critères économiques, techniques et environnementaux.</textarea>
                </div>

                <div class="edit-field">
                    <label class="field-label" for="contact-title">Titre section contact final</label>
                    <p class="field-description">Titre de la section contact finale</p>
                    <input type="text" id="contact-title" class="field-input" data-field="contact-title" 
                           placeholder="CLOSING - ARGUMENTS FINAUX LOCATION" value="CLOSING - ARGUMENTS FINAUX LOCATION">
                </div>

                <div class="edit-field">
                    <label class="field-label" for="contact-subtitle">Sous-titre contact final</label>
                    <p class="field-description">Message de renforcement final</p>
                    <textarea id="contact-subtitle" class="field-input field-textarea" data-field="contact-subtitle" 
                              placeholder="Votre équipe commerciale dispose maintenant...">Votre équipe commerciale dispose maintenant de TOUS les arguments techniques et économiques pour conclure la location Li-CUBE PRO™</textarea>
                </div>

                <!-- Boutons d'action finaux -->
                <div class="edit-field">
                    <label class="field-label" for="btn-phone-text">Texte bouton téléphone</label>
                    <p class="field-description">Texte du bouton d'action téléphone</p>
                    <input type="text" id="btn-phone-text" class="field-input" data-field="btn-phone-text" 
                           placeholder="CONCLURE LA VENTE" value="CONCLURE LA VENTE">
                </div>

                <div class="edit-field">
                    <label class="field-label" for="btn-email-text">Texte bouton email</label>
                    <p class="field-description">Texte du bouton d'action email</p>
                    <input type="text" id="btn-email-text" class="field-input" data-field="btn-email-text" 
                           placeholder="PRÉPARER CONTRAT" value="PRÉPARER CONTRAT">
                </div>

                <div class="edit-field">
                    <label class="field-label" for="phone-number">Numéro de téléphone</label>
                    <p class="field-description">Numéro de téléphone pour le bouton d'action</p>
                    <input type="tel" id="phone-number" class="field-input" data-field="phone-number" 
                           placeholder="8193235622" value="8193235622">
                </div>

                <div class="edit-field">
                    <label class="field-label" for="email-address">Adresse email</label>
                    <p class="field-description">Adresse email pour le bouton d'action</p>
                    <input type="email" id="email-address" class="field-input" data-field="email-address" 
                           placeholder="location@edsquebec.com" value="location@edsquebec.com">
                </div>
            </div>
        </section>

    </main>

    <!-- Statut de synchronisation automatique -->
    <footer class="editor-actions">
        <div class="actions-content">
            <div class="sync-status">
                <i class="fas fa-sync status-icon" id="syncStatusIcon"></i>
                <span id="syncStatusText">Synchronisation LOCATION automatique activée</span>
            </div>
            <div class="sync-info">
                <span class="live-indicator">🔴 EN DIRECT</span>
                <span class="sync-counter" id="syncCounter">0 modifications synchronisées</span>
            </div>
        </div>
    </footer>

    <!-- Système de Synchronisation Instantanée - DOIT SE CHARGER EN PREMIER -->
    <script src="js/instant-sync.js"></script>

    <script>
        // Interface Éditeur LOCATION - Synchronisation Instantanée
        document.addEventListener('DOMContentLoaded', function() {
            console.log('✅ Éditeur LOCATION avec Synchronisation Instantanée activé');
            
            // Attente : initialisation complète d'InstantSync
            function waitForInstantSync(callback) {
                if (window.instantSync && window.instantSync.isInitialized) {
                    callback();
                } else {
                    console.log('⏳ Attente initialisation InstantSync...');
                    setTimeout(() => waitForInstantSync(callback), 100);
                }
            }
            
            // Fonction : synchronisation manuelle + ouverture de la page de présentation
            window.togglePreview = function() {
                console.log('🔄 Prévisualisation LOCATION - Déclenchement synchronisation manuelle...');
                
                waitForInstantSync(() => {
                    // Déclenchement : synchronisation manuelle immédiate
                    if (window.instantSync) {
                        // Force : synchronisation complète avant prévisualisation
                        window.instantSync.executeInstantSync(true); // true = forcer sync complète
                        console.log('✅ Synchronisation manuelle LOCATION terminée');
                        
                        // Ouverture : page de présentation après synchronisation
                        setTimeout(() => {
                            window.open('location.html', '_blank', 'width=1200,height=800,scrollbars=yes,resizable=yes');
                            console.log('👁️ Page de présentation LOCATION ouverte');
                        }, 200); // Délai pour assurer la synchronisation
                    } else {
                        console.error('❌ InstantSync non disponible pour synchronisation manuelle');
                        // Ouverture sans sync en cas d'échec
                        window.open('location.html', '_blank', 'width=1200,height=800,scrollbars=yes,resizable=yes');
                    }
                });
            };
            
            // Validation : formats email et téléphone
            setupFieldValidation();
            
            // Raccourci : Ctrl+P pour prévisualisation
            document.addEventListener('keydown', function(event) {
                if (event.ctrlKey && event.key === 'p') {
                    event.preventDefault();
                    togglePreview();
                }
            });
            
            console.log('🎯 Éditeur LOCATION - Prêt pour synchronisation instantanée');
        });

        // Validation : contrôles de format pour les champs spéciaux
        function setupFieldValidation() {
            const emailFields = document.querySelectorAll('input[type="email"]');
            const telFields = document.querySelectorAll('input[type="tel"]');
            
            emailFields.forEach(field => {
                field.addEventListener('blur', function() {
                    if (this.value && !isValidEmail(this.value)) {
                        this.style.borderColor = '#EF4444';
                        this.title = 'Format d\'email invalide';
                    } else {
                        this.style.borderColor = '';
                        this.title = '';
                    }
                });
            });
            
            telFields.forEach(field => {
                field.addEventListener('blur', function() {
                    if (this.value && !isValidPhone(this.value)) {
                        this.style.borderColor = '#EF4444';
                        this.title = 'Format de téléphone invalide';
                    } else {
                        this.style.borderColor = '';
                        this.title = '';
                    }
                });
            });
        }

        // Utilitaires : validation des formats
        function isValidEmail(email) {
            const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
            return emailRegex.test(email);
        }

        function isValidPhone(phone) {
            const phoneRegex = /^(\+1[-.\s]?)?(\(?[0-9]{3}\)?[-.\s]?)?[0-9]{3}[-.\s]?[0-9]{4}$/;
            return phoneRegex.test(phone);
        }
    </script>
    
    <!-- Script Éditeur CSS Complet -->
    <script>
        // Variables CSS pour location.html - Extraites du thème de location
        const defaultValues = {
            // Couleurs Principales de location.html
            primaryDark: '#0F172A',
            secondaryDark: '#1E293B', 
            accentGreen: '#10B981',
            accentBlue: '#3B82F6',
            accentTeal: '#14B8A6',
            successGreen: '#059669',
            warningOrange: '#F59E0B',
            
            // Couleurs de Texte location.html
            textWhite: '#F8FAFC',
            textGray: '#CBD5E1',
            
            // Couleurs d'État et Complémentaires
            warningRed: '#EF4444',
            infoBlue: '#60A5FA',
            neutralGray: '#9CA3AF',
            
            // Navigation
            navTitleSize: 28,
            navTitleWeight: '800',
            navItemSize: 16,
            navPadding: 12,
            
            // Espacements entre sections
            headerSpacerHeight: 80,
            heroArgumentsSpacerHeight: 0,
            heroPricingSpacerHeight: 0,
            pricingAdvantagesSpacerHeight: 0,
            advantagesComparisonSpacerHeight: 0,
            comparisonContactSpacerHeight: 0,
            conclusionActionSpacerHeight: 0,
            conclusionComparativeSpacerHeight: 0,
            
            // Hero Section
            heroTitleSize: 72,
            heroHighlightSize: 80,
            heroSubtitleSize: 22,
            heroTitleWeight: '900',
            
            // Prix Banner
            priceMainSize: 56,
            priceSubSize: 18,
            pricePadding: 24,
            
            // Section Titles
            sectionTitleSize: 56,
            sectionTitleWeight: '800',
            
            // Cards et Benefits
            cardPadding: 28,
            cardBorderRadius: 16,
            benefitIconSize: 40,
            benefitTitleSize: 18,
            benefitTextSize: 14,
            
            // Pricing Cards
            pricingCardPadding: 40,
            pricingValueSize: 48,
            pricingDurationSize: 18,
            
            // CTA Buttons
            ctaFontSize: 19,
            ctaFontWeight: '700',
            ctaPadding: 19,
            
            // Spacing Global
            sectionPadding: 64,
            containerMaxWidth: 1400,
            gridGap: 32,
            
            // Rôle : Chemins d'images pour la comparaison de produits
            // Type : string (chemin relatif vers fichier image)
            // Domaine : chemins valides vers images (.png, .jpg, .jpeg, .webp, .svg)
            // Usage : Synchronisation temps réel des images entre éditeur et présentation
            'product-image-path': './images/Li-CUBE PRO.png',
            'competitor-image-path': './images/concurrent.png',
            'vs-element-text': 'VS',
            
            // Chemin logo (déjà géré mais ajouté pour cohérence)
            'logo-path': './images/logo edsquebec.png'
        };

        // Fonction de basculement de l'éditeur
        function toggleCSSEditor() {
            const editor = document.getElementById('cssEditor');
            const toggle = document.querySelector('.css-toggle i');
            
            if (editor.classList.contains('collapsed')) {
                editor.classList.remove('collapsed');
                toggle.className = 'fas fa-chevron-up';
            } else {
                editor.classList.add('collapsed');
                toggle.className = 'fas fa-chevron-down';
            }
        }

        // Application des styles en temps réel pour location.html ET edit-location.html
        function applyStyles() {
            // Collecte de tous les styles actuels
            const currentStyles = {};
            Object.keys(defaultValues).forEach(key => {
                const element = document.getElementById(key);
                if (element) currentStyles[key] = element.value;
            });
            
            // Application des styles à la page d'édition elle-même
            if (typeof applyDynamicCSSToEditPage === 'function') {
                applyDynamicCSSToEditPage(currentStyles);
            }
            
            console.log('🎨 Styles appliqués à la page d\'édition en temps réel');
        }

        // Mise à jour des affichages de valeurs pour location.html
        function updateValueDisplays() {
            // Navigation
            if (document.getElementById('navTitleSizeValue')) {
                document.getElementById('navTitleSizeValue').textContent = document.getElementById('navTitleSize').value + 'px';
            }
            if (document.getElementById('navItemSizeValue')) {
                document.getElementById('navItemSizeValue').textContent = document.getElementById('navItemSize').value + 'px';
            }
            if (document.getElementById('navPaddingValue')) {
                document.getElementById('navPaddingValue').textContent = document.getElementById('navPadding').value + 'px';
            }
            
            // Hero Section
            if (document.getElementById('heroTitleSizeValue')) {
                document.getElementById('heroTitleSizeValue').textContent = document.getElementById('heroTitleSize').value + 'px';
            }
            if (document.getElementById('heroHighlightSizeValue')) {
                document.getElementById('heroHighlightSizeValue').textContent = document.getElementById('heroHighlightSize').value + 'px';
            }
            if (document.getElementById('heroSubtitleSizeValue')) {
                document.getElementById('heroSubtitleSizeValue').textContent = document.getElementById('heroSubtitleSize').value + 'px';
            }
            
            // Prix Banner
            if (document.getElementById('priceMainSizeValue')) {
                document.getElementById('priceMainSizeValue').textContent = document.getElementById('priceMainSize').value + 'px';
            }
            if (document.getElementById('priceSubSizeValue')) {
                document.getElementById('priceSubSizeValue').textContent = document.getElementById('priceSubSize').value + 'px';
            }
            if (document.getElementById('pricePaddingValue')) {
                document.getElementById('pricePaddingValue').textContent = document.getElementById('pricePadding').value + 'px';
            }
            
            // Section Titles
            if (document.getElementById('sectionTitleSizeValue')) {
                document.getElementById('sectionTitleSizeValue').textContent = document.getElementById('sectionTitleSize').value + 'px';
            }
            
            // Cards et Benefits
            if (document.getElementById('cardPaddingValue')) {
                document.getElementById('cardPaddingValue').textContent = document.getElementById('cardPadding').value + 'px';
            }
            if (document.getElementById('cardBorderRadiusValue')) {
                document.getElementById('cardBorderRadiusValue').textContent = document.getElementById('cardBorderRadius').value + 'px';
            }
            if (document.getElementById('benefitIconSizeValue')) {
                document.getElementById('benefitIconSizeValue').textContent = document.getElementById('benefitIconSize').value + 'px';
            }
            if (document.getElementById('benefitTitleSizeValue')) {
                document.getElementById('benefitTitleSizeValue').textContent = document.getElementById('benefitTitleSize').value + 'px';
            }
            if (document.getElementById('benefitTextSizeValue')) {
                document.getElementById('benefitTextSizeValue').textContent = document.getElementById('benefitTextSize').value + 'px';
            }
            
            // Pricing Cards
            if (document.getElementById('pricingCardPaddingValue')) {
                document.getElementById('pricingCardPaddingValue').textContent = document.getElementById('pricingCardPadding').value + 'px';
            }
            if (document.getElementById('pricingValueSizeValue')) {
                document.getElementById('pricingValueSizeValue').textContent = document.getElementById('pricingValueSize').value + 'px';
            }
            if (document.getElementById('pricingDurationSizeValue')) {
                document.getElementById('pricingDurationSizeValue').textContent = document.getElementById('pricingDurationSize').value + 'px';
            }
            
            // CTA Buttons
            if (document.getElementById('ctaFontSizeValue')) {
                document.getElementById('ctaFontSizeValue').textContent = document.getElementById('ctaFontSize').value + 'px';
            }
            if (document.getElementById('ctaPaddingValue')) {
                document.getElementById('ctaPaddingValue').textContent = document.getElementById('ctaPadding').value + 'px';
            }
            
            // Spacing Global
            if (document.getElementById('sectionPaddingValue')) {
                document.getElementById('sectionPaddingValue').textContent = document.getElementById('sectionPadding').value + 'px';
            }
            if (document.getElementById('containerMaxWidthValue')) {
                document.getElementById('containerMaxWidthValue').textContent = document.getElementById('containerMaxWidth').value + 'px';
            }
            if (document.getElementById('gridGapValue')) {
                document.getElementById('gridGapValue').textContent = document.getElementById('gridGap').value + 'px';
            }
        }

        // Réinitialisation depuis le backup
        function resetCSS() {
            const backup = localStorage.getItem('locationVS-css-backup');
            let stylesToReset = backup ? JSON.parse(backup) : defaultValues;
            
            Object.entries(stylesToReset).forEach(([key, value]) => {
                const element = document.getElementById(key);
                if (element) element.value = value;
            });
            updateValueDisplays();
            applyStyles();
            
            // ✅ AJOUT : Synchronisation temps réel vers location.html
            syncToPresentation();
            
            // Notification
            showNotification('Styles réinitialisés avec effet temps réel !', 'warning');
        }

        // Sauvegarde avec popup de validation
        function saveCSS() {
            // Popup de validation moderne
            showSaveConfirmation(() => {
                const styles = {};
                Object.keys(defaultValues).forEach(key => {
                    const element = document.getElementById(key);
                    if (element) styles[key] = element.value;
                });
                
                // Écrasement du backup de réinitialisation
                localStorage.setItem('locationVS-css-backup', JSON.stringify(styles));
                showNotification('Nouveau point de sauvegarde créé !', 'success');
            });
        }
        
        // Popup de confirmation moderne
        function showSaveConfirmation(onConfirm) {
            const overlay = document.createElement('div');
            overlay.style.cssText = `
                position: fixed; top: 0; left: 0; width: 100%; height: 100%;
                background: rgba(0, 0, 0, 0.7); z-index: 10000;
                display: flex; align-items: center; justify-content: center;
                opacity: 0; transition: opacity 0.3s ease;
            `;
            
            const popup = document.createElement('div');
            popup.style.cssText = `
                background: linear-gradient(135deg, #1e293b, #334155);
                padding: 2rem; border-radius: 12px; text-align: center;
                max-width: 400px; width: 90%; box-shadow: 0 20px 40px rgba(0,0,0,0.3);
                border: 1px solid rgba(255,255,255,0.1); transform: scale(0.8);
                transition: transform 0.3s ease;
            `;
            
            popup.innerHTML = `
                <div style="margin-bottom: 1.5rem;">
                    <i class="fas fa-save" style="font-size: 3rem; color: #28a745; margin-bottom: 1rem;"></i>
                    <h3 style="color: white; margin: 0 0 0.5rem 0; font-size: 1.3rem;">Créer un nouveau point de sauvegarde</h3>
                    <p style="color: #cbd5e1; margin: 0; font-size: 0.9rem;">Cette action remplacera votre point de restauration actuel. Êtes-vous sûr ?</p>
                </div>
                <div style="display: flex; gap: 1rem; justify-content: center;">
                    <button class="popup-btn cancel" style="
                        padding: 0.8rem 1.5rem; border: none; border-radius: 6px;
                        background: #6b7280; color: white; cursor: pointer;
                        font-weight: 600; transition: all 0.3s ease;
                    ">Annuler</button>
                    <button class="popup-btn confirm" style="
                        padding: 0.8rem 1.5rem; border: none; border-radius: 6px;
                        background: #28a745; color: white; cursor: pointer;
                        font-weight: 600; transition: all 0.3s ease;
                    ">Confirmer</button>
                </div>
            `;
            
            overlay.appendChild(popup);
            document.body.appendChild(overlay);
            
            // Animation d'entrée
            setTimeout(() => {
                overlay.style.opacity = '1';
                popup.style.transform = 'scale(1)';
            }, 10);
            
            // Gestion des clics
            popup.querySelector('.cancel').onclick = () => closePopup(overlay);
            popup.querySelector('.confirm').onclick = () => {
                onConfirm();
                closePopup(overlay);
            };
            
            // Fermeture par clic extérieur
            overlay.onclick = (e) => {
                if (e.target === overlay) closePopup(overlay);
            };
            
            // Hover effects
            popup.querySelectorAll('.popup-btn').forEach(btn => {
                btn.onmouseenter = () => btn.style.transform = 'translateY(-2px)';
                btn.onmouseleave = () => btn.style.transform = 'translateY(0)';
            });
        }
        
        function closePopup(overlay) {
            overlay.style.opacity = '0';
            overlay.querySelector('div').style.transform = 'scale(0.8)';
            setTimeout(() => overlay.remove(), 300);
        }

        // Import CSS
        function importCSS() {
            const input = document.createElement('input');
            input.type = 'file';
            input.accept = '.json,.css';
            
            input.onchange = function(event) {
                const file = event.target.files[0];
                if (!file) return;
                
                const reader = new FileReader();
                reader.onload = function(e) {
                    try {
                        let styles;
                        
                        // Tentative de lecture JSON
                        if (file.name.endsWith('.json')) {
                            styles = JSON.parse(e.target.result);
                        } else {
                            // Pour les fichiers CSS, extraction basique des valeurs
                            showNotification('Import CSS direct non supporté, utilisez JSON', 'error');
                            return;
                        }
                        
                        // Application des styles importés
                        Object.entries(styles).forEach(([key, value]) => {
                            const element = document.getElementById(key);
                            if (element && defaultValues.hasOwnProperty(key)) {
                                element.value = value;
                            }
                        });
                        
                        updateValueDisplays();
                        applyStyles();
                        showNotification('Styles importés avec succès', 'success');
                        
                    } catch (error) {
                        showNotification('Erreur lors de l\'import: ' + error.message, 'error');
                    }
                };
                reader.readAsText(file);
            };
            
            input.click();
        }

        // Export CSS
        function exportCSS() {
            const styles = {};
            Object.keys(defaultValues).forEach(key => {
                const element = document.getElementById(key);
                if (element) styles[key] = element.value;
            });
            
            // Export JSON pour réimport facile
            const jsonBlob = new Blob([JSON.stringify(styles, null, 2)], { type: 'application/json' });
            const jsonUrl = URL.createObjectURL(jsonBlob);
            const jsonLink = document.createElement('a');
            jsonLink.href = jsonUrl;
            jsonLink.download = 'locationVS-custom-styles.json';
            jsonLink.click();
            URL.revokeObjectURL(jsonUrl);
            
            showNotification('Styles exportés (JSON)', 'success');
        }

        // Notification simple
        function showNotification(message, type) {
            const notification = document.createElement('div');
            notification.style.cssText = `
                position: fixed; top: 20px; right: 20px; z-index: 9999;
                background: ${type === 'success' ? '#28a745' : type === 'warning' ? '#ffc107' : '#dc3545'};
                color: white; padding: 12px 20px; border-radius: 6px;
                font-weight: 600; transform: translateX(100%);
                transition: transform 0.3s ease;
            `;
            notification.textContent = message;
            
            document.body.appendChild(notification);
            setTimeout(() => notification.style.transform = 'translateX(0)', 100);
            setTimeout(() => {
                notification.style.transform = 'translateX(100%)';
                setTimeout(() => notification.remove(), 300);
            }, 3000);
        }

        // Chargement des styles sauvegardés
        function loadSavedStyles() {
            const saved = localStorage.getItem('locationVS-custom-css');
            if (saved) {
                const styles = JSON.parse(saved);
                Object.entries(styles).forEach(([key, value]) => {
                    const element = document.getElementById(key);
                    if (element) element.value = value;
                });
                updateValueDisplays();
                applyStyles();
            }
        }

        // Création du backup automatique initial
        function createInitialBackup() {
            const existingBackup = localStorage.getItem('locationVS-css-backup');
            if (!existingBackup) {
                // Premier lancement : créer backup avec valeurs par défaut
                localStorage.setItem('locationVS-css-backup', JSON.stringify(defaultValues));
                console.log('🔄 Backup automatique initial créé');
            }
        }

        // Synchronisation temps réel avec location.html
        function syncToPresentation() {
            // Collecte de tous les styles actuels pour location.html
            const currentStyles = {};
            Object.keys(defaultValues).forEach(key => {
                const element = document.getElementById(key);
                if (element) currentStyles[key] = element.value;
            });
            
            // Création du CSS dynamique pour location.html
            const locationCSS = generateLocationCSS(currentStyles);
            
            // Sauvegarde temporaire pour sync temps réel
            localStorage.setItem('locationVS-live-styles', JSON.stringify(currentStyles));
            localStorage.setItem('locationVS-dynamic-css', locationCSS);
            
            // Si InstantSync est disponible, l'utiliser pour sync immédiate
            if (window.instantSync) {
                try {
                    window.instantSync.executeInstantSync(false); // sync non forcée
                    console.log('🔄 Styles synchronisés avec location.html');
                } catch (error) {
                    console.warn('⚠️ Synchronisation InstantSync échouée:', error);
                }
            }
            
            // Tentative de communication direct avec onglets ouverts (location.html)
            try {
                const message = {
                    type: 'LOCATION_CSS_UPDATE',
                    styles: currentStyles,
                    css: locationCSS,
                    timestamp: Date.now()
                };
                
                // Broadcast vers tous les onglets via localStorage event
                localStorage.setItem('locationVS-css-broadcast', JSON.stringify(message));
                setTimeout(() => localStorage.removeItem('locationVS-css-broadcast'), 100);
                
                // Application immédiate des styles à la page d'édition elle-même
                if (typeof applyDynamicCSSToEditPage === 'function') {
                    applyDynamicCSSToEditPage(currentStyles);
                }
                
                console.log('📡 Styles diffusés vers location.html et appliqués à la page d\'édition');
            } catch (error) {
                console.warn('⚠️ Diffusion échouée:', error);
            }
        }
        
        // Génération du CSS dynamique pour location.html
        function generateLocationCSS(styles) {
            return `
                /* CSS Dynamique pour location.html généré depuis edit-location.html */
                :root {
                    --primary-dark: ${styles.primaryDark};
                    --secondary-dark: ${styles.secondaryDark};
                    --accent-green: ${styles.accentGreen};
                    --accent-blue: ${styles.accentBlue};
                    --accent-teal: ${styles.accentTeal};
                    --success-green: ${styles.successGreen};
                    --warning-orange: ${styles.warningOrange};
                    --text-white: ${styles.textWhite};
                    --text-gray: ${styles.textGray};
                    --warning-red: ${styles.warningRed};
                    --info-blue: ${styles.infoBlue};
                    --neutral-gray: ${styles.neutralGray};
                }
                
                /* Navigation */
                .nav-title {
                    font-size: ${styles.navTitleSize}px !important;
                    font-weight: ${styles.navTitleWeight} !important;
                }
                .nav-item {
                    font-size: ${styles.navItemSize}px !important;
                    padding: ${styles.navPadding}px ${styles.navPadding * 1.5}px !important;
                }
                
                /* Espacements entre Sections - Logique restaurée fonctionnelle */
                .header-spacer[data-field="heroSpacerHeight"] {
                    height: ${styles.headerSpacerHeight}px !important;
                }
                .section-spacer[data-field="hero-pricing-spacer"] {
                    height: ${styles.heroPricingSpacerHeight}px !important;
                }
                .section-spacer[data-field="pricing-advantages-spacer"] {
                    height: ${styles.pricingAdvantagesSpacerHeight}px !important;
                }
                .section-spacer[data-field="advantages-comparison-spacer"] {
                    height: ${styles.advantagesComparisonSpacerHeight}px !important;
                }
                .section-spacer[data-field="comparison-contact-spacer"] {
                    height: ${styles.comparisonContactSpacerHeight}px !important;
                }
                
                /* Hero Section */
                .hero-text h1 {
                    font-size: ${styles.heroTitleSize}px !important;
                    font-weight: ${styles.heroTitleWeight} !important;
                }
                .hero-highlight {
                    font-size: ${styles.heroHighlightSize}px !important;
                }
                .hero-subtitle {
                    font-size: ${styles.heroSubtitleSize}px !important;
                }
                
                /* Prix Banner */
                .price-main {
                    font-size: ${styles.priceMainSize}px !important;
                }
                .price-sub {
                    font-size: ${styles.priceSubSize}px !important;
                }
                .price-banner {
                    padding: ${styles.pricePadding}px ${styles.pricePadding * 1.5}px !important;
                }
                
                /* Section Titles */
                .section-title {
                    font-size: ${styles.sectionTitleSize}px !important;
                    font-weight: ${styles.sectionTitleWeight} !important;
                }
                
                /* Cards et Benefits */
                .benefit-card, .pricing-card {
                    padding: ${styles.cardPadding}px ${styles.cardPadding * 0.8}px !important;
                    border-radius: ${styles.cardBorderRadius}px !important;
                }
                .benefit-icon {
                    font-size: ${styles.benefitIconSize}px !important;
                }
                .benefit-title, .advantage-title {
                    font-size: ${styles.benefitTitleSize}px !important;
                }
                .benefit-text, .advantage-text {
                    font-size: ${styles.benefitTextSize}px !important;
                }
                
                /* Pricing Cards */
                .pricing-card {
                    padding: ${styles.pricingCardPadding}px ${styles.pricingCardPadding * 0.8}px !important;
                }
                .pricing-value {
                    font-size: ${styles.pricingValueSize}px !important;
                }
                .pricing-duration {
                    font-size: ${styles.pricingDurationSize}px !important;
                }
                
                /* CTA Buttons */
                .cta-rental, .cta-btn {
                    font-size: ${styles.ctaFontSize}px !important;
                    font-weight: ${styles.ctaFontWeight} !important;
                    padding: ${styles.ctaPadding}px ${styles.ctaPadding * 1.8}px !important;
                }
                
                /* Spacing Global */
                .section {
                    padding: ${styles.sectionPadding}px 2rem 4rem !important;
                }
                .container {
                    max-width: ${styles.containerMaxWidth}px !important;
                }
                .pricing-grid, .rental-benefits {
                    gap: ${styles.gridGap}px !important;
                }
                
                /* Rôle : Images dynamiques pour la comparaison produits */
                /* Synchronisation : Chemins d'images modifiables depuis l'éditeur */
                /* Responsabilité : Mise à jour en temps réel des background-image */
                .product-showcase {
                    background-image: url('${styles['product-image-path'] || './images/Li-CUBE PRO.png'}') !important;
                }
                .competitor-showcase {
                    background-image: url('${styles['competitor-image-path'] || './images/concurrent.png'}') !important;
                }
                
                /* Rôle : Gestion du logo dynamique (déjà existant mais maintenu pour cohérence) */
                .nav-logo {
                    background-image: url('${styles['logo-path'] || './images/logo edsquebec.png'}') !important;
                }
            `;
        }

        // ==========================================
        // SYSTÈME DE RÉORGANISATION DES SECTIONS
        // ==========================================
        
        // Obtient l'ordre actuel de TOUTES les sections (éditeur) depuis localStorage  
        function getAllSectionOrder() {
            const savedOrder = localStorage.getItem('locationVS-allSectionOrder');
            return savedOrder ? JSON.parse(savedOrder) : {
                'hero': 1,
                'hero-arguments': 2,
                'pricing': 3, 
                'advantages': 4,
                'technical': 5,
                'contact': 6,
                'conclusion-action': 7,
                'conclusion-comparative': 8
            };
        }
        
        // Obtient l'ordre des sections pour la présentation (sections existantes dans location.html)
        function getPresentationSectionOrder() {
            const allOrder = getAllSectionOrder();
            // Filtre uniquement les sections qui existent dans location.html
            return {
                'hero': allOrder.hero || 1,
                'pricing': allOrder.pricing || 2, 
                'advantages': allOrder.advantages || 3,
                'technical': allOrder.technical || 4,
                'contact': allOrder.contact || 5
            };
        }
        
        // Sauvegarde l'ordre de TOUTES les sections (éditeur)
        function saveAllSectionOrder(allOrder) {
            localStorage.setItem('locationVS-allSectionOrder', JSON.stringify(allOrder));
            
            // Génère l'ordre pour la présentation (sections filtrées)
            const presentationOrder = getPresentationSectionOrder();
            localStorage.setItem('locationVS-sectionOrder', JSON.stringify(presentationOrder));
            
            // Synchronisation immédiate avec la page de présentation
            window.dispatchEvent(new CustomEvent('storage', {
                detail: { key: 'locationVS-sectionOrder', newValue: JSON.stringify(presentationOrder) }
            }));
        }
        
        // Applique l'ordre des sections dans l'éditeur
        function applySectionOrder() {
            const order = getAllSectionOrder();
            const container = document.querySelector('.container');
            const sections = Array.from(container.querySelectorAll('.reorganizable-section'));
            
            // Trie les sections par ordre
            sections.sort((a, b) => {
                const aOrder = order[a.dataset.sectionId] || 999;
                const bOrder = order[b.dataset.sectionId] || 999;
                return aOrder - bOrder;
            });
            
            // Trouve la position d'insertion (après la section d'édition de style)
            const styleSection = container.querySelector('.css-editor');
            let insertAfter = styleSection;
            
            // Réinsère les sections dans le bon ordre
            sections.forEach(section => {
                container.insertBefore(section, insertAfter.nextSibling);
                insertAfter = section;
            });
            
            // Met à jour les attributs data-section-order
            sections.forEach(section => {
                section.dataset.sectionOrder = order[section.dataset.sectionId];
            });
            
            console.log('📋 Ordre des sections appliqué dans l\'éditeur:', order);
        }
        
        // Fonction pour monter une section
        function moveSectionUp(sectionId) {
            const order = getAllSectionOrder();
            const currentOrder = order[sectionId];
            
            if (!currentOrder || currentOrder <= 1) return; // Déjà en première position ou section non trouvée
            
            // Trouve la section qui est juste au-dessus
            const targetOrder = currentOrder - 1;
            const targetSectionId = Object.keys(order).find(id => order[id] === targetOrder);
            
            if (targetSectionId) {
                // Échange les positions
                order[sectionId] = targetOrder;
                order[targetSectionId] = currentOrder;
                
                saveAllSectionOrder(order);
                applySectionOrder();
                
                console.log(`📈 Section ${sectionId} montée en position ${targetOrder}`);
            }
        }
        
        // Fonction pour descendre une section
        function moveSectionDown(sectionId) {
            const order = getAllSectionOrder();
            const currentOrder = order[sectionId];
            const maxOrder = Math.max(...Object.values(order));
            
            if (!currentOrder || currentOrder >= maxOrder) return; // Déjà en dernière position ou section non trouvée
            
            // Trouve la section qui est juste en dessous
            const targetOrder = currentOrder + 1;
            const targetSectionId = Object.keys(order).find(id => order[id] === targetOrder);
            
            if (targetSectionId) {
                // Échange les positions
                order[sectionId] = targetOrder;
                order[targetSectionId] = currentOrder;
                
                saveAllSectionOrder(order);
                applySectionOrder();
                
                console.log(`📉 Section ${sectionId} descendue en position ${targetOrder}`);
            }
        }

        // Initialisation
        document.addEventListener('DOMContentLoaded', function() {
            // Création du backup automatique
            createInitialBackup();
            
            // Écouteurs d'événements pour tous les contrôles avec application temps réel
            Object.keys(defaultValues).forEach(key => {
                const element = document.getElementById(key);
                if (element) {
                    element.addEventListener('input', () => {
                        updateValueDisplays();
                        applyStyles();
                        // Application temps réel sur page présentation
                        syncToPresentation();
                    });
                    element.addEventListener('change', () => {
                        updateValueDisplays();
                        applyStyles();
                        // Application temps réel sur page présentation
                        syncToPresentation();
                    });
                }
            });
            
            // Initialisation de l'ordre des sections
            applySectionOrder();
            
            // Chargement initial
            updateValueDisplays();
            loadSavedStyles();
            
            console.log('🎨 Éditeur CSS complet initialisé avec sync temps réel et réorganisation des sections');
        });
    </script>
    
    <!-- Systèmes Avancés -->
    <link rel="stylesheet" href="css/advanced-style-editor.css">
    <script src="js/advanced-style-editor.js"></script>
    <script src="js/dynamic-descriptions.js"></script>

    <!-- Synchronisation des Variables CSS avec location.html -->
    <script>
        // Listener pour synchroniser les variables CSS de la page d'édition avec location.html
        let editPageStyleElement = null;
        
        // Application des variables CSS dynamiques à la page d'édition
        function applyDynamicCSSToEditPage(styles) {
            // Suppression de l'ancien style dynamique
            if (editPageStyleElement) {
                editPageStyleElement.remove();
            }
            
            // Création du nouveau style avec les variables mises à jour
            editPageStyleElement = document.createElement('style');
            editPageStyleElement.id = 'dynamic-edit-page-styles';
            editPageStyleElement.textContent = `
                /* Variables CSS Dynamiques synchronisées avec location.html */
                :root {
                    --primary-dark: ${styles.primaryDark || '#0F172A'};
                    --secondary-dark: ${styles.secondaryDark || '#1E293B'};
                    --accent-green: ${styles.accentGreen || '#10B981'};
                    --accent-blue: ${styles.accentBlue || '#3B82F6'};
                    --accent-teal: ${styles.accentTeal || '#14B8A6'};
                    --success-green: ${styles.successGreen || '#059669'};
                    --warning-orange: ${styles.warningOrange || '#F59E0B'};
                    --warning-red: ${styles.warningRed || '#EF4444'};
                    --text-white: ${styles.textWhite || '#F8FAFC'};
                    --text-gray: ${styles.textGray || '#CBD5E1'};
                    --info-blue: ${styles.infoBlue || '#3B82F6'};
                    --neutral-gray: ${styles.neutralGray || '#6B7280'};
                    
                    --gradient-primary: linear-gradient(135deg, var(--primary-dark) 0%, var(--secondary-dark) 100%);
                    --gradient-green: linear-gradient(135deg, var(--accent-green) 0%, var(--accent-teal) 100%);
                    --gradient-blue: linear-gradient(135deg, var(--accent-blue) 0%, #60A5FA 100%);
                    --shadow-md: 0 4px 6px rgba(0,0,0,0.4);
                    --shadow-lg: 0 10px 15px rgba(0,0,0,0.5);
                    --shadow-glow: 0 0 30px rgba(16, 185, 129, 0.4);
                }
                
                /* Mise à jour du thème de la page d'édition en temps réel */
                body {
                    background: var(--gradient-primary);
                    color: var(--text-white);
                }
                
                .editor-header {
                    background: rgba(15, 23, 42, 0.95);
                    border-bottom: 1px solid var(--accent-green);
                }
                
                .edit-section {
                    background: rgba(16, 185, 129, 0.05);
                    border: 1px solid rgba(16, 185, 129, 0.1);
                }
                
                .section-title {
                    color: var(--accent-green);
                }
                
                .field-label {
                    color: var(--text-white);
                }
                
                .field-description {
                    color: var(--text-gray);
                }
                
                .field-input {
                    background: rgba(16, 185, 129, 0.1);
                    border: 1px solid rgba(16, 185, 129, 0.2);
                    color: var(--text-white);
                }
                
                .field-input:focus {
                    border-color: var(--accent-green);
                    background: rgba(16, 185, 129, 0.15);
                    box-shadow: 0 0 0 3px rgba(16, 185, 129, 0.1);
                }
                
                .btn-back {
                    background: rgba(16, 185, 129, 0.1);
                    color: var(--accent-green);
                    border: 1px solid var(--accent-green);
                }
                
                .btn-save {
                    background: var(--success-green);
                }
                
                .btn-preview {
                    background: var(--accent-teal);
                }
                
                .css-title {
                    background: var(--accent-green);
                }
                
                .css-group h3 {
                    color: var(--accent-green);
                }
                
                .pricing-edit-card {
                    background: rgba(16, 185, 129, 0.08);
                    border: 1px solid rgba(16, 185, 129, 0.2);
                }
                
                .pricing-edit-card.featured {
                    border-color: var(--accent-green);
                    background: rgba(16, 185, 129, 0.12);
                }
                
                .range-value {
                    color: var(--accent-green);
                }
                
                .status-message.success {
                    background: rgba(16, 185, 129, 0.1);
                    border-color: var(--success-green);
                    color: var(--success-green);
                }
                
                .status-message.error {
                    background: rgba(239, 68, 68, 0.1);
                    border-color: var(--warning-red);
                    color: var(--warning-red);
                }
            `;
            
            document.head.appendChild(editPageStyleElement);
            console.log('🎨 Variables CSS de la page d\'édition synchronisées avec location.html');
        }
        
        // Extraction des styles depuis le CSS généré pour location.html
        function extractStylesFromLocationCSS(css) {
            const styles = {};
            
            // Extraction des variables CSS du CSS généré
            const rootMatch = css.match(/:root\s*{([^}]+)}/);
            if (rootMatch) {
                const rootContent = rootMatch[1];
                const variableMatches = rootContent.matchAll(/--([^:]+):\s*([^;]+);/g);
                for (const match of variableMatches) {
                    const varName = match[1].trim();
                    const varValue = match[2].trim();
                    styles[varName] = varValue;
                }
            }
            
            return styles;
        }
        
        // Écoute des changements de styles depuis location.html
        window.addEventListener('storage', function(e) {
            if (e.key === 'locationVS-css-broadcast' && e.newValue) {
                try {
                    const message = JSON.parse(e.newValue);
                    if (message.type === 'LOCATION_CSS_UPDATE' && message.css) {
                        const extractedStyles = extractStylesFromLocationCSS(message.css);
                        applyDynamicCSSToEditPage(extractedStyles);
                        console.log('📡 Styles reçus depuis location.html et appliqués à la page d\'édition');
                    }
                } catch (error) {
                    console.warn('⚠️ Erreur lors de la réception des styles:', error);
                }
            }
        });
        
        // Écoute locale (même onglet) des changements de styles
        function handleLocalStyleChanges() {
            if (typeof window.getCurrentStyles === 'function') {
                const currentStyles = window.getCurrentStyles();
                applyDynamicCSSToEditPage(currentStyles);
            }
        }
        
        // Application initiale des styles au chargement
        document.addEventListener('DOMContentLoaded', function() {
            // Application des styles par défaut
            const defaultStyles = {
                primaryDark: '#0F172A',
                secondaryDark: '#1E293B',
                accentGreen: '#10B981',
                accentBlue: '#3B82F6',
                accentTeal: '#14B8A6',
                successGreen: '#059669',
                warningOrange: '#F59E0B',
                warningRed: '#EF4444',
                textWhite: '#F8FAFC',
                textGray: '#CBD5E1',
                infoBlue: '#3B82F6',
                neutralGray: '#6B7280'
            };
            
            applyDynamicCSSToEditPage(defaultStyles);
            
            // Écoute locale des changements de contrôles de style
            if (typeof defaultValues !== 'undefined') {
                Object.keys(defaultValues).forEach(key => {
                    const element = document.getElementById(key);
                    if (element) {
                        element.addEventListener('input', handleLocalStyleChanges);
                        element.addEventListener('change', handleLocalStyleChanges);
                    }
                });
            }
            
            console.log('🎭 Système de synchronisation des styles de la page d\'édition initialisé');
        });
    </script>
</body>
</html>