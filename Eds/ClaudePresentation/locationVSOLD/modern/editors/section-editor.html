<!DOCTYPE html>
<html lang="fr">
<head>
    <title>Éditeur de Sections - Li-CUBE PRO™</title>
    <link rel="import" href="editor-layout.html">
    <script>
        const layout = document.querySelector('link[rel="import"]').import.getElementById('layout');
        document.head.appendChild(layout.content.cloneNode(true));
    </script>
    <style>
        /* Styles spécifiques à l'éditeur de sections */
        body {
            margin: 0;
            padding: 0;
            background: var(--bg-primary);
            color: var(--text-light);
            font-family: var(--font-system);
            overflow: hidden;
        }

        /* Structure principale de l'éditeur */
        .editor-layout {
            display: grid;
            grid-template-columns: 300px 1fr 350px;
            grid-template-rows: 60px 1fr;
            height: 100vh;
            gap: 1px;
            background: var(--border-color);
        }

        /* Barre d'outils principale */
        .main-toolbar {
            grid-column: 1 / -1;
            background: var(--bg-secondary);
            border-bottom: 1px solid var(--border-color);
            display: flex;
            align-items: center;
            padding: 0 var(--spacing-md);
            gap: var(--spacing-sm);
        }

        .toolbar-group {
            display: flex;
            gap: var(--spacing-xs);
            padding-right: var(--spacing-md);
            border-right: 1px solid var(--border-color);
        }

        .toolbar-group:last-child {
            border-right: none;
            margin-left: auto;
        }

        .toolbar-btn {
            background: transparent;
            border: 1px solid transparent;
            color: var(--text-light);
            padding: var(--spacing-xs) var(--spacing-sm);
            border-radius: var(--border-radius-sm);
            cursor: pointer;
            font-size: var(--text-sm);
            transition: all 0.2s ease;
            display: flex;
            align-items: center;
            gap: var(--spacing-xs);
        }

        .toolbar-btn:hover {
            background: var(--bg-card);
            border-color: var(--border-color);
        }

        .toolbar-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        /* Panneau des templates de sections */
        .section-library {
            background: var(--bg-secondary);
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }

        .library-header {
            padding: var(--spacing-md);
            border-bottom: 1px solid var(--border-color);
        }

        .library-title {
            font-size: var(--text-lg);
            font-weight: var(--font-bold);
            color: var(--accent-green);
            margin-bottom: var(--spacing-sm);
        }

        .library-search {
            width: 100%;
            background: var(--bg-primary);
            border: 1px solid var(--border-color);
            border-radius: var(--border-radius);
            padding: var(--spacing-sm);
            color: var(--text-light);
            font-size: var(--text-sm);
        }

        .library-content {
            flex: 1;
            overflow-y: auto;
            padding: var(--spacing-sm);
        }

        .section-category {
            margin-bottom: var(--spacing-lg);
        }

        .category-title {
            font-size: var(--text-sm);
            font-weight: var(--font-medium);
            color: var(--text-muted);
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin-bottom: var(--spacing-sm);
            padding: 0 var(--spacing-xs);
        }

        .section-template {
            background: var(--bg-card);
            border: 1px solid var(--border-color);
            border-radius: var(--border-radius);
            padding: var(--spacing-sm);
            margin-bottom: var(--spacing-xs);
            cursor: grab;
            transition: all 0.2s ease;
            user-select: none;
        }

        .section-template:hover {
            border-color: var(--accent-green);
            background: rgba(16, 185, 129, 0.1);
        }

        .section-template:active {
            cursor: grabbing;
        }

        .section-template.dragging {
            opacity: 0.5;
            transform: rotate(3deg);
        }

        .template-header {
            display: flex;
            align-items: center;
            gap: var(--spacing-sm);
            margin-bottom: var(--spacing-xs);
        }

        .template-icon {
            font-size: 1.2em;
            color: var(--accent-green);
        }

        .template-name {
            font-weight: var(--font-medium);
            font-size: var(--text-sm);
        }

        .template-description {
            font-size: var(--text-xs);
            color: var(--text-muted);
            line-height: 1.3;
        }

        /* Zone de travail principale */
        .editor-workspace {
            background: var(--bg-primary);
            position: relative;
            overflow: auto;
        }

        .workspace-container {
            min-height: 100%;
            padding: var(--spacing-xl);
            background-image: radial-gradient(circle at 1px 1px, rgba(255,255,255,0.05) 1px, transparent 0);
            background-size: 20px 20px;
        }

        .section-canvas {
            background: white;
            min-height: 800px;
            box-shadow: var(--shadow-lg);
            border-radius: var(--border-radius);
            position: relative;
            overflow: hidden;
        }

        .canvas-section {
            border: 2px dashed transparent;
            padding: var(--spacing-md);
            margin: var(--spacing-sm) 0;
            border-radius: var(--border-radius);
            transition: all 0.2s ease;
            position: relative;
        }

        .canvas-section:hover {
            border-color: var(--accent-green);
            background: rgba(16, 185, 129, 0.05);
        }

        .canvas-section.selected {
            border-color: var(--accent-blue);
            border-style: solid;
            background: rgba(59, 130, 246, 0.05);
        }

        .section-controls {
            position: absolute;
            top: -30px;
            right: 0;
            background: var(--bg-secondary);
            border-radius: var(--border-radius-sm);
            padding: var(--spacing-xs);
            display: none;
            gap: var(--spacing-xs);
        }

        .canvas-section:hover .section-controls,
        .canvas-section.selected .section-controls {
            display: flex;
        }

        .section-control-btn {
            background: transparent;
            border: none;
            color: var(--text-light);
            padding: var(--spacing-xs);
            border-radius: var(--border-radius-sm);
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .section-control-btn:hover {
            background: var(--accent-green);
        }

        .drop-zone {
            min-height: 100px;
            border: 2px dashed var(--border-color);
            border-radius: var(--border-radius);
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--text-muted);
            font-size: var(--text-sm);
            transition: all 0.2s ease;
        }

        .drop-zone.drag-over {
            border-color: var(--accent-green);
            background: rgba(16, 185, 129, 0.1);
            color: var(--accent-green);
        }

        /* Panneau des propriétés */
        .properties-panel {
            background: var(--bg-secondary);
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }

        .properties-header {
            padding: var(--spacing-md);
            border-bottom: 1px solid var(--border-color);
        }

        .properties-title {
            font-size: var(--text-lg);
            font-weight: var(--font-bold);
            color: var(--accent-blue);
            margin-bottom: var(--spacing-sm);
        }

        .properties-content {
            flex: 1;
            overflow-y: auto;
            padding: var(--spacing-md);
        }

        .property-group {
            margin-bottom: var(--spacing-lg);
        }

        .property-group-title {
            font-size: var(--text-sm);
            font-weight: var(--font-medium);
            color: var(--text-light);
            margin-bottom: var(--spacing-sm);
            padding-bottom: var(--spacing-xs);
            border-bottom: 1px solid var(--border-color);
        }

        .form-group {
            margin-bottom: var(--spacing-md);
        }

        .form-label {
            display: block;
            font-size: var(--text-sm);
            color: var(--text-muted);
            margin-bottom: var(--spacing-xs);
        }

        .form-input {
            width: 100%;
            background: var(--bg-primary);
            border: 1px solid var(--border-color);
            border-radius: var(--border-radius);
            padding: var(--spacing-sm);
            color: var(--text-light);
            font-size: var(--text-sm);
        }

        .form-input:focus {
            outline: none;
            border-color: var(--accent-blue);
            box-shadow: 0 0 0 2px rgba(59, 130, 246, 0.2);
        }

        .form-textarea {
            min-height: 80px;
            resize: vertical;
        }

        .form-select {
            appearance: none;
            background-image: url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 20 20'%3E%3Cpath stroke='%236B7280' stroke-linecap='round' stroke-linejoin='round' stroke-width='1.5' d='M6 8l4 4 4-4'/%3E%3C/svg%3E");
            background-position: right 8px center;
            background-repeat: no-repeat;
            background-size: 16px;
            padding-right: 32px;
        }

        .color-picker-group {
            display: grid;
            grid-template-columns: 1fr auto;
            gap: var(--spacing-sm);
            align-items: end;
        }

        .color-preview {
            width: 40px;
            height: 32px;
            border-radius: var(--border-radius);
            border: 1px solid var(--border-color);
            cursor: pointer;
        }

        /* États de chargement et feedback */
        .loading {
            opacity: 0.6;
            pointer-events: none;
        }

        .error-message {
            background: rgba(239, 68, 68, 0.1);
            color: var(--danger-red);
            padding: var(--spacing-sm);
            border-radius: var(--border-radius);
            font-size: var(--text-sm);
            margin-bottom: var(--spacing-sm);
        }

        .success-message {
            background: rgba(5, 150, 105, 0.1);
            color: var(--success-green);
            padding: var(--spacing-sm);
            border-radius: var(--border-radius);
            font-size: var(--text-sm);
            margin-bottom: var(--spacing-sm);
        }

        /* Responsive design */
        @media (max-width: 1200px) {
            .editor-layout {
                grid-template-columns: 250px 1fr 300px;
            }
        }

        @media (max-width: 768px) {
            .editor-layout {
                grid-template-columns: 1fr;
                grid-template-rows: 60px 200px 1fr 250px;
            }
            
            .section-library {
                max-height: 200px;
            }
            
            .properties-panel {
                max-height: 250px;
            }
        }
    </style>
</head>
<body>
    <div class="editor-layout">
        <!-- Barre d'outils principale -->
        <div class="main-toolbar">
            <div class="toolbar-group">
                <button class="toolbar-btn" id="newBtn" title="Nouvelle présentation">
                    <i class="fas fa-file-plus"></i>
                    Nouveau
                </button>
                <button class="toolbar-btn" id="openBtn" title="Ouvrir une présentation">
                    <i class="fas fa-folder-open"></i>
                    Ouvrir
                </button>
                <button class="toolbar-btn" id="saveBtn" title="Sauvegarder">
                    <i class="fas fa-save"></i>
                    Sauvegarder
                </button>
            </div>

            <div class="toolbar-group">
                <button class="toolbar-btn" id="undoBtn" title="Annuler" disabled>
                    <i class="fas fa-undo"></i>
                </button>
                <button class="toolbar-btn" id="redoBtn" title="Refaire" disabled>
                    <i class="fas fa-redo"></i>
                </button>
            </div>

            <div class="toolbar-group">
                <button class="toolbar-btn" id="zoomOutBtn" title="Dézoomer">
                    <i class="fas fa-search-minus"></i>
                </button>
                <span id="zoomLevel" class="toolbar-btn">100%</span>
                <button class="toolbar-btn" id="zoomInBtn" title="Zoomer">
                    <i class="fas fa-search-plus"></i>
                </button>
                <button class="toolbar-btn" id="zoomFitBtn" title="Ajuster à la fenêtre">
                    <i class="fas fa-expand-arrows-alt"></i>
                </button>
            </div>

            <div class="toolbar-group">
                <button class="toolbar-btn" id="previewBtn" title="Aperçu">
                    <i class="fas fa-eye"></i>
                    Aperçu
                </button>
                <button class="toolbar-btn" id="exportBtn" title="Exporter">
                    <i class="fas fa-download"></i>
                    Exporter
                </button>
            </div>
        </div>

        <!-- Panneau des templates de sections -->
        <div class="section-library">
            <div class="library-header">
                <h3 class="library-title">Templates de Sections</h3>
                <input type="text" class="library-search" placeholder="Rechercher un template..." id="searchInput">
            </div>
            <div class="library-content" id="libraryContent">
                <!-- Templates de sections seront ajoutés ici dynamiquement -->
            </div>
        </div>

        <!-- Zone de travail principale -->
        <div class="editor-workspace">
            <div class="workspace-container">
                <div class="section-canvas" id="sectionCanvas">
                    <div class="drop-zone" id="mainDropZone">
                        <i class="fas fa-plus-circle" style="margin-right: 8px;"></i>
                        Glissez un template de section ici pour commencer
                    </div>
                </div>
            </div>
        </div>

        <!-- Panneau des propriétés -->
        <div class="properties-panel">
            <div class="properties-header">
                <h3 class="properties-title">Propriétés</h3>
            </div>
            <div class="properties-content" id="propertiesContent">
                <div style="text-align: center; color: var(--text-muted); padding: var(--spacing-xl);">
                    <i class="fas fa-mouse-pointer" style="font-size: 2em; margin-bottom: var(--spacing-sm);"></i>
                    <p>Sélectionnez une section pour modifier ses propriétés</p>
                </div>
            </div>
        </div>
    </div>

    <script>
        /**
         * ============================================================================
         * ÉDITEUR DE SECTIONS - Système d'Édition Modulaire de Sections
         * ============================================================================
         * 
         * Rôle : Interface d'édition pour créer et gérer des sections complexes
         * Type : Éditeur WYSIWYG - Drag & Drop sections
         * Usage : Création de présentations par assemblage de sections prédéfinies
         */

        class SectionEditor {
            constructor() {
                // Configuration de base - Paramètres de l'éditeur
                this.currentZoom = 100; // Pourcentage de zoom actuel (100 = taille normale)
                this.selectedSection = null; // Section actuellement sélectionnée pour édition
                this.sections = []; // Liste des sections dans la présentation
                this.history = []; // Historique des actions pour undo/redo
                this.historyIndex = -1; // Position actuelle dans l'historique
                this.maxHistory = 50; // Nombre maximum d'actions mémorisées

                // Templates de sections disponibles - Définitions des modèles
                this.sectionTemplates = {
                    'hero': {
                        name: 'Section Hero',
                        icon: '🎯',
                        category: 'En-tête',
                        description: 'Section d\'accroche principale avec titre et CTA',
                        defaultContent: {
                            title: 'Li-CUBE PRO™',
                            subtitle: 'LOCATION INTELLIGENTE ZÉRO RISQUE',
                            description: 'La solution de location révolutionnaire pour professionnels',
                            ctaText: 'Découvrir',
                            backgroundType: 'gradient',
                            backgroundColor: '#0F172A'
                        },
                        template: `
                            <div class="hero-section" style="--hero-bg: linear-gradient(135deg, #0F172A 0%, #1E293B 100%);">
                                <h1 class="hero-title" style="--hero-title-bg: linear-gradient(135deg, #10B981 0%, #14B8A6 100%);">{{title}}</h1>
                                <div class="hero-subtitle" style="--hero-subtitle-color: #10B981;">{{subtitle}}</div>
                                <p style="font-size: 1.2rem; max-width: 600px; margin: 0 auto 2rem auto; opacity: 0.9;">{{description}}</p>
                                <button style="background: linear-gradient(135deg, #10B981 0%, #14B8A6 100%); color: white; border: none; padding: 1rem 2rem; font-size: 1.1rem; font-weight: 600; border-radius: 8px; cursor: pointer; transition: transform 0.2s ease;">{{ctaText}}</button>
                            </div>
                        `,
                        editableFields: [
                            { name: 'title', type: 'text', label: 'Titre principal' },
                            { name: 'subtitle', type: 'text', label: 'Sous-titre' },
                            { name: 'description', type: 'textarea', label: 'Description' },
                            { name: 'ctaText', type: 'text', label: 'Texte du bouton' },
                            { name: 'backgroundColor', type: 'color', label: 'Couleur de fond' }
                        ]
                    },
                    'pricing': {
                        name: 'Cartes de Tarification',
                        icon: '💰',
                        category: 'Commerce',
                        description: 'Section avec plusieurs plans tarifaires',
                        defaultContent: {
                            title: 'Nos Offres',
                            plans: [
                                {
                                    name: 'ESSENTIEL',
                                    price: '299',
                                    period: '/mois',
                                    featured: false,
                                    features: ['Installation gratuite', 'Support standard', 'Jusqu\'à 50 équipements']
                                },
                                {
                                    name: 'PROFESSIONNEL',
                                    price: '599',
                                    period: '/mois',
                                    featured: true,
                                    features: ['Installation gratuite', 'Maintenance incluse', 'Support 24/7', 'Jusqu\'à 200 équipements']
                                },
                                {
                                    name: 'ENTERPRISE',
                                    price: '999',
                                    period: '/mois',
                                    featured: false,
                                    features: ['Installation gratuite', 'Maintenance incluse', 'Support prioritaire', 'Équipements illimités', 'Formation équipe']
                                }
                            ]
                        },
                        template: `
                            <div class="pricing-section" style="padding: 80px 40px; background: #F8FAFC;">
                                <h2 style="text-align: center; font-size: 2.5rem; font-weight: 900; color: #0F172A; margin-bottom: 3rem;">{{title}}</h2>
                                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 2rem; max-width: 1200px; margin: 0 auto;">
                                    {{#each plans}}
                                    <div class="pricing-card" style="--pricing-card-bg: {{#if featured}}linear-gradient(135deg, #0F172A 0%, #1E293B 100%){{else}}white{{/if}}; --pricing-card-border: {{#if featured}}#10B981{{else}}#E2E8F0{{/if}}; --pricing-card-transform: {{#if featured}}scale(1.05){{else}}none{{/if}};">
                                        {{#if featured}}<div style="position: absolute; top: -10px; left: 50%; transform: translateX(-50%); background: linear-gradient(135deg, #10B981 0%, #14B8A6 100%); color: white; padding: 0.5rem 1rem; border-radius: 20px; font-size: 0.8rem; font-weight: bold;">POPULAIRE</div>{{/if}}
                                        <h3 style="color: {{#if featured}}#10B981{{else}}#0F172A{{/if}}; font-size: 1.5rem; margin-bottom: 1rem;">{{name}}</h3>
                                        <div style="margin-bottom: 2rem;">
                                            <span style="font-size: 3rem; font-weight: 900; color: {{#if featured}}white{{else}}#0F172A{{/if}};">{{price}}$</span>
                                            <span style="color: {{#if featured}}#94A3B8{{else}}#64748B{{/if}};">{{period}}</span>
                                        </div>
                                        <ul style="list-style: none; margin-bottom: 2rem; text-align: left;">
                                            {{#each features}}
                                            <li class="pricing-feature" style="--pricing-feature-color: {{#if ../featured}}#CBD5E1{{else}}#475569{{/if}};">✅ {{this}}</li>
                                            {{/each}}
                                        </ul>
                                        <button class="pricing-cta" style="--pricing-cta-bg: {{#if featured}}linear-gradient(135deg, #10B981 0%, #14B8A6 100%){{else}}#0F172A{{/if}};">Choisir ce Plan</button>
                                    </div>
                                    {{/each}}
                                </div>
                            </div>
                        `,
                        editableFields: [
                            { name: 'title', type: 'text', label: 'Titre de la section' }
                        ]
                    },
                    'features': {
                        name: 'Grille d\'Avantages',
                        icon: '✨',
                        category: 'Contenu',
                        description: 'Présentation des fonctionnalités en grille',
                        defaultContent: {
                            title: 'Pourquoi Choisir Li-CUBE PRO™',
                            subtitle: 'Des avantages qui font la différence',
                            features: [
                                {
                                    icon: '⚡',
                                    title: 'Installation Express',
                                    description: 'Mise en service en moins de 24h avec notre équipe certifiée'
                                },
                                {
                                    icon: '🔧',
                                    title: 'Maintenance Préventive',
                                    description: 'Interventions programmées pour éviter les pannes'
                                },
                                {
                                    icon: '📊',
                                    title: 'Analytique Avancée',
                                    description: 'Tableaux de bord et rapports détaillés en temps réel'
                                },
                                {
                                    icon: '🛡️',
                                    title: 'Garantie Zéro Risque',
                                    description: 'Assurance tous risques incluse sans franchise'
                                }
                            ]
                        },
                        template: `
                            <div class="features-section" style="padding: 80px 40px; background: white;">
                                <div style="text-align: center; margin-bottom: 4rem;">
                                    <h2 style="font-size: 2.5rem; font-weight: 900; color: #0F172A; margin-bottom: 1rem;">{{title}}</h2>
                                    <p style="font-size: 1.2rem; color: #64748B; max-width: 600px; margin: 0 auto;">{{subtitle}}</p>
                                </div>
                                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 2rem; max-width: 1200px; margin: 0 auto;">
                                    {{#each features}}
                                    <div style="text-align: center; padding: 2rem; border-radius: 12px; background: #F8FAFC; border: 1px solid #E2E8F0; transition: transform 0.2s ease;" onmouseover="this.style.transform='translateY(-5px)'; this.style.boxShadow='0 10px 25px rgba(0,0,0,0.1)'" onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='none'">
                                        <div style="font-size: 3rem; margin-bottom: 1rem;">{{icon}}</div>
                                        <h3 style="font-size: 1.25rem; font-weight: 700; color: #0F172A; margin-bottom: 1rem;">{{title}}</h3>
                                        <p style="color: #64748B; line-height: 1.6;">{{description}}</p>
                                    </div>
                                    {{/each}}
                                </div>
                            </div>
                        `,
                        editableFields: [
                            { name: 'title', type: 'text', label: 'Titre principal' },
                            { name: 'subtitle', type: 'text', label: 'Sous-titre' }
                        ]
                    },
                    'testimonials': {
                        name: 'Témoignages Clients',
                        icon: '💬',
                        category: 'Social Proof',
                        description: 'Section de témoignages avec photos',
                        defaultContent: {
                            title: 'Ce que disent nos clients',
                            testimonials: [
                                {
                                    quote: 'Li-CUBE PRO™ a révolutionné notre gestion d\'équipements. Plus de pannes imprévues !',
                                    author: 'Marie Dubois',
                                    role: 'Directrice Technique',
                                    company: 'TechPro Solutions',
                                    avatar: 'https://images.unsplash.com/photo-1494790108755-2616b612b05b?w=100&h=100&fit=crop&crop=face'
                                },
                                {
                                    quote: 'Le service client est exceptionnel. Disponibles 24/7 avec des réponses expertes.',
                                    author: 'Jean Martin',
                                    role: 'Responsable Maintenance',
                                    company: 'IndustrieMax',
                                    avatar: 'https://images.unsplash.com/photo-1472099645785-5658abf4ff4e?w=100&h=100&fit=crop&crop=face'
                                }
                            ]
                        },
                        template: `
                            <div class="testimonials-section" style="padding: 80px 40px; background: linear-gradient(135deg, #0F172A 0%, #1E293B 100%);">
                                <h2 style="text-align: center; font-size: 2.5rem; font-weight: 900; color: white; margin-bottom: 3rem;">{{title}}</h2>
                                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(400px, 1fr)); gap: 2rem; max-width: 1000px; margin: 0 auto;">
                                    {{#each testimonials}}
                                    <div style="background: rgba(255, 255, 255, 0.05); border: 1px solid rgba(255, 255, 255, 0.1); border-radius: 16px; padding: 2rem; backdrop-filter: blur(10px);">
                                        <blockquote style="font-size: 1.1rem; color: #E2E8F0; line-height: 1.6; margin-bottom: 1.5rem; font-style: italic;">
                                            "{{quote}}"
                                        </blockquote>
                                        <div style="display: flex; align-items: center; gap: 1rem;">
                                            <img src="{{avatar}}" alt="{{author}}" style="width: 50px; height: 50px; border-radius: 50%; object-fit: cover;">
                                            <div>
                                                <div style="font-weight: 600; color: #10B981;">{{author}}</div>
                                                <div style="font-size: 0.9rem; color: #94A3B8;">{{role}}</div>
                                                <div style="font-size: 0.8rem; color: #64748B;">{{company}}</div>
                                            </div>
                                        </div>
                                    </div>
                                    {{/each}}
                                </div>
                            </div>
                        `,
                        editableFields: [
                            { name: 'title', type: 'text', label: 'Titre de la section' }
                        ]
                    },
                    'cta': {
                        name: 'Appel à l\'Action',
                        icon: '🚀',
                        category: 'Conversion',
                        description: 'Section d\'appel à l\'action finale',
                        defaultContent: {
                            title: 'Prêt à Transformer Votre Activité ?',
                            subtitle: 'Rejoignez plus de 500 entreprises qui font confiance à Li-CUBE PRO™',
                            ctaPrimary: 'Demander une Démo',
                            ctaSecondary: 'Voir les Tarifs',
                            backgroundImage: ''
                        },
                        template: `
                            <div class="cta-section" style="padding: 100px 40px; background: linear-gradient(135deg, #10B981 0%, #14B8A6 100%); text-align: center; color: white;">
                                <h2 style="font-size: 2.5rem; font-weight: 900; margin-bottom: 1rem;">{{title}}</h2>
                                <p style="font-size: 1.2rem; max-width: 600px; margin: 0 auto 2.5rem auto; opacity: 0.9;">{{subtitle}}</p>
                                <div style="display: flex; gap: 1rem; justify-content: center; flex-wrap: wrap;">
                                    <button style="background: white; color: #10B981; border: none; padding: 1rem 2rem; font-size: 1.1rem; font-weight: 600; border-radius: 8px; cursor: pointer; transition: transform 0.2s ease;" onmouseover="this.style.transform='translateY(-2px)'" onmouseout="this.style.transform='translateY(0)'">{{ctaPrimary}}</button>
                                    <button style="background: transparent; color: white; border: 2px solid white; padding: 1rem 2rem; font-size: 1.1rem; font-weight: 600; border-radius: 8px; cursor: pointer; transition: all 0.2s ease;" onmouseover="this.style.background='white'; this.style.color='#10B981'" onmouseout="this.style.background='transparent'; this.style.color='white'">{{ctaSecondary}}</button>
                                </div>
                            </div>
                        `,
                        editableFields: [
                            { name: 'title', type: 'text', label: 'Titre principal' },
                            { name: 'subtitle', type: 'text', label: 'Sous-titre' },
                            { name: 'ctaPrimary', type: 'text', label: 'Bouton principal' },
                            { name: 'ctaSecondary', type: 'text', label: 'Bouton secondaire' }
                        ]
                    }
                };

                // Initialisation de l'éditeur - Configuration des événements
                this.init();
            }

            /**
             * Rôle : Initialisation complète de l'éditeur
             * Type : Setup - Configuration des événements et interface
             * Retour : void
             */
            init() {
                // Initialisation des événements de l'interface
                this.setupEventListeners();
                
                // Peuplement de la bibliothèque de templates
                this.populateLibrary();
                
                // Configuration du drag & drop
                this.setupDragAndDrop();
                
                // Sauvegarde de l'état initial pour l'historique
                this.saveState();
            }

            /**
             * Rôle : Configuration des écouteurs d'événements
             * Type : Event handling - Liaison des interactions utilisateur
             * Retour : void
             */
            setupEventListeners() {
                // Boutons de la barre d'outils - Actions principales
                document.getElementById('newBtn').addEventListener('click', () => this.newPresentation());
                document.getElementById('saveBtn').addEventListener('click', () => this.savePresentation());
                document.getElementById('undoBtn').addEventListener('click', () => this.undo());
                document.getElementById('redoBtn').addEventListener('click', () => this.redo());
                
                // Contrôles de zoom - Modification de la vue
                document.getElementById('zoomInBtn').addEventListener('click', () => this.zoomIn());
                document.getElementById('zoomOutBtn').addEventListener('click', () => this.zoomOut());
                document.getElementById('zoomFitBtn').addEventListener('click', () => this.zoomFit());
                
                // Actions d'exportation et prévisualisation
                document.getElementById('previewBtn').addEventListener('click', () => this.preview());
                document.getElementById('exportBtn').addEventListener('click', () => this.exportPresentation());
                
                // Recherche dans la bibliothèque - Filtrage des templates
                document.getElementById('searchInput').addEventListener('input', (e) => this.filterLibrary(e.target.value));
            }

            /**
             * Rôle : Peuplement de la bibliothèque avec les templates
             * Type : UI Generation - Création des éléments de bibliothèque
             * Retour : void
             */
            populateLibrary() {
                const libraryContent = document.getElementById('libraryContent');
                
                // Regroupement des templates par catégorie
                const categories = {};
                
                // Classification des templates par catégorie
                Object.entries(this.sectionTemplates).forEach(([key, template]) => {
                    if (!categories[template.category]) {
                        categories[template.category] = [];
                    }
                    categories[template.category].push({ key, ...template });
                });

                // Génération HTML pour chaque catégorie
                Object.entries(categories).forEach(([categoryName, templates]) => {
                    const categoryDiv = document.createElement('div');
                    categoryDiv.className = 'section-category';
                    
                    // Titre de catégorie
                    const categoryTitle = document.createElement('div');
                    categoryTitle.className = 'category-title';
                    categoryTitle.textContent = categoryName;
                    categoryDiv.appendChild(categoryTitle);
                    
                    // Templates de la catégorie
                    templates.forEach(template => {
                        const templateDiv = document.createElement('div');
                        templateDiv.className = 'section-template';
                        templateDiv.draggable = true;
                        templateDiv.dataset.templateKey = template.key;
                        
                        templateDiv.innerHTML = `
                            <div class="template-header">
                                <span class="template-icon">${template.icon}</span>
                                <span class="template-name">${template.name}</span>
                            </div>
                            <div class="template-description">${template.description}</div>
                        `;
                        
                        categoryDiv.appendChild(templateDiv);
                    });
                    
                    libraryContent.appendChild(categoryDiv);
                });
            }

            /**
             * Rôle : Configuration du système de drag & drop
             * Type : Interaction - Gestion du glisser-déposer
             * Retour : void
             */
            setupDragAndDrop() {
                // Zone de dépôt principale - Canvas de sections
                const canvas = document.getElementById('sectionCanvas');
                const dropZone = document.getElementById('mainDropZone');
                
                // Gestion du drag depuis la bibliothèque
                document.addEventListener('dragstart', (e) => {
                    if (e.target.classList.contains('section-template')) {
                        e.target.classList.add('dragging');
                        e.dataTransfer.setData('text/plain', e.target.dataset.templateKey);
                    }
                });
                
                document.addEventListener('dragend', (e) => {
                    if (e.target.classList.contains('section-template')) {
                        e.target.classList.remove('dragging');
                    }
                });
                
                // Zone de dépôt - Gestion du survol et dépôt
                canvas.addEventListener('dragover', (e) => {
                    e.preventDefault();
                    dropZone.classList.add('drag-over');
                });
                
                canvas.addEventListener('dragleave', (e) => {
                    if (!canvas.contains(e.relatedTarget)) {
                        dropZone.classList.remove('drag-over');
                    }
                });
                
                canvas.addEventListener('drop', (e) => {
                    e.preventDefault();
                    dropZone.classList.remove('drag-over');
                    
                    const templateKey = e.dataTransfer.getData('text/plain');
                    if (templateKey) {
                        this.addSection(templateKey);
                    }
                });
            }

            /**
             * Rôle : Ajout d'une nouvelle section au canvas
             * Type : Content Creation - Instanciation de template
             * Retour : void
             */
            addSection(templateKey) {
                const template = this.sectionTemplates[templateKey];
                if (!template) return;
                
                // Création de l'objet section avec données par défaut
                const sectionId = 'section_' + Date.now() + '_' + Math.random().toString(36).substr(2, 9);
                const section = {
                    id: sectionId,
                    type: templateKey,
                    data: { ...template.defaultContent },
                    template: template
                };
                
                // Ajout à la liste des sections
                this.sections.push(section);
                
                // Rendu de la section dans le canvas
                this.renderSection(section);
                
                // Sauvegarde pour l'historique
                this.saveState();
                
                // Masquage de la zone de dépôt si première section
                if (this.sections.length === 1) {
                    document.getElementById('mainDropZone').style.display = 'none';
                }
            }

            /**
             * Rôle : Rendu HTML d'une section dans le canvas
             * Type : Template Rendering - Génération HTML avec données
             * Retour : void
             */
            renderSection(section) {
                const canvas = document.getElementById('sectionCanvas');
                
                // Création du conteneur de section
                const sectionDiv = document.createElement('div');
                sectionDiv.className = 'canvas-section';
                sectionDiv.dataset.sectionId = section.id;
                
                // Génération du HTML en remplaçant les placeholders
                const renderedHTML = this.processTemplate(section.template.template, section.data);
                
                sectionDiv.innerHTML = `
                    <div class="section-controls">
                        <button class="section-control-btn" title="Modifier" onclick="sectionEditor.editSection('${section.id}')">
                            <i class="fas fa-edit"></i>
                        </button>
                        <button class="section-control-btn" title="Dupliquer" onclick="sectionEditor.duplicateSection('${section.id}')">
                            <i class="fas fa-copy"></i>
                        </button>
                        <button class="section-control-btn" title="Supprimer" onclick="sectionEditor.deleteSection('${section.id}')">
                            <i class="fas fa-trash"></i>
                        </button>
                    </div>
                    ${renderedHTML}
                `;
                
                // Événement de sélection
                sectionDiv.addEventListener('click', () => this.selectSection(section.id));
                
                // Insertion dans le canvas (avant la zone de dépôt si elle existe)
                const dropZone = document.getElementById('mainDropZone');
                if (dropZone.parentNode) {
                    canvas.insertBefore(sectionDiv, dropZone);
                } else {
                    canvas.appendChild(sectionDiv);
                }
            }

            /**
             * Rôle : Traitement d'un template avec injection de données
             * Type : Template Engine - Remplacement de placeholders
             * Retour : String HTML traité
             */
            processTemplate(template, data) {
                let processed = template;
                
                // Remplacement des variables simples {{variable}}
                processed = processed.replace(/\{\{(\w+)\}\}/g, (match, key) => {
                    return data[key] || '';
                });
                
                // Support basique pour les boucles {{#each array}}
                processed = processed.replace(/\{\{#each (\w+)\}\}(.*?)\{\{\/each\}\}/gs, (match, arrayKey, innerTemplate) => {
                    const array = data[arrayKey];
                    if (!Array.isArray(array)) return '';
                    
                    return array.map(item => {
                        let itemHTML = innerTemplate;
                        
                        // Remplacement des propriétés de l'item
                        Object.keys(item).forEach(prop => {
                            const regex = new RegExp(`\\{\\{${prop}\\}\\}`, 'g');
                            itemHTML = itemHTML.replace(regex, item[prop]);
                        });
                        
                        // Support pour les conditions {{#if prop}}
                        itemHTML = itemHTML.replace(/\{\{#if (\w+)\}\}(.*?)\{\{else\}\}(.*?)\{\{\/if\}\}/gs, (match, condKey, trueContent, falseContent) => {
                            return item[condKey] ? trueContent : falseContent;
                        });
                        
                        itemHTML = itemHTML.replace(/\{\{#if (\w+)\}\}(.*?)\{\{\/if\}\}/gs, (match, condKey, content) => {
                            return item[condKey] ? content : '';
                        });
                        
                        return itemHTML;
                    }).join('');
                });
                
                return processed;
            }

            /**
             * Rôle : Sélection d'une section pour édition
             * Type : UI State - Gestion de la sélection active
             * Retour : void
             */
            selectSection(sectionId) {
                // Retrait de la sélection précédente
                document.querySelectorAll('.canvas-section').forEach(el => {
                    el.classList.remove('selected');
                });
                
                // Application de la nouvelle sélection
                const sectionEl = document.querySelector(`[data-section-id="${sectionId}"]`);
                if (sectionEl) {
                    sectionEl.classList.add('selected');
                    this.selectedSection = this.sections.find(s => s.id === sectionId);
                    this.showProperties();
                }
            }

            /**
             * Rôle : Affichage du panneau de propriétés
             * Type : UI Generation - Interface d'édition des propriétés
             * Retour : void
             */
            showProperties() {
                const propertiesContent = document.getElementById('propertiesContent');
                
                if (!this.selectedSection) {
                    propertiesContent.innerHTML = `
                        <div style="text-align: center; color: var(--text-muted); padding: var(--spacing-xl);">
                            <i class="fas fa-mouse-pointer" style="font-size: 2em; margin-bottom: var(--spacing-sm);"></i>
                            <p>Sélectionnez une section pour modifier ses propriétés</p>
                        </div>
                    `;
                    return;
                }
                
                // Génération des contrôles d'édition basés sur les champs éditables
                const fields = this.selectedSection.template.editableFields || [];
                
                let propertiesHTML = `
                    <div class="property-group">
                        <div class="property-group-title">Informations de la Section</div>
                        <div class="form-group">
                            <label class="form-label">Type</label>
                            <input type="text" class="form-input" value="${this.selectedSection.template.name}" readonly>
                        </div>
                        <div class="form-group">
                            <label class="form-label">ID</label>
                            <input type="text" class="form-input" value="${this.selectedSection.id}" readonly>
                        </div>
                    </div>
                `;
                
                if (fields.length > 0) {
                    propertiesHTML += `
                        <div class="property-group">
                            <div class="property-group-title">Contenu</div>
                    `;
                    
                    fields.forEach(field => {
                        const value = this.selectedSection.data[field.name] || '';
                        
                        propertiesHTML += `<div class="form-group">`;
                        propertiesHTML += `<label class="form-label">${field.label}</label>`;
                        
                        switch (field.type) {
                            case 'textarea':
                                propertiesHTML += `<textarea class="form-input form-textarea" data-field="${field.name}">${value}</textarea>`;
                                break;
                            case 'color':
                                propertiesHTML += `
                                    <div class="color-picker-group">
                                        <input type="text" class="form-input" data-field="${field.name}" value="${value}">
                                        <div class="color-preview" style="background-color: ${value};" onclick="this.previousElementSibling.type='color'; this.previousElementSibling.click();"></div>
                                    </div>
                                `;
                                break;
                            case 'select':
                                propertiesHTML += `<select class="form-input form-select" data-field="${field.name}">`;
                                field.options?.forEach(option => {
                                    propertiesHTML += `<option value="${option.value}" ${option.value === value ? 'selected' : ''}>${option.label}</option>`;
                                });
                                propertiesHTML += `</select>`;
                                break;
                            default:
                                propertiesHTML += `<input type="text" class="form-input" data-field="${field.name}" value="${value}">`;
                        }
                        
                        propertiesHTML += `</div>`;
                    });
                    
                    propertiesHTML += `</div>`;
                }
                
                propertiesContent.innerHTML = propertiesHTML;
                
                // Événements de modification des propriétés
                propertiesContent.querySelectorAll('[data-field]').forEach(input => {
                    input.addEventListener('input', () => {
                        const fieldName = input.dataset.field;
                        const value = input.value;
                        
                        this.selectedSection.data[fieldName] = value;
                        this.updateSectionRender();
                        this.saveState();
                    });
                });
            }

            /**
             * Rôle : Mise à jour du rendu d'une section modifiée
             * Type : UI Update - Re-rendu après modification
             * Retour : void
             */
            updateSectionRender() {
                if (!this.selectedSection) return;
                
                const sectionEl = document.querySelector(`[data-section-id="${this.selectedSection.id}"]`);
                if (!sectionEl) return;
                
                // Re-génération du HTML avec les nouvelles données
                const renderedHTML = this.processTemplate(this.selectedSection.template.template, this.selectedSection.data);
                
                // Préservation des contrôles et mise à jour du contenu
                const controls = sectionEl.querySelector('.section-controls').outerHTML;
                sectionEl.innerHTML = controls + renderedHTML;
            }

            /**
             * Rôle : Gestion du zoom avant
             * Type : UI Control - Augmentation de l'échelle d'affichage
             * Retour : void
             */
            zoomIn() {
                if (this.currentZoom < 200) {
                    this.currentZoom += 25;
                    this.applyZoom();
                }
            }

            /**
             * Rôle : Gestion du zoom arrière  
             * Type : UI Control - Diminution de l'échelle d'affichage
             * Retour : void
             */
            zoomOut() {
                if (this.currentZoom > 25) {
                    this.currentZoom -= 25;
                    this.applyZoom();
                }
            }

            /**
             * Rôle : Ajustement du zoom à la fenêtre
             * Type : UI Control - Zoom automatique pour ajustement
             * Retour : void
             */
            zoomFit() {
                this.currentZoom = 100;
                this.applyZoom();
            }

            /**
             * Rôle : Application du niveau de zoom au canvas
             * Type : CSS Transform - Modification de l'échelle visuelle
             * Retour : void
             */
            applyZoom() {
                const canvas = document.getElementById('sectionCanvas');
                canvas.style.transform = `scale(${this.currentZoom / 100})`;
                canvas.style.transformOrigin = 'top left';
                
                // Mise à jour de l'affichage du niveau de zoom
                document.getElementById('zoomLevel').textContent = `${this.currentZoom}%`;
            }

            /**
             * Rôle : Sauvegarde de l'état actuel pour l'historique
             * Type : History Management - Capture d'état pour undo/redo
             * Retour : void
             */
            saveState() {
                // Suppression des états futurs lors d'une nouvelle action
                this.history = this.history.slice(0, this.historyIndex + 1);
                
                // Ajout du nouvel état
                this.history.push({
                    sections: JSON.parse(JSON.stringify(this.sections)),
                    selectedSection: this.selectedSection?.id || null
                });
                
                // Limitation de la taille de l'historique
                if (this.history.length > this.maxHistory) {
                    this.history.shift();
                } else {
                    this.historyIndex++;
                }
                
                // Mise à jour des boutons undo/redo
                this.updateHistoryButtons();
            }

            /**
             * Rôle : Annulation de la dernière action (undo)
             * Type : History Management - Retour à l'état précédent
             * Retour : void
             */
            undo() {
                if (this.historyIndex > 0) {
                    this.historyIndex--;
                    this.restoreState();
                }
            }

            /**
             * Rôle : Rétablissement de l'action annulée (redo)
             * Type : History Management - Avancement dans l'historique
             * Retour : void
             */
            redo() {
                if (this.historyIndex < this.history.length - 1) {
                    this.historyIndex++;
                    this.restoreState();
                }
            }

            /**
             * Rôle : Restauration d'un état depuis l'historique
             * Type : State Management - Application d'un état sauvegardé
             * Retour : void
             */
            restoreState() {
                const state = this.history[this.historyIndex];
                this.sections = JSON.parse(JSON.stringify(state.sections));
                
                // Re-rendu complet du canvas
                this.renderAllSections();
                
                // Restauration de la sélection
                if (state.selectedSection) {
                    this.selectSection(state.selectedSection);
                } else {
                    this.selectedSection = null;
                    this.showProperties();
                }
                
                this.updateHistoryButtons();
            }

            /**
             * Rôle : Mise à jour de l'état des boutons historique
             * Type : UI State - Activation/désactivation des contrôles
             * Retour : void
             */
            updateHistoryButtons() {
                document.getElementById('undoBtn').disabled = this.historyIndex <= 0;
                document.getElementById('redoBtn').disabled = this.historyIndex >= this.history.length - 1;
            }

            /**
             * Rôle : Re-rendu de toutes les sections
             * Type : UI Refresh - Régénération complète de l'interface
             * Retour : void
             */
            renderAllSections() {
                const canvas = document.getElementById('sectionCanvas');
                const dropZone = document.getElementById('mainDropZone');
                
                // Nettoyage du canvas (préservation de la zone de dépôt)
                canvas.innerHTML = '';
                if (this.sections.length === 0) {
                    canvas.appendChild(dropZone);
                    dropZone.style.display = 'flex';
                } else {
                    dropZone.style.display = 'none';
                }
                
                // Re-rendu de chaque section
                this.sections.forEach(section => {
                    this.renderSection(section);
                });
            }

            /**
             * Rôle : Suppression d'une section
             * Type : Content Management - Retrait d'élément
             * Retour : void
             */
            deleteSection(sectionId) {
                // Confirmation avant suppression
                if (!confirm('Êtes-vous sûr de vouloir supprimer cette section ?')) {
                    return;
                }
                
                // Retrait de la section des données
                this.sections = this.sections.filter(s => s.id !== sectionId);
                
                // Mise à jour de l'affichage
                this.renderAllSections();
                
                // Déselection si c'était la section sélectionnée
                if (this.selectedSection && this.selectedSection.id === sectionId) {
                    this.selectedSection = null;
                    this.showProperties();
                }
                
                // Sauvegarde pour l'historique
                this.saveState();
            }

            /**
             * Rôle : Duplication d'une section
             * Type : Content Management - Clonage d'élément
             * Retour : void
             */
            duplicateSection(sectionId) {
                const section = this.sections.find(s => s.id === sectionId);
                if (!section) return;
                
                // Création d'une copie avec nouvel ID
                const duplicatedSection = {
                    ...JSON.parse(JSON.stringify(section)),
                    id: 'section_' + Date.now() + '_' + Math.random().toString(36).substr(2, 9)
                };
                
                // Insertion après la section originale
                const originalIndex = this.sections.findIndex(s => s.id === sectionId);
                this.sections.splice(originalIndex + 1, 0, duplicatedSection);
                
                // Re-rendu et sauvegarde
                this.renderAllSections();
                this.saveState();
            }

            /**
             * Rôle : Filtrage de la bibliothèque par terme de recherche
             * Type : UI Filter - Filtrage dynamique des éléments
             * Retour : void
             */
            filterLibrary(searchTerm) {
                const templates = document.querySelectorAll('.section-template');
                const categories = document.querySelectorAll('.section-category');
                
                const term = searchTerm.toLowerCase();
                
                templates.forEach(template => {
                    const name = template.querySelector('.template-name').textContent.toLowerCase();
                    const description = template.querySelector('.template-description').textContent.toLowerCase();
                    const matches = name.includes(term) || description.includes(term);
                    
                    template.style.display = matches ? 'block' : 'none';
                });
                
                // Masquage des catégories vides
                categories.forEach(category => {
                    const visibleTemplates = category.querySelectorAll('.section-template[style*="block"], .section-template:not([style*="none"])');
                    category.style.display = visibleTemplates.length > 0 ? 'block' : 'none';
                });
            }

            /**
             * Rôle : Sauvegarde de la présentation
             * Type : Data Persistence - Sérialisation et stockage
             * Retour : void
             */
            savePresentation() {
                const presentationData = {
                    version: '1.0',
                    created: new Date().toISOString(),
                    sections: this.sections.map(section => ({
                        id: section.id,
                        type: section.type,
                        data: section.data
                    }))
                };
                
                // Sauvegarde en localStorage pour cette démo
                localStorage.setItem('sectionEditor_presentation', JSON.stringify(presentationData));
                
                // Feedback utilisateur
                this.showMessage('Présentation sauvegardée avec succès !', 'success');
            }

            /**
             * Rôle : Création d'une nouvelle présentation
             * Type : Data Management - Réinitialisation de l'état
             * Retour : void
             */
            newPresentation() {
                if (this.sections.length > 0 && !confirm('Créer une nouvelle présentation ? Les modifications non sauvegardées seront perdues.')) {
                    return;
                }
                
                // Réinitialisation complète
                this.sections = [];
                this.selectedSection = null;
                this.history = [];
                this.historyIndex = -1;
                
                // Re-rendu de l'interface
                this.renderAllSections();
                this.showProperties();
                this.updateHistoryButtons();
                
                // Sauvegarde de l'état initial
                this.saveState();
            }

            /**
             * Rôle : Prévisualisation de la présentation
             * Type : Preview Generation - Génération de vue finale
             * Retour : void
             */
            preview() {
                // Ouverture dans une nouvelle fenêtre pour prévisualisation
                const previewWindow = window.open('', '_blank');
                
                // Génération du HTML complet de la présentation
                let previewHTML = `
                    <!DOCTYPE html>
                    <html lang="fr">
                    <head>
                        <meta charset="UTF-8">
                        <meta name="viewport" content="width=device-width, initial-scale=1.0">
                        <title>Aperçu - Li-CUBE PRO™</title>
                        <link rel="stylesheet" href="../assets/css/themes.css">
                        <style>
                            body { margin: 0; padding: 0; font-family: system-ui; }
                            .preview-header {
                                position: fixed;
                                top: 0;
                                left: 0;
                                right: 0;
                                background: rgba(15, 23, 42, 0.95);
                                backdrop-filter: blur(10px);
                                color: white;
                                padding: 1rem;
                                text-align: center;
                                z-index: 1000;
                                border-bottom: 1px solid rgba(16, 185, 129, 0.3);
                            }
                            .preview-content { margin-top: 80px; }
                        </style>
                    </head>
                    <body>
                        <div class="preview-header">
                            <h3 style="margin: 0; color: #10B981;">Aperçu de la Présentation Li-CUBE PRO™</h3>
                            <p style="margin: 0.5rem 0 0 0; font-size: 0.9rem; opacity: 0.8;">Fermez cette fenêtre pour retourner à l'éditeur</p>
                        </div>
                        <div class="preview-content">
                `;
                
                // Ajout de chaque section rendue
                this.sections.forEach(section => {
                    previewHTML += this.processTemplate(section.template.template, section.data);
                });
                
                previewHTML += `
                        </div>
                    </body>
                    </html>
                `;
                
                previewWindow.document.write(previewHTML);
                previewWindow.document.close();
            }

            /**
             * Rôle : Exportation de la présentation
             * Type : Export Generation - Génération de fichiers de sortie
             * Retour : void
             */
            exportPresentation() {
                // Génération du HTML complet pour export
                let exportHTML = `<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Li-CUBE PRO™ - Location Intelligente</title>
    <link rel="stylesheet" href="../assets/css/themes.css">
    <style>
        body { margin: 0; padding: 0; font-family: system-ui; }
    </style>
</head>
<body>
`;

                // Ajout de chaque section
                this.sections.forEach(section => {
                    exportHTML += this.processTemplate(section.template.template, section.data);
                });

                exportHTML += `
</body>
</html>`;

                // Téléchargement du fichier
                const blob = new Blob([exportHTML], { type: 'text/html' });
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = 'presentation-licube-pro.html';
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
                URL.revokeObjectURL(url);
                
                this.showMessage('Présentation exportée avec succès !', 'success');
            }

            /**
             * Rôle : Affichage de messages de feedback à l'utilisateur
             * Type : UI Feedback - Notification temporaire
             * Retour : void
             */
            showMessage(message, type = 'info') {
                // Création d'un élément de notification temporaire
                const messageEl = document.createElement('div');
                messageEl.className = type === 'success' ? 'success-message' : 'error-message';
                messageEl.textContent = message;
                messageEl.style.position = 'fixed';
                messageEl.style.top = '80px';
                messageEl.style.right = '20px';
                messageEl.style.zIndex = '1001';
                messageEl.style.minWidth = '300px';
                messageEl.style.animation = 'slideInRight 0.3s ease-out';
                
                document.body.appendChild(messageEl);
                
                // Suppression automatique après 3 secondes
                setTimeout(() => {
                    messageEl.style.animation = 'slideOutRight 0.3s ease-out';
                    setTimeout(() => document.body.removeChild(messageEl), 300);
                }, 3000);
            }
        }

        // Instance globale de l'éditeur de sections
        const sectionEditor = new SectionEditor();

        // Styles pour les animations de notification
        const style = document.createElement('style');
        style.textContent = `
            @keyframes slideInRight {
                from { transform: translateX(100%); opacity: 0; }
                to { transform: translateX(0); opacity: 1; }
            }
            @keyframes slideOutRight {
                from { transform: translateX(0); opacity: 1; }
                to { transform: translateX(100%); opacity: 0; }
            }
        `;
        document.head.appendChild(style);
    </script>
    <script type="module">
        import stateManager from "../../../../../core/widget-state-manager.js";
        window.widgetStateManager = stateManager;
    </script>
</body>
</html>