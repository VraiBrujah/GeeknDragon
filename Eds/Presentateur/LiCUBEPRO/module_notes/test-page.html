<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Module Notes Universelles - D√©monstration</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: #333;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            text-align: center;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            padding: 40px;
            margin-bottom: 30px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
        }

        .header h1 {
            font-size: 2.5em;
            color: #2c3e50;
            margin-bottom: 15px;
        }

        .header p {
            font-size: 1.1em;
            color: #7f8c8d;
            max-width: 600px;
            margin: 0 auto;
        }

        .features-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 25px;
            margin-bottom: 30px;
        }

        .feature-card {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
            transition: transform 0.3s ease;
        }

        .feature-card:hover {
            transform: translateY(-5px);
        }

        .feature-card h3 {
            color: #2c3e50;
            margin-bottom: 15px;
            font-size: 1.3em;
        }

        .feature-card p {
            color: #7f8c8d;
            margin-bottom: 15px;
        }

        .feature-card .icon {
            font-size: 2.5em;
            margin-bottom: 15px;
            display: block;
        }

        .demo-section {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            padding: 40px;
            margin-bottom: 30px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
        }

        .demo-section h2 {
            color: #2c3e50;
            margin-bottom: 20px;
            font-size: 1.8em;
            text-align: center;
        }

        .instructions {
            background: #e8f4fd;
            border: 2px solid #3498db;
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 20px;
        }

        .instructions h4 {
            color: #2980b9;
            margin-bottom: 10px;
        }

        .instructions ul {
            color: #34495e;
            margin-left: 20px;
        }

        .instructions li {
            margin-bottom: 8px;
        }

        .config-example {
            background: #f8f9fa;
            border: 1px solid #dee2e6;
            border-radius: 8px;
            padding: 20px;
            margin: 20px 0;
            font-family: 'Courier New', monospace;
            overflow-x: auto;
        }

        .config-example pre {
            color: #495057;
            font-size: 14px;
            line-height: 1.4;
        }

        .status-info {
            background: #d4edda;
            border: 2px solid #28a745;
            color: #155724;
            padding: 15px;
            border-radius: 8px;
            margin: 20px 0;
            text-align: center;
            font-weight: 600;
        }

        .api-demo {
            background: #fff3cd;
            border: 2px solid #ffc107;
            border-radius: 10px;
            padding: 20px;
            margin-top: 20px;
        }

        .api-demo h4 {
            color: #856404;
            margin-bottom: 15px;
        }

        .btn {
            background: linear-gradient(135deg, #3498db, #2980b9);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 14px;
            margin: 5px;
            transition: all 0.2s ease;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(52, 152, 219, 0.3);
        }

        .btn-success {
            background: linear-gradient(135deg, #27ae60, #229954);
        }

        .btn-warning {
            background: linear-gradient(135deg, #f39c12, #e67e22);
        }

        .btn-danger {
            background: linear-gradient(135deg, #e74c3c, #c0392b);
        }

        .footer {
            text-align: center;
            color: rgba(255, 255, 255, 0.8);
            padding: 20px;
            margin-top: 40px;
        }

        .footer a {
            color: rgba(255, 255, 255, 0.9);
            text-decoration: none;
        }

        @media (max-width: 768px) {
            .container {
                padding: 15px;
            }
            
            .header {
                padding: 25px;
            }
            
            .header h1 {
                font-size: 2em;
            }
            
            .feature-card {
                padding: 20px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- En-t√™te -->
        <div class="header">
            <h1>üìù Module Notes Universelles</h1>
            <p>
                D√©monstration du syst√®me de notes partag√©es g√©n√©rique. 
                Ce module peut √™tre int√©gr√© dans n'importe quel site web pour permettre 
                aux utilisateurs de laisser des notes partag√©es et temps r√©el.
            </p>
        </div>

        <!-- Fonctionnalit√©s -->
        <div class="features-grid">
            <div class="feature-card">
                <div class="icon">üåê</div>
                <h3>Universel</h3>
                <p>Fonctionne sur n'importe quel site web, CMS ou application. Simple inclusion d'un fichier JavaScript.</p>
            </div>

            <div class="feature-card">
                <div class="icon">üì°</div>
                <h3>Sauvegarde Serveur</h3>
                <p>Notes sauvegard√©es c√¥t√© serveur avec PHP. Compatible HostPapa, Apache, Nginx.</p>
            </div>

            <div class="feature-card">
                <div class="icon">ü§ù</div>
                <h3>Partag√©</h3>
                <p>Les notes sont visibles par tous les utilisateurs de la page. Id√©al pour feedback collaboratif.</p>
            </div>

            <div class="feature-card">
                <div class="icon">üì±</div>
                <h3>Responsive</h3>
                <p>Interface adapt√©e automatiquement aux mobiles, tablettes et ordinateurs.</p>
            </div>

            <div class="feature-card">
                <div class="icon">üé®</div>
                <h3>Adaptatif</h3>
                <p>Le module s'adapte automatiquement aux couleurs et au th√®me de votre site web.</p>
            </div>

            <div class="feature-card">
                <div class="icon">‚ö°</div>
                <h3>Temps R√©el</h3>
                <p>Refresh automatique des notes toutes les 30 secondes. Voir les nouvelles notes instantan√©ment.</p>
            </div>
        </div>

        <!-- Instructions -->
        <div class="demo-section">
            <h2>üöÄ Comment tester le module</h2>
            
            <div class="instructions">
                <h4>üìã Instructions d'utilisation :</h4>
                <ul>
                    <li><strong>Bouton flottant</strong> - Regardez √† droite de votre √©cran, il y a un bouton "üìù" flottant</li>
                    <li><strong>Ouvrir le module</strong> - Cliquez sur le bouton ou utilisez <kbd>Ctrl+Shift+N</kbd></li>
                    <li><strong>√âcrire une note</strong> - Tapez votre message dans la zone de texte</li>
                    <li><strong>Sauvegarder</strong> - Cliquez "üíæ Sauvegarder" ou <kbd>Ctrl+Enter</kbd></li>
                    <li><strong>Voir toutes les notes</strong> - Cliquez "üëÅÔ∏è Voir Notes" pour voir toutes les notes de cette page</li>
                    <li><strong>Actualiser</strong> - Cliquez "üîÑ Actualiser" pour voir les derni√®res notes ajout√©es</li>
                </ul>
            </div>

            <div class="status-info" id="module-status">
                üîÑ V√©rification du statut du module...
            </div>
        </div>

        <!-- Configuration -->
        <div class="demo-section">
            <h2>‚öôÔ∏è Configuration du module</h2>
            
            <p>Cette page utilise une configuration personnalis√©e pour d√©monstration :</p>
            
            <div class="config-example">
                <pre>
window.NotesConfig = {
    // Position du bouton (center-right par d√©faut)
    position: 'center-right',
    
    // Th√®me adaptatif au site
    theme: 'adaptive',
    
    // Couleurs personnalis√©es
    colors: {
        primary: '#3498db',
        success: '#27ae60',
        background: 'rgba(255, 255, 255, 0.95)'
    },
    
    // Refresh toutes les 15 secondes (au lieu de 30)
    refreshInterval: 15000,
    
    // Textes personnalis√©s
    labels: {
        title: 'Notes de Test',
        placeholder: '√âcrivez ici votre note de test...'
    },
    
    // M√©tadonn√©es pour cette page de test
    metadata: {
        includeTitle: true,
        customFields: {
            pageType: 'demo',
            version: '1.0-test'
        }
    }
};
                </pre>
            </div>
        </div>

        <!-- API et contr√¥les -->
        <div class="demo-section">
            <h2>üîß API JavaScript et contr√¥les</h2>
            
            <p>Vous pouvez contr√¥ler le module programmatiquement :</p>
            
            <div class="api-demo">
                <h4>üéÆ Contr√¥les de test :</h4>
                <button class="btn btn-success" onclick="NotesModule.open()">üìù Ouvrir Module</button>
                <button class="btn" onclick="NotesModule.close()">‚ùå Fermer Module</button>
                <button class="btn" onclick="NotesModule.toggle()">üîÑ Basculer</button>
                <button class="btn btn-warning" onclick="testConnexion()">üîç Test Connexion</button>
                <button class="btn btn-danger" onclick="NotesModule.refresh()">üÜï Actualiser</button>
            </div>

            <div class="config-example">
                <pre>
// Exemples d'utilisation de l'API
NotesModule.open();           // Ouvrir le module
NotesModule.close();          // Fermer le module
NotesModule.toggle();         // Basculer ouvert/ferm√©
NotesModule.refresh();        // Actualiser les donn√©es

// √âv√©nements personnalis√©s
NotesModule.on('Ready', function(data) {
    console.log('Module pr√™t:', data);
});

// Configuration dynamique
NotesModule.setConfig({
    theme: 'dark',
    position: 'top-right'
});
                </pre>
            </div>
        </div>

        <!-- Informations techniques -->
        <div class="demo-section">
            <h2>üîç Informations techniques</h2>
            
            <div class="features-grid">
                <div class="feature-card">
                    <h3>üìÅ Nom du fichier de notes</h3>
                    <p id="filename-info">Calcul en cours...</p>
                </div>
                
                <div class="feature-card">
                    <h3>üåê URL de la page</h3>
                    <p id="url-info" style="word-break: break-all; font-size: 0.9em;"></p>
                </div>
                
                <div class="feature-card">
                    <h3>üìä Statistiques</h3>
                    <div id="stats-info">Chargement...</div>
                </div>
            </div>
        </div>
    </div>

    <!-- Pied de page -->
    <div class="footer">
        <p>
            üìù Module Notes Universelles v1.0 - 
            <a href="README.md" target="_blank">Documentation</a> | 
            <a href="admin-notes.html" target="_blank">Administration</a>
        </p>
        <p style="margin-top: 10px; font-size: 0.9em;">
            D√©velopp√© par Assistant Claude (Anthropic) - Licence MIT
        </p>
    </div>

    <!-- Configuration du module AVANT chargement -->
    <script>
        // Configuration personnalis√©e pour la page de test
        window.NotesConfig = {
            // Position du bouton 
            position: 'center-right',
            
            // Th√®me adaptatif
            theme: 'adaptive',
            
            // Couleurs personnalis√©es
            colors: {
                primary: '#3498db',
                success: '#27ae60',
                warning: '#f39c12',
                danger: '#e74c3c',
                background: 'rgba(255, 255, 255, 0.95)',
                text: '#2c3e50'
            },
            
            // Refresh plus fr√©quent pour demo
            refreshInterval: 15000, // 15 secondes
            
            // Limite de caract√®res
            maxNoteLength: 2000,
            
            // Textes personnalis√©s
            labels: {
                title: 'Notes de Test',
                placeholder: 'Testez ici le syst√®me de notes partag√©es...\n\nExemples:\n‚Ä¢ BUG: Probl√®me d√©tect√©\n‚Ä¢ ID√âE: Suggestion d\'am√©lioration\n‚Ä¢ OK: Fonctionne parfaitement\n\nVotre note sera visible par tous !',
                saveButton: 'üíæ Sauver',
                viewButton: 'üëÄ Voir',
                refreshButton: 'üîÑ MAJ',
                clearButton: 'üóëÔ∏è Vider'
            },
            
            // M√©tadonn√©es pour cette page
            metadata: {
                includeTitle: true,
                includeUrl: true,
                customFields: {
                    pageType: 'demo-test',
                    version: '1.0',
                    environment: 'test'
                }
            }
        };
    </script>

    <!-- Chargement du module -->
    <script src="notes-module.js"></script>

    <!-- Scripts de test -->
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            console.log('üß™ Page de test du Module Notes Universelles');
            
            // Attendre l'initialisation du module
            setTimeout(initTestPage, 1000);
        });

        function initTestPage() {
            // V√©rifier le statut du module
            const statusElement = document.getElementById('module-status');
            
            if (window.NotesModule && window.NotesModule.version) {
                statusElement.innerHTML = `
                    ‚úÖ <strong>Module charg√© avec succ√®s !</strong><br>
                    Version: ${window.NotesModule.version} | 
                    Position: ${window.NotesModule.config.position} |
                    Th√®me: ${window.NotesModule.config.theme}
                `;
                statusElement.style.background = '#d4edda';
                statusElement.style.borderColor = '#28a745';
            } else {
                statusElement.innerHTML = `
                    ‚ùå <strong>Erreur de chargement du module</strong><br>
                    V√©rifiez que les fichiers sont pr√©sents et accessibles.
                `;
                statusElement.style.background = '#f8d7da';
                statusElement.style.borderColor = '#dc3545';
            }

            // Afficher les informations techniques
            updateTechnicalInfo();
            
            // Charger les statistiques
            loadStats();
            
            // √âv√©nements du module
            if (window.NotesModule) {
                NotesModule.on('Ready', function(data) {
                    console.log('‚úÖ Module pr√™t:', data);
                });
                
                NotesModule.on('NoteSaved', function(data) {
                    console.log('üíæ Note sauvegard√©e:', data);
                    // Recharger les stats apr√®s sauvegarde
                    setTimeout(loadStats, 1000);
                });
            }
        }

        function updateTechnicalInfo() {
            // Nom du fichier
            const url = window.location.href;
            const filename = generateFilenameFromURL(url);
            document.getElementById('filename-info').textContent = filename;
            
            // URL de la page
            document.getElementById('url-info').textContent = url;
        }

        function generateFilenameFromURL(url) {
            // Reproduire la logique du module
            try {
                const urlParts = new URL(url);
                const domain = urlParts.hostname.replace(/[^a-zA-Z0-9.-]/g, '');
                const path = urlParts.pathname.replace(/^\/|\/$/g, '')
                                              .replace(/[^a-zA-Z0-9.\-\/]/g, '_')
                                              .replace(/\//g, '_')
                                              .replace(/\.html?$/, '');
                
                let filename = domain + '_' + path;
                filename = filename.replace(/_+/g, '_').replace(/^_|_$/g, '');
                
                if (filename.length > 200) {
                    filename = filename.substring(0, 200) + '_tronque';
                }
                
                return filename + '.md';
            } catch (e) {
                return 'erreur-generation-nom.md';
            }
        }

        async function loadStats() {
            try {
                const response = await fetch('notes-handler.php?action=stats');
                const data = await response.json();
                
                if (data.success) {
                    const stats = data.data;
                    document.getElementById('stats-info').innerHTML = `
                        <strong>üìÅ ${stats.totalFichiers || 0}</strong> fichier(s)<br>
                        <strong>üìù ${stats.totalNotes || 0}</strong> note(s) total<br>
                        <strong>üíæ ${stats.tailleTotal || 0}</strong> Ko<br>
                        <small>Derni√®re: ${stats.derniereActivite || 'Aucune'}</small>
                    `;
                } else {
                    document.getElementById('stats-info').innerHTML = `
                        ‚ùå Erreur chargement<br>
                        <small>${data.error}</small>
                    `;
                }
            } catch (error) {
                document.getElementById('stats-info').innerHTML = `
                    ‚ö†Ô∏è Serveur non disponible<br>
                    <small>${error.message}</small>
                `;
            }
        }

        function testConnexion() {
            console.log('üîç Test de connexion...');
            
            fetch('notes-handler.php?action=stats')
                .then(response => response.json())
                .then(data => {
                    if (data.success) {
                        alert('‚úÖ Connexion serveur OK !\n\nStatistiques:\n‚Ä¢ Fichiers: ' + data.data.totalFichiers + '\n‚Ä¢ Notes: ' + data.data.totalNotes);
                    } else {
                        alert('‚ö†Ô∏è Serveur r√©pond mais avec erreur:\n' + data.error);
                    }
                })
                .catch(error => {
                    alert('‚ùå Erreur de connexion:\n' + error.message);
                });
        }

        // Logs pour debug
        console.log(`
üß™ PAGE DE TEST - MODULE NOTES UNIVERSELLES
============================================
URL: ${window.location.href}
Timestamp: ${new Date().toLocaleString()}
User Agent: ${navigator.userAgent.substring(0, 50)}...
============================================
        `);
    </script>
</body>
</html>